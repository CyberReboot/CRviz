{"version":3,"sources":["domain/controls.js","features/drag-drop-utils/AvailableFieldList.module.css","features/comparison-selector/ComparisonSelector.module.css","features/note-selector/NoteSelector.module.css","features/search/SearchControls.module.css","features/visualization/Visualization.module.css","features/dataset-controls/DatasetControls.module.css","domain/notes.js","domain/error.js","epics/index-dataset-epic.js","epics/upload-dataset-epic.js","features/header/Header.js","features/header/crlogo.png","features/drag-drop-utils/SelectedField.js","features/drag-drop-utils/SelectedFieldList.js","features/drag-drop-utils/AvailableField.js","features/drag-drop-utils/AvailableFieldList.js","features/drag-drop-utils/DropTarget.js","features/hierarchy-selector/HierarchySelector.js","epics/diff-dataset-epic.js","features/comparison-selector/ComparisonSelector.js","features/note-selector/NoteSelector.js","features/misc-controls/FieldSelect.js","features/misc-controls/MiscControls.js","epics/search-dataset-epic.js","features/search/SearchControls.js","features/visualization/d3-viz/pack-grid.js","features/visualization/d3-viz/pack-with-label.js","features/visualization/d3-viz/to-hierarchy.js","features/visualization/d3-viz/datum-key.js","features/visualization/d3-viz/class-name.js","features/visualization/d3-viz/append-circles.js","features/visualization/d3-viz/setup-zoom.js","features/visualization/d3-viz/setup-tooltip.js","features/visualization/d3-viz/color-scheme.js","features/visualization/d3-viz/setup-legend.js","features/visualization/d3-viz/setup-annotations.js","features/visualization/d3-viz.js","features/visualization/Visualization.js","epics/refresh-dataset-epic.js","features/dataset-controls/DatasetSelector.js","features/dataset-controls/DatasetUpload.js","features/dataset-controls/DatasetDownload.js","features/dataset-controls/DatasetRefresh.js","features/dataset-controls/DatasetTimedRefresh.js","features/dataset-controls/export.js","features/dataset-controls/DatasetControls.js","features/slider-utils/slider-components.js","features/dataset-controls/DatasetSlider.js","features/tooltip/Tooltip.js","App.js","registerServiceWorker.js","domain/filter.js","domain/root-reducer.js","epics/filter-dataset-epic.js","epics/root-epic.js","configure-store.js","index.js","domain/dataset.js","features/misc-controls/MiscControls.module.css","App.module.css","features/tooltip/Tooltip.module.css","epics/fetch-dataset-epic.js","features/drag-drop-utils/SelectedFieldList.module.css","epics/load-dataset-epic.js","features/header/Header.module.css"],"names":["setControls","createAction","setStartDataset","setEndDataset","setHierarchyConfig","showNodes","useDarkTheme","colorBy","showBusy","setPosition","setSelectedDatum","reducer","handleActions","state","payload","hierarchyConfig","shouldShowNodes","darkTheme","start","end","position","selectedDatum","datum","selectControls","controls","getPosition","getSelectedDatum","module","exports","addNote","setNotes","removeNote","toggleNotesHover","setNoteHovered","byId","id","byHash","prunedIds","filter","item","byid","byhash","hoverStatus","hoveredNoteId","getNotesIndexedByHash","notes","getAllNotes","getNotesHoverStatus","getNoteHoveredId","setError","clearError","Error","error","getError","lunr","require","BUILD_INDICES","BUILD_INDICES_SUCCESS","REMOVE_SEARCH_INDEX","SET_SEARCH_RESULTS","buildIndices","removeSearchIndex","setSearchResults","getSearchResults","search","searchResults","getQueryString","queryString","getSearchIndices","searchIndices","searchReducer","action","type","forEach","owner","index","results","rsowner","hasOwnProperty","generateIndex","indices","Object","keys","datasets","dataset","configuration","isNil","isEmpty","configurationFor","flat","ds","cfg","flattened","key","CRVIZ","f","fields","field","displayName","toLowerCase","getValueByPath","path","push","flattenDataset","idx","this","ref","includes","map","add","object","length","current","i","indexDatasetEpic","action$","store","pipe","ofType","mergeMap","of","buildIndicesSuccess","uploadDataset","fromReader","name","shortName","includeData","includeControls","includeNotes","file","Observable","create","observer","source","reader","window","FileReader","addEventListener","next","result","complete","readAsText","fromJson","JSON","parse","uploadDatasetEpic","toString","debounceTime","CSVconvert","loadDataset","catchError","SyntaxError","newErr","Header","showInfo","hideTooltip","setState","showTooltip","className","style","header","href","target","rel","src","logo","alt","appName","infoIcon","onMouseEnter","onMouseLeave","icon","faInfoCircle","active","parent","tooltipTimeout","infoPopup","process","socialContainer","color","faGithub","faTwitter","faMediumM","React","Component","Field","initialItemText","subsequentItemText","dragIndex","animated","provided","draggable","innerRef","draggableProps","dragHandleProps","classNames","groupBy","fieldName","placeholder","SelectedField","count","draggableId","snapshot","SelectedFieldList","lastFields","toAnimate","props","values","getFieldId","droppableId","dragState","draggingOver","isDraggingOver","listContainer","droppableProps","droppable","List","destination","differenceWith","eqBy","findIndex","from","to","Math","min","max","defaultProps","AvailableField","draggableContainer","transform","isDragging","AvailableFieldList","dragForeign","isDraggingForeign","sortBy","getCount","withPlaceholder","dragForeignContainer","faTrashAlt","curry","contains","DropTarget","isDropDisabled","dropTarget","SELECTED_FIELD_LIST_ID","DROP_TARGET_ID","HierarchySelector","onDragStart","dragStart","onDragUpdate","dragUpdate","onDragEnd","dropResult","updateHierarchy","removeField","fieldId","newIndex","findFieldIndex","find","removeOld","identity","remove","addNew","insert","updatedHierarchy","compose","availableFields","groupable","marginBottom","selectedFieldListStyle","availableFieldListStyle","list","matchId","equals","mapDispatchToProps","connect","selectMergedConfiguration","selectMergedValues","DIFF_DATASET","generateDiff","startOwner","startDs","endOwner","endDs","diffs","added","changed","removed","concat","ei","si","diffDatasetEpic","switchMap","setDatasetDiff","KEY_FIELD_LIST_ID","IGNORED_FIELD_LIST_ID","KEY_TARGET_ID","IGNORED_TARGET_ID","ComparisonSelector","showDupeTooltip","updateKeyFields","keyFields","updateIgnoreFields","ignoredFields","getUpdatedFields","fieldsToUpdate","updatedKeys","setKeyFields","updateDiff","updatedIgnored","setIgnoredFields","keyIndex","ignoredIndex","toDiff","startUuid","endUuid","diffDataset","hideDupeTooltip","keyInfo","hasDupes","reduce","total","duplicateCount","usedFields","dupeContainer","faDumpsterFire","ki","ownProps","selectDatasets","isNaN","keyCount","uniqueKeyCount","getKeyFields","getIgnoredFields","Note","setHoveredNoteId","hoverMethod","hoverOn","setClickedNoteId","clickedOn","clicked","hover","onClick","hoverOff","tag","note_title","NoteSelectorList","tags","note","title","fieldToString","join","prop","stringToField","string","split","propEq","FieldSelect","value","onChange","evt","dispatch","container","checkboxContainer","checked","htmlFor","switchLabel","fieldSelect","selector","searchDataset","performSearch","data","toFind","hash","idxResults","temp","Set","el","_isSearchResult","r","res","searchDatasetEpic","tap","is","QueryParseError","defaultState","hasSearch","Search","handleQueryStringChange","e","handleKeyPress","handleSearch","searchContainer","onKeyPress","faSearch","clearSearch","faTimesCircle","eachWithIndex","addIndex","placeRows","rows","middleOut","maxRadii","maxRadius","ys","coordinatesForRadii","xs","row","node","j","x","y","c","radii","diameters","first","coords","lastRadius","currentRadius","last","aperture","above","reject","_","below","pickOdd","reverse","toRows","circles","splitEvery","ceil","sqrt","packGrid","enclosingCircle","packEnclose","radiusLeaf","radius","children","getLabelSize","labelRatio","packChildren","packSiblings","maxLabelRatio","padding","k","nonleafChildren","child","height","labelSize","paddingSize","enclosingRadius","translateChild","labelY","labelWidth","packWithLabel","options","size","pack","root","eachBefore","eachAfter","d","nestHierarchy","nest","countSearchResults","_searchResultCount","countAdded","_addedCount","_isAdded","countChanged","_changedCount","_isChanged","countRemoved","_removedCount","_isRemoved","entriesToHierarchy","fieldValue","entries","group","chain","getLeaves","_containsGroups","entry","head","tail","prev","containsGroups","toHierarchy","nesting","d3Hierarchy","datumKey","depth","uid","getLabelShape","top","startAngle","PI","acos","endAngle","shape","arc","closePath","scaleAndTrimToLabelWidth","initialFontScale","maxTextWidth","arcAngle","sin","getLabelWidth","maxTextHeight","boxHeight","getBBox","width","fontScale","labelText","heightScale","abs","select","nodes","text","lengthToTrimTo","trunc","substr","attr","has_NoNotes","noteIdHovered","note_key","datum_key","_SEARCH_KEY","undefined","appendCircles","nodeRoot","packedData","labelRoot","hasNoNotes","resetNodeStyles","descendants","leaves","selectAll","exit","nodesEnter","enter","append","classed","merge","order","newLabelGroups","newLabelShapes","newLabels","each","newAggregations","newTotalText","aggregations","hideSmall","tooSmall","viewBound","boundWidth","boundHeight","nodeBound","boundOverlap","bound0","bound1","setupZoom","zoomRoot","transformRoot","zoomTo","zoomToTransform","zoomTransform","zoomBehavior","zoom","on","event","call","rootR","rootX","rootY","scaleExtent","translateExtent","floor","bound","animate","zoomIdentity","scale","translate","transition","duration","setupTooltip","tooltip","colorScheme","updateLegend","legend","colorMap","toggleValue","items","toPairs","itemsEnter","disabled","d3Event","createStylesheet","coloring","styleEnter","html","colorNodes","getValue","coloredField","isColoringGroup","colorAnnotations","annotations","setupLegend","legendConfig","update","either","uniq","configs","extraLayers","extraColors","times","currentLayer","previous","hcl","neighbor","hScale","scaleLinear","domain","range","h","cScale","scalePow","exponent","lScale","l","extendColorScheme","zip","fromPairs","memoizeKey","angle","baseAngle","getEdgePositionX","memoizeWith","cos","getEdgePositionY","setupAnnotations","annotationRoot","leafRadius","annotationsEnter","newChangeIcon","annotation","newRingMenu","newBgCircles","newX","newTotalContainer","dk","glyph","showHide","ancestors","a","empty","newAddedContainer","childGlyphs","newAddedText","newChangedContainer","newChangedText","newRemovedContainer","newRemovedText","allEqProps","o1","o2","allPass","eqProps","makeHierarchy","sort","composeComparators","b","localeCompare","comparators","reduceWhile","comparator","findAncestor","hierarchy","findChild","reduced","d3Viz","rootNode","svg","clientWidth","clientHeight","labels","countLabels","selectedNode","nextProps","dataUpdated","sizeUpdated","legendUpdated","repack","resetAnnotations","rerender","resetLegend","resetZoom","ResizeSensor","debounce","selected","sendData","zoomToNode","Visualization","ReactDOM","findDOMNode","mouse","getData","viz","updateFromProps","styles","PureComponent","selectDatasetIntersection","startUid","endUid","startRefresh","stopRefresh","refreshDatasetEpic","url","interval","timer","setIsFetching","fetchDataset","takeUntil","eqUrl","DatasetSelector","DatasetUpload","inputId","ownerUuid","files","faUpload","DatasetDownload","download","faDownload","DatasetRefresh","faRedoAlt","DatasetTimedRefresh","timerIsRunning","onIntervalChange","onStartClick","onStopClick","faSyncAlt","faStopCircle","getDataToExport","exportData","sanitizeForExport","clonedeep","CUSTOM_DATASET","UPLOAD_DATASET","authTypes","Modal","setAppElement","DatasetControls","resetDataset","setDataset","uuid","selectedFile","fetchAndSetDataset","username","password","token","isFetching","authHeader","buildAuthHeader","toURL","onSelected","removeDataset","showUrlEntry","showUpload","authScheme","refreshInterval","refreshTimerRunning","setStartOrEnd","onUpload","onUrlChange","onTokenChange","onUsernameChange","onPasswordChange","onUrlOk","onUrlCancel","onUploadOk","onUploadCancel","getDownloadUrl","fullDatasets","urlObject","URL","webkitURL","json","stringify","blob","Blob","createObjectURL","onRefresh","onTimedRefreshStart","onTimedRefreshStop","removeDatasetEntry","onTimedRefreshIntervalChanged","numInt","parseInt","initialDS","initialDataSource","idsUrl","requiresAuth","protocol","canDownload","canRefresh","err","TypeError","dataControls","dataControlHeader","removable","faMinusCircle","selectorContainer","label","datasetSourceContainer","utilityContainer","fileDownload","urlRefreshContainer","urlRefresh","urlRefreshTime","faCog","lastUpdated","toLocaleDateString","toLocaleTimeString","isOpen","onRequestClose","contentLabel","modal","modalMain","at","scheme","Token","userName","centerSpan","faCheck","faTimes","uploadContainer","fileUpload","uuidv4","configHasChanged","Date","selectDataset","getIsFetching","getLastUpdated","railOuterStyle","borderRadius","cursor","railInnerStyle","pointerEvents","backgroundColor","SliderRail","getRailProps","Handle","handle","percent","getHandleProps","left","WebkitTapHighlightColor","zIndex","role","aria-valuemin","aria-valuemax","aria-valuenow","boxShadow","Track","getTrackProps","Tick","tick","format","marginTop","fontSize","textAlign","marginLeft","DatasetSlider","labelMode","onDragEnter","preventDefault","onDragOver","slider","dataTransfer","setData","onDrop","slot","Number","points","setStartUuid","setEndUuid","onSlotClick","indexOf","onHandleClick","onUpdate","formatTicks","t","defaultValues","p","margin","mode","step","rootStyle","handles","right","tracks","ticks","TooltipControls","handleShowHide","show","handleChangeTitle","handleChangeContent","content","handleLabels","currentLabel","toggleShowNote","showNote","toggleShowDetails","showDetails","saveNote","alert","resetBuilder","keyPressed","componentDidUpdate","prevProps","initialState","tooltipStyle","hide","hidden","faAngleDoubleLeft","shown","faAngleDoubleRight","appStyle","accordionHeader","faAngleDoubleDown","faAngleDoubleUp","detailPanel","detailText","inputStyle","faSave","IMPORT","EXPORT","defaultOptions","App","toggleShowData","showData","showComparison","showNotes","showGrouping","showFiltering","toggleShowComparison","toggleShowNotes","toggleShowGrouping","toggleShowFiltering","onErrorClose","resetControls","showImportOptions","showOptions","showExportOptions","setOptions","processOptions","exportNameChange","exportName","cancelOptions","addDatasetEntry","uuids","newItem","datasetAdded","newUuids","splice","location","params","URLSearchParams","ds_uri","get","initial_data_source","datasetCount","hasDataset","appContainer","hideControls","faHome","section","faPlus","SearchControls","hierarchySection","dimSection","NoteSelector","footerContainer","faFileImport","faFileExport","emptyDataset","canvas","cx","cy","sliderContainer","justifySpan","faDizzy","message","activityIndicatorContainer","sizeUnit","loading","shouldShowBusy","Tooltip","getDerivedStateFromProps","prevState","uniqueUuids","uuidsFromState","uuidsFromProps","uniqueOwners","u","has","getUniqueDatasetList","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","setFilter","clearFilter","filterString","isValid","compileExpression","combineReducers","filterDataset","applyFilter","filtered","filterDatasetEpic","setFilteredDataset","rootEpic","combineEpics","loadDatasetEpic","fetchDatasetEpic","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","middleware","createEpicMiddleware","createStore","rootReducer","applyMiddleware","run","configureStore","render","document","getElementById","origin","fetch","response","status","headers","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker","defaultItemState","hashFields","getHashFields","allFields","applyHashes","obj","hashKey","addHashKey","Array","isArray","addHashWithoutIgnored","searchKey","addSearchKey","_HASH_KEY","uniqueKeys","pathsIn","fieldsFor","overrides","paths","override","configureDataset","initialConfig","valuesFor","setDatasets","removeFilteredDataset","removeDatasetDiff","differences","newDiff","_selectDatasets","_selectMergedConfiguration","some","vals","v","valSet","s","_HASH_WITHOUT_IGNORED","getScheme","Buffer","ajax","rxAjax","lines","trim","delimiter","hdr","delims","delim","finddelim","jsonstring","colnames","formatPayload","initialName","initialShortName","resolveRefs","resolved","final","ValidationError","prototype","concatMap"],"mappings":"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","file":"static/js/main.dae1be26.chunk.js","sourcesContent":["import { createAction, handleActions } from \"redux-actions\";\n\nconst defaultState = {\n  hierarchyConfig: [], // Array of fields to group by.\n  shouldShowNodes: true, // Whether to show individual nodes\n  darkTheme: false, // Whether to use dark theme\n  colorBy: null, // The field for which to color the devices/groupings by.\n  start: null, // The uuid of the dataset to use as the starting point for comparison\n  end: null, // The uuid of the dataset to use as the end point for comparison\n  showBusy: false, //display the activity icon\n  position: [0,0], // The position used for a mouse click\n  datum: null //\n};\n\n// ACTION CREATORS\n\nconst setControls = createAction(\"SET_CONTROLS\");\nconst setStartDataset = createAction(\"SET_START_DATASET\");\nconst setEndDataset = createAction(\"SET_END_DATASET\");\nconst setHierarchyConfig = createAction(\"SET_HIERARCHY_CONFIG\");\nconst showNodes = createAction(\"SHOW_NODES\");\nconst useDarkTheme = createAction(\"USE_DARK_THEME\");\nconst colorBy = createAction(\"COLOR_BY\");\nconst showBusy = createAction(\"SHOW_BUSY\");\nconst setPosition = createAction(\"POSITION\");\nconst setSelectedDatum = createAction(\"SETSELECTEDDATUM\");\n\n// REDUCERS\n\nconst reducer = handleActions(\n  {\n    [setControls]: (state, { payload }) => {\n      const hierarchyConfig = payload.hierarchyConfig || state.hierarchyConfig;\n      const shouldShowNodes = ('shouldShowNodes' in payload) ? !!payload.shouldShowNodes : state.shouldShowNodes;\n      const darkTheme = ('darkTheme' in payload) ? !!payload.darkTheme : state.darkTheme;\n      const colorBy = payload.colorBy || state.colorBy;\n      const start = payload.start || state.start;\n      const end = payload.end || state.end;\n      const showBusy = ('showBusy' in payload) ? !!payload.showBusy : state.showBusy;\n      const position = payload.position || state.position;\n      return { \n        ...state,\n        hierarchyConfig: hierarchyConfig,\n        shouldShowNodes: shouldShowNodes,\n        darkTheme: darkTheme,\n        colorBy: colorBy,\n        start: start,\n        end: end,\n        showBusy: showBusy,\n        position: position\n      }\n    },\n    [setStartDataset]: (state, { payload }) => ({ ...state, start: payload }),\n    [setEndDataset]: (state, { payload }) => ({ ...state, end: payload }),\n    [setHierarchyConfig]: (state, { payload }) => ({ ...state, hierarchyConfig: payload }),\n    [showNodes]: (state, { payload }) => ({ ...state, shouldShowNodes: !!payload }), // Convert payload to boolean for easier debugging\n    [useDarkTheme]: (state, { payload }) => ({ ...state, darkTheme: !!payload }), // Convert payload to boolean for easier debugging\n    [colorBy]: (state, { payload }) => ({ ...state, colorBy: payload }),\n    [showBusy]: (state, { payload }) => ({ ...state, showBusy: !!payload }),\n    [setPosition]: (state, { payload }) => ({ ...state, position: payload }),\n    [setSelectedDatum]: (state, { payload }) => ({ ...state, selectedDatum: payload }),\n  },\n  defaultState\n);\n\n// SELECTORS\nconst selectControls = (state) => state.controls;\nconst getPosition = (state) => state.controls.position;\nconst getSelectedDatum = (state) => state.controls.selectedDatum;\n\nexport default reducer;\nexport { setControls, setHierarchyConfig, showNodes, colorBy, useDarkTheme, selectControls, setStartDataset, setEndDataset, showBusy, setPosition, getPosition, setSelectedDatum, getSelectedDatum };\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"listContainer\":\"AvailableFieldList_listContainer__36HdH\",\"draggableContainer\":\"AvailableFieldList_draggableContainer__1jpWJ\",\"dragForeignContainer\":\"AvailableFieldList_dragForeignContainer__qUoBZ\",\"isDraggingOver\":\"AvailableFieldList_isDraggingOver__jXTLo\",\"field\":\"AvailableFieldList_field__1IO-f\",\"dragForeign\":\"AvailableFieldList_dragForeign__1vOCf\",\"groupBy\":\"AvailableFieldList_groupBy__1kSPM\",\"fieldName\":\"AvailableFieldList_fieldName__33I5k\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"infoPopup\":\"ComparisonSelector_infoPopup__240Ac\",\"dupeContainer\":\"ComparisonSelector_dupeContainer__3C0-X\",\"infoIcon\":\"ComparisonSelector_infoIcon__3NchJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"tags\":\"NoteSelector_tags__3AR7F\",\"tag\":\"NoteSelector_tag__1vpw2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"searchControls\":\"SearchControls_searchControls__380ec\",\"searchContainer\":\"SearchControls_searchContainer__3RTnY\",\"search\":\"SearchControls_search__3qDXJ\",\"label\":\"SearchControls_label__71Clh\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"viz\":\"Visualization_viz__3VNKp\",\"delta\":\"Visualization_delta__1VBcx\",\"plus\":\"Visualization_plus__3RYhX\",\"minus\":\"Visualization_minus__Xc-kq\",\"nag\":\"Visualization_nag__IglHw\",\"fadein\":\"Visualization_fadein__3i5Vd\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dataControls\":\"DatasetControls_dataControls__1C_oE\",\"dataControlHeader\":\"DatasetControls_dataControlHeader__M1Y_F\",\"selectorContainer\":\"DatasetControls_selectorContainer__2nmta\",\"uploadContainer\":\"DatasetControls_uploadContainer__jUCTm\",\"selector\":\"DatasetControls_selector__2We24\",\"fileUpload\":\"DatasetControls_fileUpload__Gh_NX\",\"label\":\"DatasetControls_label__erBn9\",\"utilityContainer\":\"DatasetControls_utilityContainer__3J6Cj\",\"fileDownload\":\"DatasetControls_fileDownload__2Kg7m\",\"urlRefreshContainer\":\"DatasetControls_urlRefreshContainer__3bBD3\",\"datasetSourceContainer\":\"DatasetControls_datasetSourceContainer__30ylz\",\"urlRefresh\":\"DatasetControls_urlRefresh__2CHTE\",\"urlContainer\":\"DatasetControls_urlContainer__2VTWM\",\"urlRefreshTime\":\"DatasetControls_urlRefreshTime__2xMdM\",\"modal\":\"DatasetControls_modal__jdZ5v\",\"modalMain\":\"DatasetControls_modalMain__1QrQI\",\"centerSpan\":\"DatasetControls_centerSpan__owgfw\",\"sliderContainer\":\"DatasetControls_sliderContainer__Jh2f5\",\"sliderSelectedScale\":\"DatasetControls_sliderSelectedScale__3JlNa\",\"slider\":\"DatasetControls_slider__1d372\",\"sliderScale\":\"DatasetControls_sliderScale__2amAl\",\"sliderThumb\":\"DatasetControls_sliderThumb__QDuM1\",\"sliderThumbMin\":\"DatasetControls_sliderThumbMin__vJPNc\",\"sliderThumbMax\":\"DatasetControls_sliderThumbMax__1oeoU\",\"slot\":\"DatasetControls_slot__1gnzO\",\"scaleMark\":\"DatasetControls_scaleMark__1kqtT\",\"slotScale\":\"DatasetControls_slotScale__2jOq8\",\"line\":\"DatasetControls_line__1dPZF\",\"lineSelected\":\"DatasetControls_lineSelected__2tN_e\"};","import { createAction, handleActions } from \"redux-actions\";\n\nconst defaultState = {\n  byId:[],\n  byHash: {\n  },\n  hoverStatus:false,\n  hoveredNoteId:''\n};\n\n// ACTIONS\nconst addNote = createAction(\"ADD_NOTE\");\nconst setNotes = createAction(\"SET_NOTE\");\nconst removeNote = createAction(\"REMOVE_NOTE\");\nconst toggleNotesHover = createAction(\"TOGGLE_NOTES_HOVER\");\nconst setNoteHovered = createAction(\"SET_HOVERED_NOTED\");\n\n// REDUCERS\nconst reducer = handleActions(\n  {\n    [addNote]: (state, { payload }) => {\n      return {\n        byId: [ ...state.byId, payload.id],\n        byHash: {\n          ...state.byHash,\n          [payload.id]: payload\n        }\n      }\n    },\n    [removeNote]: (state, { payload }) => {\n      const prunedIds = state.byId.filter(item => {\n        return item !== payload.id \n      })\n      delete state.byHash[payload.id] \n      \n      return {\n        byId: prunedIds,\n        byHash: state.byHash\n      }\n    },\n\n    [setNotes]: (state, { payload }) => {\n      const byid = payload.byId || state.byId;\n      const byhash = payload.byHash || state.byHash;\n      return {\n        ...state,\n        byId: byid,\n        byHash: byhash,\n      }\n    },\n    [toggleNotesHover]: (state, { payload }) => {\n      const hoverStatus = payload;\n      return {\n        ...state,\n        hoverStatus: hoverStatus,\n      }\n    },\n    [setNoteHovered]: (state, { payload }) => {\n      const hoveredNoteId = payload;\n      //alert(`${hoveredNoteId}`);\n      return {\n        ...state,\n        hoveredNoteId: hoveredNoteId,\n      }\n    },\n  },\n  defaultState\n);\n\n// SELECTORS\nconst getNotesIndexedByHash = (state) => state.notes.byHash;\nconst getAllNotes = (state) => state.notes;\nconst getNotesHoverStatus = (state) => state.notes.hoverStatus;\nconst getNoteHoveredId = (state) => state.notes.hoveredNoteId;\n\n\nexport default reducer;\n\nexport { addNote,setNotes,removeNote, getNotesIndexedByHash, getAllNotes, toggleNotesHover, getNotesHoverStatus, setNoteHovered, getNoteHoveredId};","import { createAction, handleActions } from \"redux-actions\";\n\nconst defaultState = {\n  error: null\n};\n\n// ACTIONS\nconst setError = createAction(\"SET_ERROR\");\nconst clearError = createAction(\"CLEAR_ERROR\");\n\n// REDUCERS\nconst reducer = handleActions(\n  {\n    [setError]: (state, { payload }) => {\n      if( payload instanceof Error )\n      {\n      \tconst error = payload;\n      \treturn { ...state, error };\n      }\n      return { ...state };\n    },\n    [clearError]: (state) => {\n      const error = null;\n      return { ...state, error };\n    }\n  },\n  defaultState\n);\n\n// SELECTORS\nconst getError = (state) => state.error.error;\n\n\nexport default reducer;\n\nexport { setError, getError, clearError};\n","import { ofType } from 'redux-observable';\nimport { isNil, isEmpty } from \"ramda\";\nimport { of } from \"rxjs\";\nimport { mergeMap, map } from 'rxjs/operators';\n\nimport { configurationFor } from \"domain/dataset\";\n\nconst lunr = require(\"lunr\");\n\nconst BUILD_INDICES = \"BUILD_INDICES\";\nconst BUILD_INDICES_SUCCESS = \"BUILD_INDICES_SUCCESS\";\nconst REMOVE_SEARCH_INDEX = \"REMOVE_SEARCH_INDEX\";\n//const BUILD_INDEX_FAILURE = \"BUILD_INDEX_FAILURE\";\nconst SET_SEARCH_RESULTS = \"SET_SEARCH_RESULTS\";\n\nconst buildIndices = (payload) => ({'type': BUILD_INDICES, 'payload': payload })\nconst buildIndicesSuccess = (payload) => ({'type': BUILD_INDICES_SUCCESS, 'payload': payload})\nconst removeSearchIndex = (payload) => ({'type': REMOVE_SEARCH_INDEX, 'payload': payload});\nconst setSearchResults = (payload) => ({'type': SET_SEARCH_RESULTS, 'payload': payload })\n\nconst getSearchResults = (state) => state.search.searchResults || [];\nconst getQueryString = (state) => state.search.queryString;\nconst getSearchIndex = (state, owner) => state.search.searchIndices[owner] || null;\nconst getSearchIndices = (state) => state.search.searchIndices || [];\n\nconst indexDatasetEpic = (action$, store) => {\n  return action$.pipe(\n      ofType(BUILD_INDICES)\n      ,mergeMap(({ payload }) => {\n        return of(payload).pipe(\n            map(generateIndex)\n            ,map((payload) =>\n              buildIndicesSuccess(payload)\n            )\n          );\n      })\n    );\n};\n\nconst searchReducer = (state = { searchIndices: {}, queryString: '', searchResults: null }, action) => {\n  switch (action.type) {\n    case BUILD_INDICES_SUCCESS:\n      action.payload.forEach((item) => {\n        state.searchIndices[item.owner] = item.index;\n      })\n      return {...state };\n    case \n    SET_SEARCH_RESULTS:\n      const searchResults = action.payload.results;\n      const queryString = action.payload.queryString;\n      return { ...state, searchResults, queryString};\n    case \n    REMOVE_SEARCH_INDEX:\n      const rsowner = action.payload.owner;\n      if(state.searchIndices.hasOwnProperty(rsowner))\n        delete state.searchIndices[rsowner];\n\n      return { ...state }\n    default:\n      return state;\n  }\n}\n\nconst flattenDataset = (ds, cfg) => {\n  var flattened = [];\n\n  if(isNil(cfg))\n    return flattened;\n\n  for(var key in ds){\n    var item = {'CRVIZ_SEARCH_KEY':ds[key].CRVIZ[\"_SEARCH_KEY\"]};\n    for(var f in cfg.fields){\n      var field = cfg.fields[f];\n\n      var name = field.displayName.toLowerCase();\n      item[name] = getValueByPath(ds[key], field.path);\n    }\n    flattened.push(item);\n  }\n  return flattened;\n}\n\nconst generateIndex = (payload) => {\n  let indices = [];\n  Object.keys(payload.datasets).forEach((owner) => {\n    const dataset = payload.datasets[owner].dataset;\n    const configuration =  !isNil(payload.datasets[owner].configuration) && !isEmpty(payload.datasets[owner].configuration) \n                        ? payload.datasets[owner].configuration : configurationFor(dataset);\n    var flat = flattenDataset(dataset, configuration);\n    const idx = lunr(function () {\n      this.ref('CRVIZ_SEARCH_KEY');\n      if(configuration && configuration.fields){\n        const filteredFields = configuration.fields.filter(f => !f.displayName.includes(\"/\"))\n        filteredFields.map((field) => { return this.field(field.displayName.toLowerCase()); })\n      }\n      flat.map((item) => { return this.add(item); })\n    });\n\n    indices.push({ owner: owner, index: idx })\n  })\n  \n  return indices;\n};\n\nconst getValueByPath = (object, path) => {\n  if(object && path.length > 0){\n    let current = object[path[0]];\n    \n    for(var i = 1; i < path.length; i++){\n      if(current[path[i]])\n        current = current[path[i]];\n      else\n        return null;\n    }\n    return current;\n  }\n  else{\n    return null;\n  }\n}\n\nexport default indexDatasetEpic;\n\nexport { buildIndices, searchReducer,  getSearchIndex, removeSearchIndex, getSearchIndices, setSearchResults, getSearchResults, getQueryString };\n","import { createAction } from \"redux-actions\";\nimport { Observable, of } from \"rxjs\";\nimport { catchError, debounceTime, mergeMap, map } from 'rxjs/operators';\n\nimport { setError } from \"domain/error\"\n\nimport { loadDataset, CSVconvert } from './load-dataset-epic';\n\n// ACTIONS\nconst uploadDataset = createAction(\"UPLOAD_DATASET\");\n\n// EPIC\nconst uploadDatasetEpic = (action$, store) => {\n  return action$\n    .ofType(uploadDataset.toString()).pipe(\n      mergeMap((action) => {\n        const owner = action.payload.owner;\n        const name = action.payload.name;\n        const shortName = action.payload.shortName;\n        const file = action.payload.file;\n        const includeData = ('includeData' in action.payload) ? action.payload.includeData : true;\n        const includeControls = ('includeControls' in action.payload) ? action.payload.includeControls: false; \n        const includeNotes = ('includeNotes' in action.payload) ? action.payload.includeNotes: false; \n        return fromReader(owner, name, shortName, includeData, includeControls, includeNotes ,file).pipe(\n            debounceTime(500)\n            ,map(CSVconvert)\n            ,map(fromJson)\n            ,map(loadDataset)\n            ,catchError((error) => {\n              if (error instanceof SyntaxError) {\n                const newErr = new Error(\"Invalid JSON.\");\n                return of(setError(newErr));\n              } else {\n                /* istanbul ignore next */\n                throw error;\n              }\n            })\n          )\n      })\n    );\n};\n\n/**\n * Little function to create an observable to read local files.\n * RxJS DOM v5 doesn't have it!?\n */\nconst fromReader = (owner, name, shortName, includeData, includeControls, includeNotes, file) => {\n  return Observable.create((observer) => {\n    const source = file.name;\n    const reader = new window.FileReader();\n\n    reader.addEventListener('load', () => {\n      observer.next({ 'owner': owner, 'name': name, 'shortName': shortName, 'source': source, 'includeData':includeData,\n                      'includeControls': includeControls,'includeNotes':includeNotes, 'file': reader.result });\n      observer.complete();\n    });\n\n    reader.addEventListener('error', () => {\n      observer.error(reader.error);\n      observer.complete();\n    });\n\n    reader.readAsText(file)\n  });\n}\n\nconst fromJson = (payload) =>{\n  const owner = payload.owner;\n  const name = payload.name;\n  const shortName = payload.shortName;\n  const source = payload.source;\n  const content = JSON.parse(payload.file);\n  const includeData = ('includeData' in payload) ? payload.includeData : true;\n  const includeControls = ('includeControls' in payload) ? payload.includeControls: false;\n  const includeNotes = ('includeNotes' in payload) ? payload.includeNotes: false;\n\n  return {\n    'owner': owner,\n    'name': name,\n    'shortName': shortName,\n    'source': source,\n    'content': content, \n    'includeData': includeData,\n    'includeControls': includeControls,\n    'includeNotes': includeNotes,\n  };\n}\n\nexport default uploadDatasetEpic;\nexport { uploadDataset, fromJson };\n","import React from 'react';\nimport ToolTip from 'react-portal-tooltip'\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faInfoCircle } from \"@fortawesome/free-solid-svg-icons\";\nimport { faGithub, faTwitter, faMediumM } from \"@fortawesome/free-brands-svg-icons\";\n\nimport logo from './crlogo.png';\nimport style from './Header.module.css';\n\nclass Header extends React.Component {\n\n\tstate ={\n\t\tshowInfo: false\n\t}\n\n\thideTooltip = () => {\n\t\tthis.setState({\n\t\t\tshowInfo: false\n\t\t})\n\t}\n\n\tshowTooltip = () =>  {\n\t\tthis.setState({\n\t\t\tshowInfo: true\n\t\t})\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className={ style.header }>\n\t\t\t  <a href=\"http://www.cyberreboot.org/\" target=\"_blank\" rel=\"noopener noreferrer\">\n\t\t\t  \t<img src={ logo } className={ style.logo } alt='Cyber Reboot' />\n\t\t\t  </a>\n\t\t\t  <span className={ style.appName }>CRviz</span>\n\t\t\t  <span className={ style.infoIcon }>\n\t\t\t\t<label id=\"showInfo\" onMouseEnter={this.showTooltip} onMouseLeave={this.hideTooltip}>\n\t\t\t      <FontAwesomeIcon icon={faInfoCircle} />\n\t\t\t    </label>\n\t\t\t    <ToolTip active={this.state.showInfo} position=\"bottom\" parent=\"#showInfo\" tooltipTimeout={250}>\n\t\t\t      <div className={ style.infoPopup }>\n\t\t\t        About CRviz:<br/>\n\t\t\t        Home: <a href=\"https://www.cyberreboot.org/projects/crviz/\">https://www.cyberreboot.org/projects/crviz/</a><br/>\n\t\t\t        Version: { process.env.REACT_APP_VERSION } <br/>\n\t\t\t        Copyright © 2017-2019 IQT Labs LLC.\n\t\t\t      </div>\n\t\t\t      <div  className={ style.socialContainer }>\n\t\t\t      \t<a href=\"https://github.com/IQTLabs/\" alt=\"github.com/IQTLabs\" target=\"_blank\" rel=\"noopener noreferrer\">\n\t\t\t      \t\t<FontAwesomeIcon color=\"#7d7d7d\" icon={faGithub} />\n\t\t\t      \t</a>\n\t\t\t      \t<a href=\"https://twitter.com/_cyberreboot\" alt=\"twitter.com/_cyberreboot\" target=\"_blank\" rel=\"noopener noreferrer\">\n\t\t\t      \t\t<FontAwesomeIcon color=\"#7d7d7d\" icon={faTwitter} />\n\t\t\t      \t</a>\n\t\t\t      \t<a href=\"https://blog.cyberreboot.org/\" alt=\"blog.cyberreboot.org\" target=\"_blank\" rel=\"noopener noreferrer\">\n\t\t\t      \t\t<FontAwesomeIcon color=\"#7d7d7d\" icon={faMediumM} />\n\t\t\t      \t</a>\n\t\t\t      </div>\n\t\t\t    </ToolTip>\n\t    \t  </span>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default Header;\n","export default \"data:image/png;base64,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\"","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { Draggable } from \"react-beautiful-dnd\";\n\nimport classNames from \"classnames\";\n\nfunction SelectedField({\n  style,\n  initialItemText,\n  subsequentItemText,\n  displayName,\n  count = 0,\n  index,\n  draggableId,\n  dragIndex,\n  animated\n}) {\n  return (\n    <Draggable draggableId={draggableId} type=\"Field\" index={index}>\n      {\n        (provided, snapshot) => {\n        return (\n          <Field\n            style={style}\n            initialItemText={initialItemText}\n            subsequentItemText={subsequentItemText}\n            displayName={displayName + \" (\" + count + \")\"}\n            dragIndex={dragIndex}\n            provided={provided}\n            animated={animated}\n          />\n        );\n      }}\n    </Draggable>\n  );\n}\n\nfunction Field({ style, initialItemText, subsequentItemText, displayName, dragIndex, animated, provided }) {\n  return (\n    <div>\n      <div\n        className={style.draggable}\n        ref={provided.innerRef}\n        {...provided.draggableProps}\n        {...provided.dragHandleProps}\n      >\n        <div className={style.field}>\n          <span\n            className={classNames({\n              [style.groupBy]: true,\n              [style.animated]: animated\n            })}\n          >\n            {dragIndex === 0 ? initialItemText : subsequentItemText}\n          </span>\n          <span className={style.fieldName}>{displayName}</span>\n        </div>\n      </div>\n\n      {provided.placeholder}\n    </div>\n  );\n}\n\nSelectedField.propTypes = {\n  style: PropTypes.shape({\n    draggable: PropTypes.string.isRequired,\n    field: PropTypes.string.isRequired,\n    groupBy: PropTypes.string.isRequired,\n    fieldName: PropTypes.string.isRequired\n  }),\n  displayName: PropTypes.string.isRequired,\n  index: PropTypes.number.isRequired,\n  draggableId: PropTypes.string.isRequired,\n  dragIndex: PropTypes.number.isRequired,\n  animated: PropTypes.bool.isRequired\n};\n\nexport default SelectedField;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { findIndex, eqBy, differenceWith, isEmpty, isNil, path } from \"ramda\";\n\nimport { Droppable } from \"react-beautiful-dnd\";\n\nimport SelectedField from \"./SelectedField\";\n\nclass SelectedFieldList extends React.Component {\n  state = {\n    lastFields: [],\n    toAnimate: null\n  };\n\n  componentDidMount() {\n    this.setState({\n      lastFields: this.props.fields\n    });\n  }\n\n  static getDerivedStateFromProps(props, state){\n    const { getFieldId } = props;\n\n    // Find newly inserted item, if any\n    let toAnimate = differenceWith(\n      eqBy(getFieldId),\n      props.fields,\n      state.lastFields\n    )[0];\n\n    if (toAnimate) {\n      // Only animate item that are not inserted at the bottom using AffordanceDroppable\n      const newIndex = findIndex(eqBy(getFieldId, toAnimate), props.fields);\n      toAnimate = newIndex < state.lastFields.length ? toAnimate : null;\n    }\n\n    return {\n      lastFields: props.fields,\n      toAnimate: toAnimate\n    };\n  }\n\n  render() {\n    const { style, initialItemText, subsequentItemText, fields, values, getFieldId, droppableId, dragState } = this.props;\n\n    const draggingOver = isDraggingOver(droppableId, dragState);\n    return (\n      <div className={style.listContainer}>\n        <Droppable droppableId={droppableId} type=\"Field\">\n          {\n            (provided, snapshot) => {\n            return (\n              <div\n                ref={provided.innerRef}\n                {...provided.droppableProps}\n                className={style.droppable}\n              >\n                <List\n                  style={style}\n                  initialItemText={initialItemText}\n                  subsequentItemText={subsequentItemText}\n                  fields={fields}\n                  values={values}\n                  getFieldId={getFieldId}\n                  droppableId={droppableId}\n                  dragState={dragState}\n                  toAnimate={this.state.toAnimate}\n                />\n\n                {draggingOver &&\n                  dragState.destination.index !== fields.length &&\n                  provided.placeholder}\n              </div>\n            );\n          }}\n        </Droppable>\n      </div>\n    );\n  }\n}\n\nfunction List({\n  fields,\n  values,\n  getFieldId,\n  style,\n  initialItemText,\n  subsequentItemText,\n  droppableId,\n  dragState,\n  toAnimate\n}) {\n  if (isEmpty(fields)) {\n    return null;\n  }\n  return fields.map((field, index) => {\n    const id = getFieldId(field);\n    const animated = toAnimate && getFieldId(field) === getFieldId(toAnimate);\n    const count = values[id].length\n    return (\n      <SelectedField\n        style={style}\n        initialItemText={initialItemText}\n        subsequentItemText={subsequentItemText}\n        draggableId={id}\n        key={id}\n        displayName={field.displayName}\n        count={count}\n        index={index}\n        dragIndex={dragIndex(droppableId, dragState, index)}\n        animated={animated || false}\n      />\n    );\n  });\n}\n\nconst isDraggingOver = (droppableId, dragState) => {\n  return (\n    !isNil(dragState) &&\n    path([\"destination\", \"droppableId\"], dragState) === droppableId\n  );\n};\n\n/**\n * Calculate the potential indices during drag based on the current dragState.\n *\n * This is used to update the groupBy label on the fly.\n */\nconst dragIndex = (droppableId, dragState, index) => {\n  if (!isDraggingOver(droppableId, dragState)) {\n    return index;\n  }\n\n  const { source, destination } = dragState;\n\n  const from = source.index;\n  const to = destination.index;\n\n  // When inserting, bump down everything below the new index\n  if (source.droppableId !== destination.droppableId) {\n    return index >= to ? index + 1 : index;\n  }\n\n  // For an item that is being dragged, the new index is the destination index.\n  if (index === from) {\n    return to;\n  }\n  // Items not between the source and destination indices are not affected\n  if (index < Math.min(from, to) || index > Math.max(from, to)) {\n    return index;\n  }\n\n  if (from < to) {\n    // If moving down, bump up everything in between\n    return index - 1;\n  } else {\n    // Otherwise, bump down everything in between\n    return index + 1;\n  }\n};\n\nSelectedFieldList.defaultProps = {\n  fields: []\n};\n\nSelectedFieldList.propTypes = {\n  fields: PropTypes.array,\n  droppableId: PropTypes.string.isRequired,\n  getFieldId: PropTypes.func.isRequired,\n\n  style: PropTypes.shape({\n    listContainer: PropTypes.string.isRequired,\n    draggable: PropTypes.string.isRequired,\n    field: PropTypes.string.isRequired,\n    groupBy: PropTypes.string.isRequired\n  })\n};\n\nexport default SelectedFieldList;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Draggable } from \"react-beautiful-dnd\";\n\nfunction AvailableField({ style, displayName, index, draggableId }) {\n  return (\n    <Draggable draggableId={draggableId} type=\"Field\" index={index}>\n      {(provided, snapshot) => {\n        return (\n          <span className={style.draggableContainer}>\n            <span\n              className={style.field}\n              ref={provided.innerRef}\n              {...provided.draggableProps}\n              {...provided.dragHandleProps}\n              style={{\n                ...provided.draggableProps.style,\n                // Disable animation of items moving out of the way when\n                // dragging. It implies the list is sortable, and it doesn't\n                // work well with multiline list anyway.\n                transform: snapshot.isDragging\n                  ? provided.draggableProps.style.transform\n                  : \"none\"\n              }}\n            >\n              {displayName}\n            </span>\n          </span>\n        );\n      }}\n    </Draggable>\n  );\n}\n\nconst StyleProps = PropTypes.shape({\n  draggableContainer: PropTypes.string.isRequired,\n  field: PropTypes.string.isRequired,\n});\n\nAvailableField.propTypes = {\n  style: StyleProps.isRequired,\n  displayName: PropTypes.string.isRequired,\n  index: PropTypes.number.isRequired,\n  draggableId: PropTypes.string.isRequired\n};\n\nexport default AvailableField;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport classNames from \"classnames\";\n\nimport { isEmpty, contains, map, sortBy, curry } from \"ramda\";\n\nimport { Droppable } from \"react-beautiful-dnd\";\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTrashAlt } from \"@fortawesome/free-solid-svg-icons\";\n\nimport AvailableField from \"./AvailableField\";\n\nfunction AvailableFieldList({\n  style,\n  fields,\n  values,\n  getFieldId,\n  droppableId,\n  dragState\n}) {\n  return (\n    <Droppable droppableId={droppableId} type=\"Field\">\n      {(provided, snapshot) => {\n        const dragForeign = isDraggingForeign(dragState, fields, getFieldId);\n\n        return (\n          <div\n            className={classNames(style.listContainer, {\n              [style.dragForeign]: dragForeign,\n              [style.isDraggingOver]: snapshot.isDraggingOver\n            })}\n            ref={provided.innerRef}\n            {...provided.droppableProps}\n          >\n            {!isEmpty(fields) &&\n              sortBy(getCount(getFieldId, values), fields).map((field, index) => {\n                const id = getFieldId(field);\n                const count = values[id].length || 0;\n                return (\n                  <AvailableField\n                    style={style}\n                    key={id}\n                    draggableId={id}\n                    displayName={`${field.displayName} (${count})`}\n                    index={index}\n                    withPlaceholder={false}\n                  />\n                );\n              })}\n\n            {dragForeign && (\n              <div className={style.dragForeignContainer}>\n                <span>\n                  <FontAwesomeIcon icon={faTrashAlt} />\n                </span>\n              </div>\n            )}\n          </div>\n        );\n      }}\n    </Droppable>\n  );\n}\n\nconst getCount = curry((getFieldId, values, field) => {\n  return values[getFieldId(field)].length;\n});\n\nconst isDraggingForeign = (dragState, fields, getFieldId) => {\n  return (\n    dragState &&\n    dragState.draggableId &&\n    !contains(dragState.draggableId, map(getFieldId, fields))\n  );\n};\n\nAvailableFieldList.defaultProps = {\n  fields: []\n};\n\nconst StyleProps = PropTypes.shape({\n  listContainer: PropTypes.string.isRequired,\n  field: PropTypes.string.isRequired,\n  fieldName: PropTypes.string.isRequired\n});\n\nAvailableFieldList.propTypes = {\n  style: StyleProps.isRequired,\n  fields: PropTypes.array,\n  values: PropTypes.object,\n  getFieldId: PropTypes.func.isRequired,\n  droppableId: PropTypes.string.isRequired\n};\n\nexport default AvailableFieldList;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport classNames from \"classnames\";\nimport { Droppable } from \"react-beautiful-dnd\";\n\n/**\n * Droppable component to use as a dummy drop target next to SelectedFieldList.\n * This droppable doesn't contain any draggable.\n *\n * Note: this cannot be used nested inside SelectedFieldList, because they need\n * to accept the same type, and react-beautiful-dnd doesn't allow that.\n */\nfunction DropTarget({ style, initialItemText, subsequentItemText, droppableId, isDropDisabled, fields }) {\n  return (\n    <div\n      className={classNames({\n        [style.listContainer]: true,\n        [style.isDropDisabled]: isDropDisabled\n        })}>\n      <div className={style.draggable}>\n        <div className={style.field}>\n          <span className={style.groupBy}>\n            { fields.length === 0 ? initialItemText : subsequentItemText }\n          </span>\n\n          <Droppable\n            isDropDisabled={ isDropDisabled }\n            droppableId={droppableId}\n            type=\"Field\">\n\n            {(provided, snapshot) => {\n              return (\n                <span\n                  ref={provided.innerRef}\n                  {...provided.droppableProps}\n                  className={\n                    classNames({\n                      [style.dropTarget]: true,\n                      [style.isDraggingOver]: snapshot.isDraggingOver\n                    })}\n                >\n                    Drop attribute here\n                </span>\n              )\n            }}\n          </Droppable>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nDropTarget.propTypes = {\n  style: PropTypes.shape({\n    isDropDisabled: PropTypes.string.isRequired,\n    dropTarget: PropTypes.string.isRequired,\n    isDraggingOver: PropTypes.string.isRequired,\n\n    // The classes below should be identical to the styling of SelectedFieldList\n    // to make both layout the same.\n    listContainer: PropTypes.string.isRequired,\n    draggable: PropTypes.string.isRequired,\n    field: PropTypes.string.isRequired,\n    groupBy: PropTypes.string.isRequired,\n  }),\n\n  droppableId: PropTypes.string.isRequired,\n  isDropDisabled: PropTypes.bool.isRequired,\n  fields: PropTypes.array.isRequired\n}\n\n\nexport default DropTarget;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\nimport { DragDropContext} from 'react-beautiful-dnd';\n\nimport {\n  compose,\n  differenceWith,\n  eqBy,\n  equals,\n  find,\n  findIndex,\n  identity,\n  insert,\n  isEmpty,\n  isNil,\n  path,\n  remove\n} from \"ramda\";\n\nimport { selectMergedConfiguration, selectMergedValues, getFieldId } from \"domain/dataset\";\nimport { setHierarchyConfig, selectControls, showNodes } from \"domain/controls\";\n\nimport SelectedFieldList from 'features/drag-drop-utils/SelectedFieldList';\nimport AvailableFieldList from 'features/drag-drop-utils/AvailableFieldList';\nimport DropTarget from 'features/drag-drop-utils/DropTarget';\n\nimport availableFieldListStyle from 'features/drag-drop-utils/AvailableFieldList.module.css';\nimport selectedFieldListStyle from 'features/drag-drop-utils/SelectedFieldList.module.css';\n\nconst SELECTED_FIELD_LIST_ID = 'SelectedFieldList';\nconst AVAILABLE_FIELD_LIST_ID = 'AvailableFieldList';\nconst DROP_TARGET_ID = 'DropTarget';\n\nclass HierarchySelector extends React.Component {\n\n  state = {\n    dragState: null\n  }\n\n  onDragStart = (dragStart) => {\n    this.setState({\n      dragState: dragStart\n    });\n  }\n\n  onDragUpdate = (dragUpdate) => {\n    this.setState({\n      dragState: dragUpdate\n    })\n  }\n\n  onDragEnd = (dropResult) => {\n    const { draggableId, destination } = dropResult;\n    this.setState({ dragState: null })\n\n    if (destination === null) {\n      return;\n    } else if (destination.droppableId === SELECTED_FIELD_LIST_ID) {\n      this.updateHierarchy(draggableId, destination.index)\n    } else if (destination.droppableId === (DROP_TARGET_ID)) {\n      this.updateHierarchy(draggableId, this.props.controls.hierarchyConfig.length);\n    } else {\n      this.removeField(draggableId);\n    }\n  }\n\n  updateHierarchy = (fieldId, newIndex) => {\n    const { fields } = this.props.configuration;\n    const { hierarchyConfig } = this.props.controls;\n\n    const index = findFieldIndex(hierarchyConfig, fieldId);\n    if (index === newIndex) { return; }\n\n    const hasId = (id) => (field) => getFieldId(field) === id;\n    const field = find(hasId(fieldId), fields)\n\n    const removeOld = isNil(index) ? identity : remove(index, 1);\n    const addNew = insert(newIndex, field);\n    const updatedHierarchy = compose(addNew, removeOld)(hierarchyConfig)\n\n    this.props.setHierarchyConfig(updatedHierarchy)\n  }\n\n  removeField = (fieldId) => {\n    const { hierarchyConfig } = this.props.controls;\n    const { setHierarchyConfig } = this.props;\n    const index = findFieldIndex(hierarchyConfig, fieldId);\n\n    if (index !== null) {\n      setHierarchyConfig(remove(index, 1, hierarchyConfig ))\n    }\n\n    if(this.props.controls.hierarchyConfig.length === 0 ){\n      this.props.showNodes(true);\n    }\n  }\n\n  render() {\n    if (this.props.configuration === null) {\n      return null;\n    }\n\n    const hierarchyConfig = this.props.controls.hierarchyConfig;\n    if (isEmpty(this.props.configuration.fields)) {\n      return null;\n    }\n\n    const availableFields = differenceWith(\n      eqBy(getFieldId),\n      this.props.configuration.fields.filter((f) => f.groupable),\n      hierarchyConfig\n    );\n\n    const values = this.props.values;\n\n    const dragState = this.state.dragState;\n\n    return (\n      <div>\n        <DragDropContext\n          onDragStart={ this.onDragStart }\n          onDragUpdate={ this.onDragUpdate }\n          onDragEnd={ this.onDragEnd }>\n\n          <div style={{ marginBottom: '2rem' }}>\n            <SelectedFieldList\n              style={ selectedFieldListStyle }\n              initialItemText=\"Group By\"\n              subsequentItemText=\"Then By\"\n              fields={ hierarchyConfig }\n              values={ values }\n              droppableId={ SELECTED_FIELD_LIST_ID }\n              getFieldId={ getFieldId }\n              dragState={ dragState }\n            />\n\n          <DropTarget\n            style={ selectedFieldListStyle }\n            initialItemText=\"Group By\"\n            subsequentItemText=\"Then By\"\n            isDropDisabled={ path(['source', 'droppableId'], dragState) === SELECTED_FIELD_LIST_ID }\n            droppableId= { DROP_TARGET_ID }\n            fields={ this.props.controls.hierarchyConfig }\n          />\n        </div>\n\n          <AvailableFieldList\n            style={ availableFieldListStyle }\n            fields={ availableFields }\n            values={ values }\n            droppableId={ AVAILABLE_FIELD_LIST_ID }\n            getFieldId={ getFieldId }\n            dragState={ this.state.dragState }\n          />\n\n        </DragDropContext>\n      </div>\n    );\n  }\n}\n\nHierarchySelector.propTypes = {\n  configuration: PropTypes.shape({\n    fields: PropTypes.array.isRequired\n  }),\n  controls: PropTypes.shape({\n    hierarchyConfig: PropTypes.array.isRequired\n  }),\n  showNodes: PropTypes.func.isRequired\n};\n\nconst findFieldIndex = (list, fieldId) => {\n  const matchId = compose(equals(fieldId), getFieldId)\n  const index = findIndex(matchId, list)\n  return index === -1 ? null : index;\n}\n\nconst mapStateToProps = (state) => ({\n  configuration: selectMergedConfiguration(state),\n  values: selectMergedValues(state),\n  controls: selectControls(state)\n});\n\nconst mapDispatchToProps = {\n  setHierarchyConfig,\n  showNodes\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HierarchySelector);\n","import { ofType } from 'redux-observable';\nimport { of } from \"rxjs\";\nimport { switchMap, map } from 'rxjs/operators';\n\nimport { setDatasetDiff } from \"domain/dataset\";\n\nconst DIFF_DATASET = \"DIFF_DATASET\";\n\nconst diffDataset = (payload) => ({'type': DIFF_DATASET, 'payload': payload })\n\nconst diffDatasetEpic = (action$, store) => {\n  return action$.pipe(\n      ofType(DIFF_DATASET)\n      ,switchMap(({ payload }) => {\n        return of(payload).pipe(\n        \tmap(generateDiff)\n          ,map((payload) =>\n            setDatasetDiff(payload)\n          )\n        );\n      })\n    );\n};\n\n\nconst generateDiff = (payload) => {\n  const startOwner = payload.start.owner;\n  const startDs = payload.start.dataset;\n  const endOwner = payload.end.owner;\n  const endDs = payload.end.dataset;\n\n  let diffs = {\n  \tadded: [],\n  \tchanged:[],\n  \tremoved:[]\n  };\n  diffs.added = diffs.added.concat(endDs.filter(ei => startDs.findIndex(si => si.CRVIZ[\"_HASH_KEY\"] === ei.CRVIZ[\"_HASH_KEY\"]) === -1).map(i => i.CRVIZ[\"_HASH_KEY\"]));\n  diffs.removed = diffs.removed.concat(startDs.filter(si => endDs.findIndex(ei => ei.CRVIZ[\"_HASH_KEY\"] === si.CRVIZ[\"_HASH_KEY\"]) === -1).map(i => i.CRVIZ[\"_HASH_KEY\"]));\n\n  diffs.changed = diffs.changed.concat(\n  \tendDs.filter(\n  \t\tei => startDs.findIndex(\n  \t\t\tsi => si.CRVIZ[\"_HASH_KEY\"] === ei.CRVIZ[\"_HASH_KEY\"] &&\n  \t\t\t\t\t\tsi.CRVIZ[\"_HASH_WITHOUT_IGNORED\"] !== ei.CRVIZ[\"_HASH_WITHOUT_IGNORED\"]\n  \t\t) !== -1\n  \t).map(i => i.CRVIZ[\"_HASH_KEY\"])\n  );\n\n  //console.log(\"diffs to return: %o\", diffs);\n  const result = {\n  \t'start': startOwner,\n  \t'end': endOwner,\n  \t'differences': diffs\n  }\n  return result;\n};\n\nexport default diffDatasetEpic;\n\nexport { diffDataset };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\nimport { DragDropContext} from 'react-beautiful-dnd';\nimport ToolTip from 'react-portal-tooltip'\nimport {\n  compose,\n  differenceWith,\n  eqBy,\n  equals,\n  find,\n  findIndex,\n  identity,\n  insert,\n  isEmpty,\n  isNil,\n  path,\n  remove\n} from \"ramda\";\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faDumpsterFire } from \"@fortawesome/free-solid-svg-icons\";\n\nimport { \n  selectMergedConfiguration, selectMergedValues, getFieldId, selectDatasets,\n  setKeyFields, getKeyFields, setIgnoredFields, getIgnoredFields\n} from \"domain/dataset\";\nimport { diffDataset } from \"epics/diff-dataset-epic\";\n\nimport SelectedFieldList from 'features/drag-drop-utils/SelectedFieldList';\nimport AvailableFieldList from 'features/drag-drop-utils/AvailableFieldList';\nimport DropTarget from 'features/drag-drop-utils/DropTarget';\n\nimport availableFieldListStyle from 'features/drag-drop-utils/AvailableFieldList.module.css';\nimport selectedFieldListStyle from 'features/drag-drop-utils/SelectedFieldList.module.css';\nimport style from './ComparisonSelector.module.css';\n\nconst KEY_FIELD_LIST_ID = 'KeyFieldList';\nconst IGNORED_FIELD_LIST_ID = 'IgnoredFieldList';\nconst AVAILABLE_FIELD_LIST_ID = 'AvailableFieldList';\nconst KEY_TARGET_ID = 'KeyTarget';\nconst IGNORED_TARGET_ID = 'IgnoredTarget';\n\nclass ComparisonSelector extends React.Component {\n\n  state = {\n    dragState: null,\n    showDupeTooltip: false\n  }\n\n  onDragStart = (dragStart) => {\n    this.setState({\n      dragState: dragStart\n    });\n  }\n\n  onDragUpdate = (dragUpdate) => {\n    this.setState({\n      dragState: dragUpdate\n    })\n  }\n\n  onDragEnd = (dropResult) => {\n    const { draggableId, destination } = dropResult;\n    this.setState({ dragState: null })\n\n    if (destination === null) {\n      return;\n    } else if (destination.droppableId === KEY_FIELD_LIST_ID) {\n      this.updateKeyFields(draggableId, destination.index)\n    } else if (destination.droppableId === (KEY_TARGET_ID)) {\n      this.updateKeyFields(draggableId, this.props.keyFields.length);\n    } else if (destination.droppableId === IGNORED_FIELD_LIST_ID) {\n      this.updateIgnoreFields(draggableId, destination.index)\n    } else if (destination.droppableId === (IGNORED_TARGET_ID)) {\n      this.updateIgnoreFields(draggableId, this.props.ignoredFields.length);\n    } else {\n      this.removeField(draggableId);\n    }\n  }\n\n  getUpdatedFields = (fieldId, newIndex, fieldsToUpdate) =>{\n  \tconst { fields } = this.props.configuration;\n\n  \tconst index = findFieldIndex(fieldsToUpdate, fieldId);\n    if (index === newIndex) { return; }\n\n    const hasId = (id) => (field) => getFieldId(field) === id;\n    const field = find(hasId(fieldId), fields)\n\n    const removeOld = isNil(index) ? identity : remove(index, 1);\n    const addNew = insert(newIndex, field);\n    const updatedFields = compose(addNew, removeOld)(fieldsToUpdate);\n\n    return updatedFields;\n  }\n\n  updateKeyFields = (fieldId, newIndex) =>{\n    const keyFields = this.props.keyFields;\n    const ignoredFields = this.props.ignoredFields;\n\n    const updatedKeys = this.getUpdatedFields(fieldId, newIndex, keyFields);\n    \n    if(updatedKeys){\n    \tthis.props.setKeyFields(updatedKeys);\n      this.updateDiff(updatedKeys, ignoredFields);\n    }\n  }\n\n  updateIgnoreFields = (fieldId, newIndex) =>{\n    const keyFields = this.props.keyFields;\n    const ignoredFields = this.props.ignoredFields;\n\n    const updatedIgnored = this.getUpdatedFields(fieldId, newIndex, ignoredFields);\n\n    if(updatedIgnored){\n    \tthis.props.setIgnoredFields(updatedIgnored);\n      this.updateDiff(keyFields, updatedIgnored);\n\t  }\n  }\n\n  removeField = (fieldId) => {\n    const keyFields = this.props.keyFields;\n    const keyIndex = findFieldIndex(keyFields, fieldId);\n\n    const ignoredFields = this.props.ignoredFields;\n    const ignoredIndex = findFieldIndex(ignoredFields, fieldId);\n\n    let updatedKeys = null;\n    let updatedIgnored = null;\n\n    if (keyIndex !== null) {\n      updatedKeys = remove(keyIndex, 1, keyFields );\n      this.props.setKeyFields(updatedKeys);\n    }\n\n    if (ignoredIndex !== null) {\n      updatedIgnored = remove(ignoredIndex, 1, ignoredFields );\n      this.props.setIgnoredFields(updatedIgnored);      \n    }\n\n    if(updatedKeys || updatedIgnored){\n      this.updateDiff(updatedKeys || keyFields, updatedIgnored || ignoredFields);\n    }\n  }\n\n  updateDiff = (keyFields, ignoredFields) => {\n    if(this.props.start && this.props.end){\n      const toDiff ={\n        'start': {\n          'owner': this.props.startUuid,\n          'dataset': this.props.start\n        },\n        'end':{\n          'owner': this.props.endUuid,\n          'dataset': this.props.end\n        },\n        'configuration': this.props.configuration,\n        'key': keyFields,\n        'ignore': ignoredFields,\n      }\n\n      this.props.diffDataset(toDiff);\n    }\n  }\n\n  showDupeTooltip = () => {\n    this.setState({\n      showDupeTooltip: true\n    })\n  }\n\n  hideDupeTooltip = () => {\n    this.setState({\n      showDupeTooltip: false\n    })\n  }\n\n  render() {\n    if (this.props.configuration === null) {\n      return null;\n    }\n    const keyInfo = this.props.keyInfo;\n    const hasDupes = keyInfo.reduce((total, current) => total + current.duplicateCount, 0);\n    const keyFields = this.props.keyFields;\n    const ignoredFields = this.props.ignoredFields;\n    const usedFields = keyFields ? keyFields.concat(ignoredFields) : [];\n\n    if (isEmpty(this.props.configuration.fields)) {\n      return null;\n    }\n\n    const availableFields = differenceWith(\n      eqBy(getFieldId),\n      this.props.configuration.fields.filter((f) => f.groupable),\n      usedFields\n    );\n\n    const values = this.props.values;\n\n    const dragState = this.state.dragState;\n\n    return (\n      <div>\n        <div className={style.dupeContainer}>\n          {!!hasDupes &&\n            <span className={ style.infoIcon }>\n              <div id=\"showDupeInfo\" onMouseEnter={this.showDupeTooltip} onMouseLeave={this.hideDupeTooltip}>\n                <FontAwesomeIcon icon={faDumpsterFire} color=\"#cc0000\" />\n              </div>\n              <ToolTip active={this.state.showDupeTooltip} position=\"bottom\" parent=\"#showDupeInfo\" tooltipTimeout={250}>\n                <div className={ style.infoPopup }>\n                  Keying on the selected field(s) results in duplicate keys.<br/>\n                  {keyInfo.map( (ki) => {\n                    return(\n                      <div>\n                        <strong>{ki.name} </strong> &mdash; {ki.duplicateCount} duplicates <br/>\n                      </div>\n                      );\n                  })}\n                  This may lead to inaccurate change data being shown. Please\n                  verify your key and underlying data. \n                </div>\n              </ToolTip>\n            </span>\n          }\n        </div>\n        <DragDropContext\n          onDragStart={ this.onDragStart }\n          onDragUpdate={ this.onDragUpdate }\n          onDragEnd={ this.onDragEnd }>\n\n          <div style={{ marginBottom: '2rem' }}>\n          \n            <SelectedFieldList\n              style={ selectedFieldListStyle }\n              initialItemText=\"Key On\"\n              subsequentItemText=\"And\"\n              fields={ keyFields }\n              values={ values }\n              droppableId={ KEY_FIELD_LIST_ID }\n              getFieldId={ getFieldId }\n              dragState={ dragState }\n            />\n\n          <DropTarget\n            style={ selectedFieldListStyle }\n            initialItemText=\"Key On\"\n              subsequentItemText=\"And\"\n            isDropDisabled={ path(['source', 'droppableId'], dragState) === KEY_FIELD_LIST_ID }\n            droppableId= { KEY_TARGET_ID }\n            fields={ this.props.keyFields }\n          />\n        </div>\n\n        <div style={{ marginBottom: '2rem' }}>\n            <SelectedFieldList\n              style={ selectedFieldListStyle }\n              initialItemText=\"Ignore\"\n              subsequentItemText=\"And\"\n              fields={ ignoredFields }\n              values={ values }\n              droppableId={ IGNORED_FIELD_LIST_ID }\n              getFieldId={ getFieldId }\n              dragState={ dragState }\n            />\n\n          <DropTarget\n            style={ selectedFieldListStyle }\n            initialItemText=\"Ignore\"\n            subsequentItemText=\"And\"\n            isDropDisabled={ path(['source', 'droppableId'], dragState) === IGNORED_FIELD_LIST_ID }\n            droppableId= { IGNORED_TARGET_ID }\n            fields={ this.props.ignoredFields }\n          />\n        </div>\n\n          <AvailableFieldList\n            style={ availableFieldListStyle }\n            fields={ availableFields }\n            values={ values }\n            droppableId={ AVAILABLE_FIELD_LIST_ID }\n            getFieldId={ getFieldId }\n            dragState={ this.state.dragState }\n          />\n\n        </DragDropContext>\n      </div>\n    );\n  }\n}\n\nComparisonSelector.propTypes = {\n  startUuid: PropTypes.string,\n  start: PropTypes.array,\n  endUuid: PropTypes.string,\n  end: PropTypes.array,\n  keyInfo: PropTypes.array.isRequired,\n  keyFields: PropTypes.array.isRequired,\n  ignoredFields: PropTypes.array.isRequired,\n  configuration: PropTypes.shape({\n    fields: PropTypes.array.isRequired\n  }),\n};\n\nconst findFieldIndex = (list, fieldId) => {\n  const matchId = compose(equals(fieldId), getFieldId)\n  const index = findIndex(matchId, list)\n  return index === -1 ? null : index;\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  const datasets = selectDatasets(state);\n  const keyInfo = Object.keys(datasets).map(key => \n    ({ \n      'owner': key, \n      'name': datasets[key].name, \n      'keyCount': isNaN(datasets[key].keyCount) ? 0 : datasets[key].keyCount,\n      'uniqueKeyCount': isNaN(datasets[key].uniqueKeyCount) ? 0 : datasets[key].uniqueKeyCount,\n      'duplicateCount': isNaN(datasets[key].keyCount - datasets[key].uniqueKeyCount) ? 0 : datasets[key].keyCount - datasets[key].uniqueKeyCount }));\n\n  return{\n    start: datasets[ownProps.startUuid],\n    end: datasets[ownProps.endUuid],\n    keyInfo: keyInfo,\n    keyFields: getKeyFields(state),\n    ignoredFields: getIgnoredFields(state),\n    configuration: selectMergedConfiguration(state),\n    values: selectMergedValues(state)\n  }\n};\n\nconst mapDispatchToProps = {\n  setKeyFields,\n  setIgnoredFields,\n  diffDataset\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ComparisonSelector);\n","import React from \"react\";\nimport { connect } from \"react-redux\";\n\nimport { \n  toggleNotesHover,\n  setNoteHovered,\n  getNotesIndexedByHash\n} from \"domain/notes\";\n\nimport style from './NoteSelector.module.css';\n\nclass Note extends React.Component {\n  constructor(props){\n    super(props);\n    this.clicked = false;\n    this.state = {\n      hover: false\n    };\n  }\n\n  setHoveredNoteId = () =>{ \n    this.props.hoverMethod(this.props.index);\n    this.props.hoverOn();\n  }\n\n  setClickedNoteId = () =>{\n    this.props.hoverMethod(this.props.index);\n    this.props.clickedOn();\n  }\n\n  render() {\n    return (\n      <li\n        onClick={this.setClickedNoteId}\n        onMouseEnter={this.setHoveredNoteId}\n        onMouseLeave={this.props.hoverOff}\n        className={style.tag}\n      >\n        {this.props.note_title}\n      </li>\n    );\n  }\n}\n\nclass NoteSelectorList extends React.Component {\n  clickedOn = () => {\n    if (this.clicked === false) {\n      this.props.toggleNotesHover(false);\n      this.clicked = true;\n    } else {\n      this.props.toggleNotesHover(true);\n      this.clicked = false;\n    }\n  }\n\n  hoverOn = () => {\n    this.props.toggleNotesHover(true);\n  }\n\n  hoverOff = () => {\n    if(this.clicked === true) {\n      this.props.toggleNotesHover(true);\n    } else {\n      this.props.toggleNotesHover(false);\n    }\n  }\n  render() {\n    return (\n      <ul className={style.tags}>\n        {Object.values(this.props.notes).map(note => {\n          return <Note key={`${note.id}`} index={note.id} clicked={this.clicked} note_title={note.note.title} clickedOn={this.clickedOn} hoverOn={this.hoverOn} hoverOff={this.hoverOff} hoverMethod={this.props.setNoteHovered} />;\n        })}\n      </ul>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    notes: getNotesIndexedByHash(state)\n  }\n};\n\nconst mapDispatchToProps = {\n  toggleNotesHover,\n  setNoteHovered\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(NoteSelectorList);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  sortBy,\n  curry,\n  compose,\n  join,\n  split,\n  find,\n  propEq,\n  prop,\n  isNil\n} from \"ramda\";\n\nfunction FieldSelect({\n  fields,\n  values,\n  getFieldId,\n  value,\n  onChange,\n  className,\n  name\n}) {\n\n  return (\n    <div className={className}>\n      <label className=\"select\">\n        <select\n          \n          name={name}\n          onChange={(evt) => onChange(stringToField(fields, evt.target.value))}\n          value={isNil(value) ? \"\" : fieldToString(value)}\n        >\n          <option value=\"\">&mdash;None&mdash;</option>\n          {sortBy(getCount(getFieldId, values), fields).map((field) => {\n            const key = getFieldId(field);\n            return (\n              <option key={key} value={key}>\n                {field.displayName} ({values[getFieldId(field)].length})\n              </option>\n            );\n          })}\n        </select>\n      </label>\n    </div>\n  );\n}\n\nconst getCount = curry((getFieldId, values, field) => {\n  return values[getFieldId(field)].length;\n});\n\nconst FieldShape = PropTypes.shape({\n  path: PropTypes.array.isRequired,\n  displayName: PropTypes.string.isRequired\n});\n\nFieldSelect.propTypes = {\n  fields: PropTypes.arrayOf(FieldShape).isRequired,\n  value: FieldShape,\n  onChange: PropTypes.func.isRequired,\n  className: PropTypes.string,\n  name: PropTypes.string\n};\n\nconst fieldToString = compose(join(\".\"), prop(\"path\"));\n\nconst stringToField = (fields, string) => {\n  const path = split(\".\", string);\n  return find(propEq(\"path\", path), fields);\n};\n\nexport default FieldSelect;\n","import React from \"react\";\nimport { connect } from \"react-redux\";\n\nimport {\n  showNodes,\n  useDarkTheme,\n  colorBy,\n  selectControls\n} from \"domain/controls\";\nimport { selectMergedConfiguration, selectMergedValues, getFieldId } from \"domain/dataset\";\n\nimport FieldSelect from \"./FieldSelect\";\n\nimport style from \"./MiscControls.module.css\";\n\nfunction MiscControls(props) {\n  const {\n  controls,\n  configuration,\n  values,\n  showNodes,\n  colorBy,\n  } = props;\n  const fields = configuration.fields.filter((f) => f.groupable);\n  const darkThemeChanged = (checked) => {\n    props.useDarkTheme(checked)\n  };\n  return (\n    <div className={style.container}>\n      <div className={`${style.checkboxContainer} input-group`}>\n        <div className={ style.switch }>\n          <input\n            type=\"checkbox\"\n            id=\"show-node-check\"\n            checked={controls.shouldShowNodes}\n            onChange={(evt) => showNodes(evt.target.checked)}\n          />\n          <label htmlFor=\"show-node-check\" className={ style.switchLabel }>\n          </label>\n        </div>\n        <label >Show nodes</label>\n      </div>\n\n      <div className={`${style.checkboxContainer} input-group`}>\n        <div className={ style.switch }>\n          <input\n            type=\"checkbox\"\n            id=\"dark-theme-check\"\n            checked={controls.darkTheme}\n            onChange={(evt) => darkThemeChanged(evt.target.checked)}\n          />\n          <label htmlFor=\"dark-theme-check\" className={ style.switchLabel }> \n          </label>\n        </div>\n        <label>Use dark theme</label>\n      </div>\n\n      <div className={`input-group ${style.colorBy}`}>\n        <label htmlFor=\"colorBy\">Color by</label>\n        <div className={style.fieldSelect}>\n          <FieldSelect\n            name=\"colorBy\"\n            className={style.selector}\n            onChange={colorBy}\n            fields={fields}\n            values={values}\n            getFieldId={getFieldId}\n            value={controls.colorBy}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    controls: selectControls(state),\n    configuration: selectMergedConfiguration(state),\n    values: selectMergedValues(state)\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    showNodes: (shouldShowNodes) => dispatch(showNodes(shouldShowNodes)),\n    useDarkTheme: (darkTheme) => dispatch(useDarkTheme(darkTheme)),\n    colorBy: (field) => dispatch(colorBy(field))\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MiscControls);\n","import { is } from \"ramda\";\nimport { createAction } from \"redux-actions\";\nimport { ofType } from 'redux-observable';\nimport { of } from \"rxjs\";\nimport { mergeMap, map, tap, catchError } from 'rxjs/operators';\nimport { QueryParseError } from 'lunr';\n\nimport { setError } from \"domain/error\"\nimport { setSearchResults} from \"./index-dataset-epic\";\n\nconst searchDataset = createAction(\"SEARCH_DATASET\");\n\nconst searchDatasetEpic = (action$, store) => {\n  return action$.pipe(\n      ofType(searchDataset.toString())\n      ,mergeMap(({ payload }) => {\n        return of(payload).pipe(\n            tap(performSearch)\n            ,map((payload) =>\n              setSearchResults({\n                queryString: payload.queryString,\n                results: payload.results || []\n              })\n            )\n            ,catchError((error) => {\n              if (is(QueryParseError, error)) {\n                return of(setError(error));\n              } else {\n                /* istanbul ignore next */\n                throw error;\n              }\n            })\n          );\n      })\n    );\n};\n\nconst performSearch = (data) => {\n  data.results = [];\n  var toFind = data.queryString || '';\n  const indices = data.searchIndices;\n  var results = [];\n  if(indices && toFind){\n    for(var hash in indices){\n      const idx = indices[hash];\n      const idxResults = idx.search(toFind.toLowerCase());\n      const temp = new Set([...results, ...idxResults]);\n      results = [...temp];\n    }\n  }\n\n  Object.keys(data.datasets).forEach((key) => {\n    const ds = data.datasets[key].dataset;\n    ds.forEach((el) => { \n      el.CRVIZ._isSearchResult = false;\n    })\n    results.forEach((r) => {\n      const res = ds.find(i => i.CRVIZ[\"_SEARCH_KEY\"] === r.ref);\n      if(res){\n        res.CRVIZ._isSearchResult = true;\n        data.results.push(res);\n      }\n    });\n  });\n};\n\nexport default searchDatasetEpic;\n\nexport { searchDataset };\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSearch,  faTimesCircle} from \"@fortawesome/free-solid-svg-icons\";\n\nimport { selectDatasets, selectMergedConfiguration } from \"domain/dataset\";\n\nimport { getSearchIndices, getSearchResults } from \"epics/index-dataset-epic\";\nimport { searchDataset } from \"epics/search-dataset-epic\";\n\nimport style from \"./SearchControls.module.css\";\n\nconst defaultState = {\n  queryString: '',\n  searchIndices: [],\n  hasSearch: false\n}\n\nexport class Search extends React.Component {\n\n  state = defaultState\n\n  handleSearch(){\n    this.setState({\n      hasSearch: this.state.queryString !== ''\n    });\n    var data = {\n      datasets: this.props.datasets,\n      configuration: this.props.configuration,\n      searchIndices: this.props.searchIndices,\n      queryString: this.state.queryString,\n      results: this.props.results\n    }\n    \n    this.props.searchDataset(data);\n  }\n\n  clearSearch(){\n    this.setState(defaultState, function() {\n      this.handleSearch();\n    });\n  }\n\n  handleQueryStringChange = (e) =>{\n        this.setState({\n          queryString: e.target.value\n        });\n  }\n\n  handleKeyPress = (e) => {\n    if(e.key === 'Enter'){\n      this.handleSearch();\n    }\n  }\n\n  render() {\n    return (\n      <div className={style.searchContainer}>\n        <span className={ style.search }>\n          <input\n            type=\"search\"\n            id=\"search-string\"\n            placeholder=\"Search\"\n            value={this.state.queryString}\n            onChange={this.handleQueryStringChange}\n            onKeyPress={this.handleKeyPress}\n          />\n\n          <label htmlFor=\"search-string\" className=\"button circular\" onClick={() => this.handleSearch()} title=\"Search\">\n            <FontAwesomeIcon icon={faSearch} />\n          </label>\n        </span>\n        { this.state.hasSearch &&\n          <span>\n            <label id=\"search-results\"> {this.props.results.length} Results found </label>\n            <label htmlFor=\"search-results\" className=\"button circular\" onClick={() => this.clearSearch()}>\n              <FontAwesomeIcon icon={faTimesCircle} />\n              </label>\n          </span>\n        }\n      </div>\n    );\n  }\n}\n\nSearch.propTypes = {\n  datasets: PropTypes.object,\n  configuration: PropTypes.object,\n  searchIndex: PropTypes.object,\n  queryString: PropTypes.string,\n  results: PropTypes.array,\n  searchDataset: PropTypes.func.isRequired\n};\n\nconst mapStateToProps = (state, ownProps) => {\n  return {\n    datasets: selectDatasets(state),\n    configuration: selectMergedConfiguration(state),\n    searchIndices: getSearchIndices(state),\n    queryString: state.search.queryString,\n    results: getSearchResults(state)\n  };\n}\n\nconst mapDispatchToProps = {\n  searchDataset,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Search);\n","import {\n  add,\n  addIndex,\n  aperture,\n  concat,\n  forEach,\n  map,\n  last,\n  prop,\n  reject,\n  reverse,\n  splitEvery,\n  reduce\n} from \"ramda\";\n\nimport { packEnclose } from \"d3-hierarchy\";\n\n/**\n * Pack circles into rows and columns.\n */\nconst packGrid = (circles) => {\n  const rows = toRows(circles);\n  placeRows(rows);\n\n  // Recenter everything over the origin\n  var enclosingCircle = packEnclose(circles);\n  forEach((c) => {\n    c.x -= enclosingCircle.x;\n    c.y -= enclosingCircle.y\n  }, circles);\n};\n\nconst eachWithIndex = addIndex(forEach);\n\n/**\n * Assign x and y coordinates to rows of circles\n */\nconst placeRows = (rows) => {\n  rows = middleOut(map(middleOut, rows));\n\n  const maxRadii = map(maxRadius, rows);\n  const ys = coordinatesForRadii(maxRadii);\n  const xs = map(coordinatesForRadii, map(map(prop('r')), rows));\n\n  return eachWithIndex(\n    (row, i) =>\n      eachWithIndex((node, j) => {\n        node.x = xs[i][j];\n        node.y = ys[i];\n      }, row),\n    rows\n  );\n};\n\nconst maxRadius = (row) => {\n  return Math.max(...row.map((c) => c.r));\n};\n\n// Calculate the coordinates for the given list of radii\n// such that circles of these radii sit on the same line without colliding.\n// The circles are distributed evenly over the origin.\nconst coordinatesForRadii = (radii) => {\n  const diameters = map((r) => r * 2, radii)\n  const size = reduce(add, 0, diameters);\n\n  const first = 0 - size / 2 + radii[0]; // Calculate the first coordinate\n\n  return reduce((coords, [lastRadius, currentRadius]) => {\n    return [...coords, last(coords) + lastRadius + currentRadius];\n  }, [first], aperture(2, radii))\n};\n\n\nconst pickEven = (list) => addIndex(reject)((_, i) => i % 2 === 0, list);\nconst pickOdd = (list) => addIndex(reject)((_, i) => i % 2 !== 0, list);\n\n/**\n/ Re-order items from the middle out, alternating in direction.\n/\n/ Example:\n/ middleOut([1, 2, 3, 4, 5]) //=> [4, 2, 1, 3, 5]\n*/\nconst middleOut = (rows) => {\n  const above = pickEven(rows);\n  const below = pickOdd(rows);\n  return concat(reverse(above), below);\n};\n\nconst toRows = (circles) => {\n  return splitEvery(Math.ceil(Math.sqrt(circles.length)), circles);\n};\n\nexport default packGrid;\n","import { packEnclose } from \"d3-hierarchy\";\nimport packGrid from \"./pack-grid\";\n\n/**\n * An adaptation of the circle packing algorithm to reserve spacing at the\n * bottom of each non-leaf circle for labeling.\n */\nconst packWithLabel = () => {\n  let options = {\n    // Radius funcion\n    // See d3.pack.radius\n    radius: null,\n\n    // Layout size\n    // See d3.pack.size\n    size: [1, 1],\n\n    // Padding constant/function\n    // See d3.pack.padding\n    padding: () => 0,\n\n    // A number in [0, 1) that determine the portion of the circle that is\n    // reserved for label.\n    //\n    // To ensure label display are consistent between siblings, all siblings\n    // circles use the label size of the largest circle.\n    labelRatio: 0.25,\n\n    // But we ensure smaller circle doesn't look like Ben Solo with its high\n    // waisted pant.\n    maxLabelRatio: 0.40,\n\n    // The packing method for packing siblings node.\n    // By default use the packGrid method. Can be set to use D3's packSiblings\n    // method instead.\n    packSiblings: packGrid\n  };\n\n  /**\n   * @param root - A D3 hierarchy object\n   * @return A `pack` object similar to `d3.pack` but with additional options (see above)\n   */\n  const pack = (root) => {\n    root.x = options.size[0] / 2;\n    root.y = options.size[1] / 2;\n    const { radius, size, labelRatio, maxLabelRatio, packSiblings } = options;\n    const padding =\n      typeof options.padding === \"function\" ? options.padding : () => options.padding;\n\n    if (radius) {\n      root\n        .eachBefore(radiusLeaf(radius))\n        .eachAfter(packChildren(packSiblings, labelRatio, maxLabelRatio, padding, 0.5))\n        .eachBefore(translateChild(1));\n    } else {\n      // If radius is not specified, set each leaf node's radius based on its\n      // value, then resize the entire layout to fit options.size\n      root\n        .eachBefore(radiusLeaf((d) => Math.sqrt(d.value)))\n        .eachAfter(packChildren(packSiblings, labelRatio, maxLabelRatio, () => 0, 1))\n        .eachAfter(\n          packChildren(\n            packSiblings,\n            labelRatio,\n            maxLabelRatio,\n            padding,\n            root.r / Math.min(...size)\n          )\n        )\n        .eachBefore(translateChild(Math.min(...size) / (2 * root.r)));\n    }\n\n    return root;\n  };\n\n  /**\n   * Create an option method for each of the option above.\n   * Calling the method without arguments returns the current value.\n   * Calling the method with argument sets the option.\n   *\n   * Example:\n   * var pack = packWithLabel(root)\n   *              .radius(() => 20)\n   * pack.radius() //=> () => 20.\n   */\n  Object.keys(options).forEach((key) => {\n    pack[key] = (...values) => {\n\n      if (values.length === 0) {\n        return options[key];\n      }\n      options[key] = values[0];\n      return pack;\n    };\n  });\n\n  return pack;\n};\n\nconst radiusLeaf = (radius) => {\n  return (node) => {\n    if (!node.children) {\n      node.r = Math.max(radius(node), 0);\n    }\n  };\n};\n\nconst getLabelSize = (labelRatio) => (node) => {\n  return 2 * node.r * labelRatio / (1 - labelRatio);\n};\n\n/**\n * Pack children of a node, then set the node's radius to enclose all the children\n */\nconst packChildren = (packSiblings, labelRatio, maxLabelRatio, padding, k) => (node) => {\n  if (!node.children) {\n    return;\n  }\n\n  const children = node.children;\n\n  const nonleafChildren = children.filter((child) => child.height > 0);\n\n  // Calculate the label size of the largest non-leaf children\n  // and expand their radii accordingly to make space for label.\n  if (nonleafChildren.length > 0) {\n    const labelSize = Math.max(...nonleafChildren.map(getLabelSize(labelRatio)))\n\n    nonleafChildren.forEach((node) => {\n      node.labelSize = Math.min(labelSize, getLabelSize(maxLabelRatio)(node));\n      node.r += node.labelSize / 2;\n\n\n    });\n  }\n\n  const paddingSize = padding(node) * k || 0;\n\n  // Padding is implemented by adding it to the children's radii, pack,\n  // then returning the radii to their original value.\n  if (paddingSize) {\n    children.forEach((child) => (child.r += paddingSize));\n  }\n  packSiblings(children);\n  const enclosingRadius = packEnclose(children).r;\n\n  if (paddingSize) {\n    children.forEach((child) => (child.r -= paddingSize));\n  }\n\n  node.r = enclosingRadius + paddingSize;\n};\n\n// Set the the node's children's positions to be inside the node and above the\n// space reserved for labeling.\nconst translateChild = (k) => (node) => {\n  const parent = node.parent;\n  node.r *= k;\n\n  if (node.labelSize) {\n    node.labelSize *= k;\n    node.labelY = node.r - node.labelSize / 2;\n    node.labelWidth = 2 * Math.sqrt(node.r ** 2 - node.labelY ** 2);\n  }\n\n  if (parent) {\n    node.x = parent.x + k * node.x;\n    node.y = parent.y + k * node.y;\n    if (parent.labelSize) {\n      node.y -= parent.labelSize / 2;\n    }\n  }\n};\n\nexport default packWithLabel;","import { chain, head, tail, map, reduce, path, isNil } from \"ramda\";\nimport { nest } from \"d3-collection\";\nimport { hierarchy as d3Hierarchy } from \"d3-hierarchy\";\n\n/**\n * Convert an array of nodes into a D3 hierarchy\n *\n * @param [array] data - an array of data\n * @hierarchy [array] - an array of objects in the shape of\n * {\n *   displayName: string,\n *   path: array[string]\n * }\n */\n\nconst toHierarchy = (data, hierarchyConfig) => {\n  const nesting = nestHierarchy(hierarchyConfig).entries(data);\n  const result = entriesToHierarchy(\"root\", null, hierarchyConfig, nesting);\n  return d3Hierarchy(result);\n};\n\n/**\n * Create the D3 nest function that will nest data given the hierarchyConfig.\n */\nconst nestHierarchy = (hierarchyConfig) => {\n  return reduce(\n    (nest, field) => {\n      return nest.key((d) => path(field.path, d));\n    },\n    nest(),\n    hierarchyConfig\n  );\n};\n\nconst countSearchResults = (children) => {\n  if(isNil(children)){\n    return 0;\n  }\n\n  var result = 0;\n\n  for(var c in children){\n    if(!('CRVIZ' in children[c])){\n      children[c]['CRVIZ'] = {};\n    }\n    result += (children[c].CRVIZ._searchResultCount || 0) + (children[c].CRVIZ._isSearchResult || 0) +\n              (\n                !isNil(children[c].values)\n                  ? countSearchResults(children[c].values) : 0\n              );\n  }\n\n  return result;\n};\n\nconst countAdded = (children) => {\n  if(isNil(children)){\n    return 0;\n  }\n\n  var result = 0;\n\n  for(var c in children){\n    if(!('CRVIZ' in children[c])){\n      children[c]['CRVIZ'] = {};\n    }\n    result += (children[c].CRVIZ._addedCount || 0) + (children[c].CRVIZ._isAdded || 0) +\n              (\n                !isNil(children[c].values)\n                  ? countAdded(children[c].values) : 0\n              );\n  }\n\n  return result;\n};\n\nconst countChanged = (children) => {\n  if(isNil(children)){\n    return 0;\n  }\n\n  var result = 0;\n\n  for(var c in children){\n    if(!('CRVIZ' in children[c])){\n      children[c]['CRVIZ'] = {};\n    }\n    result += (children[c].CRVIZ._changedCount || 0) + (children[c].CRVIZ._isChanged || 0) +\n              (\n                !isNil(children[c].values)\n                  ? countChanged(children[c].values) : 0\n              );\n  }\n\n  return result;\n};\n\nconst countRemoved = (children) => {\n  if(isNil(children)){\n    return 0;\n  }\n\n  var result = 0;\n\n  for(var c in children){\n    if(!('CRVIZ' in children[c])){\n      children[c]['CRVIZ'] = {};\n    }\n    result += (children[c].CRVIZ._removedCount || 0) + (children[c].CRVIZ._isRemoved || 0) +\n              (\n                !isNil(children[c].values)\n                  ? countRemoved(children[c].values) : 0\n              );\n  }\n\n  return result;\n};\n\n\nconst childrenAreLeaves = (group) =>{\n  return group.reduce((prev, current) => {\n    const containsGroups = current.CRVIZ ?  current.CRVIZ._containsGroups : false;\n    return prev && !containsGroups && !current.values\n  }, true);\n}\n\n/**\n * Convert nest entries into the format accepted by d3.hierarchy\n */\nconst entriesToHierarchy = (fieldValue, field, hierarchyConfig, entries) => {\n  if (fieldValue === 'Unknown') {\n    const children = chain(getLeaves, entries)\n    return {\n      fieldValue,\n      field,\n      children: children,\n      CRVIZ:{ \n        _containsGroups: false,\n        _searchResultCount: countSearchResults(entries),\n        _addedCount: countAdded(entries),\n        _changedCount: countChanged(entries),\n        _removedCount: countRemoved(entries),\n      }\n    }\n  }\n\n  const children =  map((entry) => {\n    if (entry.values) {\n      return entriesToHierarchy(\n        entry.key,\n        head(hierarchyConfig),\n        tail(hierarchyConfig),\n        entry.values\n      );\n    } else {\n      return entry;\n    }\n  }, entries);\n  return {\n    fieldValue,\n    field,\n    children: children,\n    CRVIZ:{ \n      _containsGroups: !childrenAreLeaves(entries),\n      _searchResultCount: countSearchResults(entries),\n      _addedCount: countAdded(entries),\n      _changedCount: countChanged(entries),\n      _removedCount: countRemoved(entries),\n    }\n  };\n};\n\nconst getLeaves = (entry) => {\n  if (entry.values) {\n    return chain(getLeaves, entry.values)\n  } else {\n    return [entry]\n  }\n}\n\nexport default toHierarchy;\n","\n/**\n * Return a string that can be used to check if two data are the same.\n*/\nconst datumKey = (datum) => {\n  if (datum.depth === 0) {\n    return 'root';\n  } else if (datum.height > 0) {\n    return [\n      datumKey(datum.parent),\n      datum.data.field.path.join(\".\"),\n      datum.data.fieldValue\n    ].join(\".\");\n  } else {\n    return datum.data.uid;\n  }\n};\n\nexport default datumKey;\n","const className = (name) => `viz-${name}`;\n\nexport default className;","import { select } from \"d3\";\nimport { path } from \"d3-path\";\n\nimport datumKey from \"./datum-key\";\nimport className from \"./class-name\";\n\nconst appendCircles = ({ nodeRoot, labelRoot, packedData, showNodes, hasSearch, noteIdHovered,hasNoNotes, resetNodeStyles }) => {\n  const data = packedData.descendants();\n  const firstLeaf = packedData.leaves()[0];\n  const leafRadius = firstLeaf.r || 0;\n  const fontScale = ((2*leafRadius)/16) *100;\n\n  const nodes = nodeRoot\n    .selectAll(`g.${className(\"node\")}`)\n    .data(data, datumKey);\n\n  nodes.exit().remove();  \n\n  const nodesEnter = nodes.enter().append(\"g\").classed(className(\"node\"), true);\n  nodesEnter\n    .merge(nodes)\n    .attr('data-key', datumKey)\n    //.style(\"fill\", (d) => hasNotes(d,notes))\n    .classed(className(\"rootNode\"), (d) => d.depth === 0)\n    .classed(className(\"groupingNode\"), (d) => d.depth > 0 && d.height > 0)\n    .classed(className(\"containsSearchResult\"), (d) => hasSearch && d.data.CRVIZ._searchResultCount > 0 && d.depth > 0 && d.height > 0)\n    .classed(className(\"containsNoSearchResult\"), (d) => hasSearch && d.data.CRVIZ._searchResultCount === 0 && d.depth > 0 && d.height > 0)\n    .classed(className(\"searchResult\"), (d) => hasSearch && d.data.CRVIZ._isSearchResult && d.depth > 0 && d.height === 0)\n    .classed(className(\"isChanged\"), (d) => d.data.CRVIZ._isChanged && d.depth > 0 && d.height === 0)\n    .classed(className(\"isAdded\"), (d) => d.data.CRVIZ._isAdded && d.depth > 0 && d.height === 0)\n    .classed(className(\"isRemoved\"), (d) => d.data.CRVIZ._isRemoved && d.depth > 0 && d.height === 0)\n    .classed(className('isNotNoted'), (d) => has_NoNotes(d,noteIdHovered) && hasNoNotes)\n    .classed(className(\"searchExcluded\"), (d) => hasSearch && !d.data.CRVIZ._isSearchResult && d.depth > 0 && d.height === 0)\n    .classed(className(\"leafNode\"), (d) => d.height === 0)\n    .classed(className(\"ringMenuExcluded\"), (d, i, nodes) => {\n        const n = select(nodes[i]);\n        return n.classed(className(\"ringMenuExcluded\")) && !resetNodeStyles})\n    .attr(\"transform\", (d) => `translate(${[d.x, d.y].join(\",\")})`)\n    .attr(\"display\", (d) => !showNodes && d.height === 0 ? 'none' : null)\n    .order();\n\n  const circles = nodes.select(\"circle\").merge(nodesEnter.append(\"circle\"));\n\n  circles.attr(\"r\", (d) => d.r);\n\n  const newLabelGroups = nodesEnter.append(\"g\").classed(className('label-group'), true);\n  const newLabelShapes = newLabelGroups.append(\"path\");\n  const newLabels = newLabelGroups.append('text').classed(className('label'), true);\n\n  const labelShapes = nodes.select(`g.${className('label-group')}`).select('path');\n  labelShapes\n  .merge(newLabelShapes)\n    .filter((d) => d.labelSize)\n    .attr(\"class\", className(\"labelShape\"))\n    .attr(\"d\", getLabelShape);\n\n  const labels = nodes.select(`g.${className('label-group')}`).select('text');\n  const mergedLabels = labels\n  .merge(newLabels)\n    .filter((d) => d.labelSize)\n    .style('font-size', (d, i, nodes) => (3 * d.height * fontScale) + \"%\")\n    .attr('y', (d) => d.r - (d.labelSize/2))\n    .text((d) => d.data.fieldValue);\n\n  mergedLabels.each( (d, i, nodes) => {\n    scaleAndTrimToLabelWidth(nodes[i], d, 3 * d.height * fontScale);\n  })\n\n  const newGroupingNodes = nodesEnter.filter((d) => d.height === 1);\n  const newAggregations = newGroupingNodes\n    .append(\"g\")\n    .classed(className(\"aggregation\"), true)\n    .attr(\"display\", (d) => showNodes ? 'none' : null);\n  const newTotalContainer = newAggregations\n    .append('g')\n      .classed(className(\"total-container\"), true);\n\n  const newTotalText = newTotalContainer\n  .append(\"text\")\n    .classed(className(\"annotation-text\"), true)\n    .style('font-size', (d) => (3 * d.height * fontScale) +\"%\")\n    .attr('x', (d) => 0)\n    .attr('y', (d) => 0)\n    .text((d) => !isNaN(d.value) ? d.value : \"0\");\n\n  const aggregations = nodeRoot.selectAll(`g.${className(\"aggregation\")}`).data(data, datumKey);\n  aggregations\n  .merge(newAggregations)\n    .attr(\"display\", (d, i, nodes) => showNodes || d.data.CRVIZ._containsGroups ? 'none' : null);\n\n  aggregations\n  .select(`g.${className(\"total-container\")}`)\n  .select('text')\n  .merge(newTotalText)\n    .text((d) => !isNaN(d.value) ? d.value : \"0\");\n\n  return [\n    nodes.merge(nodesEnter),\n  ];\n};\n\n/**\n * Calculate the d attribute of a path element representing the shape of the\n * label area (the partial circles at the bottom of the grouping nodes)\n */\nconst getLabelShape = (d) => {\n  const top = d.r - d.labelSize;\n  const radius = d.r;\n\n  const startAngle = Math.PI / 2 + Math.acos(top / radius);\n  const endAngle = Math.PI / 2 - Math.acos(top / radius);\n\n  const shape = path();\n  shape.arc(0, 0, radius, startAngle, endAngle, true);\n  shape.closePath();\n\n  return shape.toString();\n}\n\nconst getLabelWidth = (datum) =>{\n  const top = datum.r - datum.labelSize;\n  const radius = datum.r;\n\n  const startAngle = Math.PI / 2 + Math.acos(top / radius);\n  const endAngle = Math.PI / 2 - Math.acos(top / radius);\n  const arcAngle = startAngle - endAngle;\n\n  //length of a chord across a circle with angle theta\n  //is calculated as:\n  // 2*radius * sin(theta/2)\n  return 2*radius*Math.sin(arcAngle/2);\n}\n\nconst scaleAndTrimToLabelWidth = (node, datum, initialFontScale) => {\n  const maxTextWidth = 0.80 * getLabelWidth(datum);\n  const maxTextHeight = 0.80 * datum.labelSize;\n  const minFontScale = 10;\n  const maxFontScale = 125;\n\n  let boxWidth = node.getBBox().width;\n  let boxHeight = node.getBBox().height;\n  let fontScale = 100;\n  let labelText = datum.data.fieldValue;\n\n  //scale to height\n   if ((boxHeight > maxTextHeight)){\n    const heightScale = 1-Math.abs((boxHeight - maxTextHeight)/boxHeight);\n    fontScale = Math.max(minFontScale, heightScale * initialFontScale);\n    select(node)\n      .style('font-size', (d, i, nodes) => fontScale + \"%\")\n      .text(labelText);\n  } else if(boxHeight < 0.75 * maxTextHeight){\n    const heightScale = 1 + Math.abs((boxHeight - maxTextHeight)/maxTextHeight);\n    fontScale = Math.min(maxFontScale, heightScale * initialFontScale);\n    select(node)\n      .style('font-size', (d, i, nodes) => fontScale + \"%\")\n      .text(labelText);\n  }\n \n  boxWidth = node.getBBox().width;\n  //trim to width\n  if(boxWidth > maxTextWidth)\n  {\n    const lengthToTrimTo = Math.trunc(0.75*labelText.length);\n    labelText = labelText.substr(0, lengthToTrimTo) + \"...\"\n    select(node)\n    .attr('textLength', maxTextWidth)\n    .attr('lengthAdjust', \"spacingAndGlyphs\")\n    .text(labelText);\n  }\n}\n\nconst has_NoNotes = (datum, noteIdHovered) =>{\n  const note_key = noteIdHovered;\n  //alert(`${note_key}`);\n  const datum_key = datum.data.CRVIZ._SEARCH_KEY;\n  if (datum.parent !== undefined) {\n    if(note_key === datum_key){\n      //if node has notes, don't make opaque\n      return false;\n    }\n    else {\n      //if node doesn't have notes, make opaque\n      return true;\n    }\n  }\n}\n\nexport default appendCircles;\n","import { zoom, zoomTransform } from \"d3-zoom\";\nimport { zoomIdentity } from \"d3-zoom\";\n\nconst setupZoom = ({\n  zoomRoot,\n  transformRoot,\n  nodes,\n  showNodes,\n  width,\n  height,\n  packedData\n}) => {\n\n  const state = {\n    zoomTo: null,\n    zoomToTransform: null,\n    // Find the current zoom transform if any\n    transform: zoomTransform(zoomRoot.node())\n  };\n\n  const zoomBehavior = zoom();\n\n  zoomBehavior.on(\"zoom\", (event, d) => {\n    state.transform = event.transform;\n    zoomToTransform(event.transform)\n  });\n\n  zoomRoot.call(zoomBehavior);\n\n  // Amount of space to leave around a node when zoomed into that node\n  // (as a fraction of the node diameter)\n  const viewPadding = 0.25;\n\n  const { r: rootR, x: rootX, y: rootY } = packedData;\n\n  const scaleExtent = [\n    Math.min(width, height) / (rootR * 2),\n    Math.min(width, height) / (packedData.leaves()[0].r * 2 * (1 + viewPadding))\n  ];\n\n  const translateExtent = [\n    [\n      rootX - width / 2 / scaleExtent[0] * 2,\n      rootY - height / 2 / scaleExtent[0] * 2\n    ],\n    [\n      rootX + width / 2 / scaleExtent[0] * 2,\n      rootY + height / 2 / scaleExtent[0] * 2\n    ]\n  ];\n\n  zoomBehavior.scaleExtent(scaleExtent).translateExtent(translateExtent);\n\n  // Assume everything is hidden by default.\n  //\n  // Note:\n  // This could have been done using inline style.\n  // The odd thing is, when using inline style, apparently each node's style is\n  // recalculated in every frame during zooming regardless of whether or not\n  // the inline style was changed.\n  //\n  // Using a class avoided this issue.\n  nodes.classed('viz-zoomMinutia', true);\n\n  function zoomToTransform(transform) {\n    transformRoot\n      .style(\"transform\", `translate(${ Math.floor(transform.x) }px, ${ Math.floor(transform.y) }px) scale(${ transform.k })`);\n\n    const bound = viewBound(width, height, transform);\n\n    const nodesInView = nodes.filter((d) => boundOverlap(bound, nodeBound(d)));\n\n    nodesInView\n      .call(hideSmall, transform)\n  };\n\n  function zoomTo(datum, animate = true) {\n    const size = datum.r * 2 * (1 + viewPadding);\n    const k = Math.min(width, height) / size;\n    const transform = zoomIdentity\n      .scale(k)\n      .translate(\n          - datum.x + width / 2 / k,\n          - datum.y + height / 2 / k,\n      );\n\n    zoomBehavior.transform(\n      !animate ? zoomRoot : zoomRoot.transition().duration(1000),\n      transform\n    );\n  }\n\n  if (state.transform) {\n    zoomToTransform(state.transform);\n  }\n\n  state.zoomTo = zoomTo;\n  state.zoomToTransform = zoomToTransform;\n\n  return state;\n};\n\nconst hideSmall = (nodes, transform) => {\n  const tooSmall = (d) => d.r * transform.k < 1;\n\n  nodes\n    .filter(\":not(.viz-zoomMinutia)\")\n    .filter((d) => tooSmall(d))\n    .classed(\"viz-zoomMinutia\", true);\n\n  nodes\n    .filter(\".viz-zoomMinutia\")\n    .filter((d) => !tooSmall(d))\n    .classed(\"viz-zoomMinutia\", false)\n};\n\n/**\n * The bound of the view given the original width, height, and transform\n */\nconst viewBound = (width, height, transform) => {\n  var size = Math.min(width, height);\n  var boundWidth = size * Math.max(width / height, 1);\n  var boundHeight = size * Math.max(height / width, 1);\n\n  var bound = [\n    -transform.x / transform.k,\n    -transform.y / transform.k,\n    (-transform.x + boundWidth) / transform.k,\n    (-transform.y + boundHeight) / transform.k\n  ];\n  return bound;\n};\n\nconst nodeBound = (datum) => [\n  datum.x - datum.r,\n  datum.y - datum.r,\n  datum.x + datum.r,\n  datum.y + datum.r\n];\n\nconst boundOverlap = (bound0, bound1) => {\n  return (\n    bound0[0] <= bound1[2] &&\n    bound0[2] >= bound1[0] &&\n    bound0[1] <= bound1[3] &&\n    bound0[3] >= bound1[1]\n  );\n};\n\nexport default setupZoom;\n","const setupTooltip = ({ nodeRoot, tooltip, fields }) => {\n  tooltip\n    .style(\"display\", \"block\")\n    .style(\"position\", \"absolute\")\n    .style(\"transform\", null)\n    .style(\"top\", \"0px\")\n    .style(\"left\", \"0px\");\n  // Measurements need to be taken before hiding the tooltip, otherwise they are\n  // not accurate.\n  tooltip.style(\"display\", \"none\")\n};\n\n\n\nexport default setupTooltip;\n","import { times, concat } from \"ramda\";\nimport { scaleLinear, scalePow } from 'd3-scale';\nimport { hcl } from \"d3-color\";\n\nconst colorScheme = [\n  \"#a6cee3\",\n  \"#3366cc\",\n  \"#b2df8a\",\n  \"#33a02c\",\n  \"#fb9a99\",\n  \"#996699\",\n  \"#fdbf6f\",\n  \"#ff7f00\",\n  \"#cc99ff\",\n  \"#6a3d9a\",\n  \"#ffff99\",\n  \"#b15928\",\n  \"#ffcc99\",\n  \"#333399\"\n];\n\nconst extendColorScheme = (colorScheme, count) => {\n  const extraLayers = Math.floor(count / colorScheme.length);\n\n  if (extraLayers === 0) {\n    return colorScheme;\n  }\n\n  const extraColors = times((i) => {\n    const currentLayer = (i + colorScheme.length) / colorScheme.length;\n\n    const previous = hcl(colorScheme[i % colorScheme.length])\n    const neighbor = hcl(colorScheme[(i + 1) % colorScheme.length])\n\n    const hScale = scaleLinear()\n      .domain([0, extraLayers])\n      .range([previous.h, neighbor.h]);\n\n    const cScale = scalePow()\n      .exponent(5)\n      .domain([0, extraLayers])\n      .range([previous.c, 100]);\n\n    const lScale = scalePow()\n      .exponent(2)\n      .domain([0, extraLayers])\n      .range([previous.l, previous.l / 2]);\n\n    const h = hScale(currentLayer)\n    const c = cScale(currentLayer);\n    const l = lScale(currentLayer);\n\n    const nextColor = hcl(h, c, l);\n    return nextColor.toString();\n  }, count - colorScheme.length);\n\n  return concat(colorScheme, extraColors)\n}\n\nexport { colorScheme, extendColorScheme };\n","import { selectAll, select, event as d3Event } from 'd3-selection';\n\nimport {\n  contains,\n  either,\n  equals,\n  fromPairs,\n  toPairs,\n  identity,\n  map,\n  path,\n  pipe,\n  sortBy,\n  uniq,\n  zip\n} from \"ramda\";\n\nimport className from \"./class-name\";\nimport { colorScheme, extendColorScheme } from './color-scheme';\n\nfunction setupLegend({ legend, data, hierarchyConfig, coloredField, legendConfig }) {\n  if (!coloredField) {\n    legend.style(\"display\", \"none\");\n\n    const state = { nodes: [], annotations: [] }\n\n    function update({ nodes, annotations }) {\n      state.nodes = nodes;\n      nodes.classed('viz-coloredNode', coloredField);\n      if (!coloredField) {\n        nodes.select('circle').attr('class', null);  \n        return;\n      }\n    }\n\n    return { update };\n  } else {\n    legend.style(\"display\", null);\n  }\n\n  const getValue = either(path(coloredField.path), path([\"fieldValue\"]));\n\n  // If coloring groupings, don't color devices with the same value\n  const isColoringGroup = contains(coloredField, hierarchyConfig);\n\n  const values = pipe(\n    map(getValue),\n    uniq,\n    sortBy(identity)\n  )(data);\n\n  const scheme = extendColorScheme(colorScheme, values.length);\n\n  const configs = scheme.map((color, index) => {\n    return {\n      color,\n      disabled: false,\n      className: `legend-color-${index}`\n    }\n  });\n\n  const coloring = zip(values, configs);\n  const colorMap = fromPairs(coloring);\n\n  createStylesheet(coloring);\n\n  const state = { nodes: [] }\n\n  function update({ nodes, annotations }) {\n    state.nodes = nodes;\n    //state.annotations = annotations;\n    nodes.classed('viz-coloredNode', coloredField);\n    if (!coloredField) {\n      nodes.select('circle').attr('class', null);   \n      return;\n    }\n\n    colorNodes({ nodes, colorMap, getValue, coloredField, isColoringGroup });\n    colorAnnotations({ annotations, colorMap, getValue, coloredField, isColoringGroup })\n    updateLegend({ legend, colorMap, toggleValue })\n  }\n\n  function toggleValue(value) {\n    colorMap[value].disabled = !colorMap[value].disabled;\n    update({ nodes: state.nodes });\n  }\n\n  return { update, colorMap };\n}\n\nconst updateLegend = ({ legend, colorMap, toggleValue }) => {\n  const items = legend\n    .selectAll(\"p.viz-legendItem\")\n    .data(toPairs(colorMap), ([value]) => value );\n\n  items.exit().remove();\n\n  const itemsEnter = items.enter().append(\"p\").classed(\"viz-legendItem\", true)\n  itemsEnter.append(\"span\").classed(\"viz-legendColor\", true);\n  itemsEnter.append(\"span\").classed(\"viz-legendLabel\", true);\n\n  items.merge(itemsEnter)\n    .classed(\"viz-legendDisabled\", (d) => d[1].disabled);\n\n  items.merge(itemsEnter)\n    .select(\".viz-legendColor\")\n    .style(\"background-color\", ([value, { color }]) => color);\n\n  items.merge(itemsEnter)\n    .select(\".viz-legendLabel\")\n    .attr('title', ([value]) => value)\n    .text(([value]) => value);\n\n  legend.on('click.toggle', () => {\n    const datum = select(d3Event.target).datum();\n    if (datum) {\n      toggleValue(datum[0]);\n    }\n  })\n}\n\n/**\n * Having inline style trigger an expensive \"recalculate style\" in every frame\n * during zooming (even if the style attribute is empty!).\n *\n * We work around this by creating a style element that contains a class for\n * each item in the legend and assign those classes to each circle.\n*/\nconst createStylesheet = (coloring) => {\n  const style = selectAll('style#coloring').data([coloring]);\n  const styleEnter = style.enter().append('style').attr('id', 'coloring');\n\n  const html = coloring.map(([ value, { color, className } ], index) => {\n    return `\n      .viz-node circle.${className} {\n        fill: ${color} !important\n      }\n    `\n  }).join(\"\\n\");\n\n  style.merge(styleEnter)\n    .html(html)\n}\n\nconst colorNodes = ({ nodes, colorMap, getValue, coloredField, isColoringGroup }) => {\n  nodes\n    .filter((d) => d.height === 0)\n    .select(\"circle\")\n    .attr('class', (d) => {\n      const { disabled, className } = colorMap[getValue(d.data)] || {};\n      return !isColoringGroup && !disabled && className ? className : null\n    });\n\n  nodes\n    .filter((d) => d.height > 0)\n    .classed(\"viz-coloredNode\", (d) => {\n      const { disabled } = colorMap[getValue(d.data)] || {};\n      return !disabled &&\n        equals(d.data.field, coloredField) \n    })\n    .select(\"circle\")\n    .attr('class', (d) => {\n      const { disabled, className } = colorMap[getValue(d.data)] || {};\n      return isColoringGroup\n        && equals(d.data.field, coloredField)\n        && !disabled\n        && className;\n    });\n}\n\nconst colorAnnotations = ({ annotations, colorMap, getValue, coloredField, isColoringGroup }) => {\n  if(annotations){\n    annotations\n      .select(`g.${className(\"total-container\")}`)\n      .attr('class', (d) => {\n        const { disabled, className } = colorMap[getValue(d.data)] || {};\n\n        return isColoringGroup\n          && equals(d.data.field, coloredField)\n          && !disabled\n          && className;\n      });\n  }\n  // nodes\n  //   .filter((d) => d.height > 0)\n  //   .classed(\"viz-coloredNode\", (d) => {\n  //     const { disabled } = colorMap[getValue(d.data)] || {};\n  //     return !disabled &&\n  //       equals(d.data.field, coloredField) \n  //   })\n  //   .select(\"circle\")\n  //   .attr('class', (d) => {\n  //     const { disabled, className } = colorMap[getValue(d.data)] || {};\n  //     return isColoringGroup\n  //       && equals(d.data.field, coloredField)\n  //       && !disabled\n  //       && className;\n  //   });\n}\n\nexport default setupLegend;\n","import { select, selectAll } from \"d3\";\n\nimport { memoizeWith } from \"ramda\";\n\nimport datumKey from \"./datum-key\";\nimport className from \"./class-name\";\n\nconst setupAnnotations = ({packedData, annotationRoot}) =>{\n  //sum up change counts because we only are interested in groups that have changes to display\n  const data = packedData.descendants().filter(d => d.depth > 0 && d.height > 0 \n    && d.data.CRVIZ && (d.data.CRVIZ[\"_addedCount\"] + d.data.CRVIZ[\"_changedCount\"] + d.data.CRVIZ[\"_removedCount\"]) > 0);\n\n  const firstLeaf = packedData.leaves()[0];\n  const leafRadius = firstLeaf.r || 0;\n  const fontScale = ((2*leafRadius)/16) *100;\n  \n  const annotations = annotationRoot\n    .selectAll(`g.${className(\"annotation\")}`)\n    .data(data, datumKey);\n\n  annotations.exit().remove();\n\n  const annotationsEnter = annotations.enter().append(\"g\")\n  .classed(className(\"annotation\"), true);\n\n  //const baseAngle(d) = -60 * (Math.PI/180);\n  \n  annotationsEnter\n    .merge(annotations)\n    .attr('data-key', datumKey)\n    .attr(\"transform\", (d) => `translate(${[d.x, d.y].join(\",\")})`)\n    .order();\n\n  //changed nodes indicator\n  const newChangeIconContainer = annotationsEnter\n    .append('g')\n      .classed(className(\"change-icon-container\"), true);\n  const newChangeIcon = newChangeIconContainer\n  .append('text')\n    .classed('svg-icon', true)\n    .classed('nag', true)\n\t .style('font-size', (d) => (4 * d.height * fontScale) + \"%\")\n    .text('\\uf06a');//font-awesome\n\n  annotations\n  .select(`g.${className(\"change-icon-container\")}`)\n  .select('text.svg-icon')\n  .merge(newChangeIcon)\n    .attr('x', (d) => (getEdgePositionX(d.r, baseAngle(d))))\n    .attr('y', (d) => (getEdgePositionY(d.r, baseAngle(d))))\n    .on(\"click\", (d) => {\n      //Brings up Ring-menu on click\n      const annotation = selectAll(`g.${className(\"annotation\")}[data-key=\"${datumKey(d)}\"]`);\n\n      annotation\n      .select(`g.${className(\"change-icon-container\")}`)\n        .classed(className(\"annotation-hidden\"), true);\n\n      annotation\n      .select(`g.${className(\"change-icon-container\")}`)\n      .select('text.nag')\n        .classed('nag', false);\n\n      annotation\n      .select(`g.${className(\"ring-menu\")}`)\n        .classed(className(\"annotation-hidden\"), false);\n\n    })\n\n\n  //ring menu\n  const newRingMenu = annotationsEnter\n    .append('g')\n      .classed(className(\"ring-menu\"), true)\n      .classed(className(\"annotation-hidden\"), true);\n\n  const newBgCircles = newRingMenu\n    .append('circle')\n      .classed(className('bg-circle'), true)\n      .attr('r', (d) =>  18*d.height*leafRadius)\n\n  annotations\n  .select(`g.${className(\"ring-menu\")}`)\n  .select('circle')\n  .merge(newBgCircles)\n    .attr('cx', (d) => (getEdgePositionX(d.r, baseAngle(d))))\n    .attr('cy', (d) => (getEdgePositionY(d.r, baseAngle(d))));\n\n  const newX = newRingMenu\n  .append('text')\n    .classed('svg-icon', true)\n    .style('font-size', (d) => 3 * d.height * fontScale + \"%\")\n    .text('\\uf00d');\n\n  annotations\n  .select(`g.${className(\"ring-menu\")}`)\n  .select('text.svg-icon')\n  .merge(newX)\n    .attr('x', (d) => getEdgePositionX(d.r, baseAngle(d)))\n    .attr('y', (d) => (getEdgePositionY(d.r, baseAngle(d))))\n    .on(\"click\", (d) => {\n      const annotation = selectAll(`g.${className(\"annotation\")}[data-key=\"${datumKey(d)}\"]`);\n\n      annotation\n      .select(`g.${className(\"change-icon-container\")}`)\n        .classed(className(\"annotation-hidden\"), false);\n\n      annotation\n      .select(`g.${className(\"ring-menu\")}`)\n        .classed(className(\"annotation-hidden\"), true);\n    });\n\n  //Icons inside ring menu  \n  //totals \n  const newTotalContainer = newRingMenu\n    .append('g')\n      .classed(className(\"total-container\"), true);\n  newTotalContainer\n    .append('g')\n      .classed(className(\"node\"), true)\n    .append('circle')\n      .attr('r', (d) => 2 * d.height * leafRadius)\n      .attr('cx', (d) => (getEdgePositionX(d.r, baseAngle(d))) - 0*d.height*leafRadius)\n      .attr('cy', (d) => (getEdgePositionY(d.r, baseAngle(d))) - 10*d.height*leafRadius);\n\n  annotations\n  .select(`g.${className(\"total-container\")}`)\n  .merge(newTotalContainer)\n  .on(\"click\", (d, i, nodes) => {\n      const dk = datumKey(d);\n      const glyph = select(nodes[i])\n        .select(`g.${className(\"node\")}`)\n      const showHide = glyph.classed(className(\"ringMenuExcluded\"));\n\n      const leaves = selectAll(`g.${className(\"node\")}`)\n        .filter((e) =>{\n          const ancestors = e.ancestors();\n          return ancestors.findIndex( a => datumKey(a) === dk) !== -1;\n        })\n        .filter((d, i, nodes) => {\n          const item = select(nodes[i])\n          return !item.classed(className(\"isAdded\")) \n            && !item.classed(className(\"isChanged\")) \n            && !item.classed(className(\"isRemoved\"))\n            && !item.classed(className(\"groupingNode\"));\n        });\n\n      if(!leaves.empty()){\n        glyph.classed(className(\"ringMenuExcluded\"), !showHide);\n        leaves.classed(className(\"ringMenuExcluded\"), !showHide);\n      }\n    }\n  )\n\n  const newTotalText = newTotalContainer\n  .append(\"text\")\n    .classed(className(\"annotation-text\"), true)\n    .style('font-size', (d) => (2 * d.height * fontScale) + \"%\")\n    .attr('x', (d) => (getEdgePositionX(d.r, baseAngle(d))) + 7*d.height*leafRadius)\n    .attr('y', (d) => (getEdgePositionY(d.r, baseAngle(d))) - 10*d.height*leafRadius);\n\n  annotations\n  .select(`g.${className(\"total-container\")}`)\n  .select('text')\n  .merge(newTotalText)\n    .text((d) => !isNaN(d.value) ? d.value : \"0\");\n\n  //added nodes\n  const newAddedContainer = newRingMenu\n    .append('g')\n      .classed(className(\"added-container\"), true);\n  newAddedContainer\n    .append('g')\n      .classed(className(\"isAdded-fixed\"), true)\n    .append('circle')\n      .attr('r', (d) => 2 * d.height * leafRadius)\n      .attr('cx', (d) => (getEdgePositionX(d.r, baseAngle(d))) - 13.5*d.height*leafRadius)\n      .attr('cy', (d) => (getEdgePositionY(d.r, baseAngle(d))));\n\n  annotations\n  .select(`g.${className(\"added-container\")}`)\n  .merge(newAddedContainer)\n  .on(\"click\", (d, i, nodes) => {\n      const dk = datumKey(d);\n      const glyph = select(nodes[i])\n        .select(`g.${className(\"isAdded-fixed\")}`)\n      const showHide = glyph.classed(className(\"ringMenuExcluded\"));\n\n      const childGlyphs = selectAll(`g.${className(\"isAdded-fixed\")}`)\n        .filter((e) =>{\n          if(e){\n            const ancestors = e.ancestors();\n            return ancestors.findIndex( a => datumKey(a) === dk) !== -1;\n          }\n          else \n            return false;\n        });\n\n      const added = selectAll(`g.${className(\"isAdded\")}`)\n        .filter((e) =>{\n          if(e){\n            const ancestors = e.ancestors();\n            return ancestors.findIndex( a => datumKey(a) === dk) !== -1;\n          }\n          else \n            return false;\n        });\n\n      if(!added.empty()){\n        glyph.classed(className(\"ringMenuExcluded\"), !showHide);\n        childGlyphs.classed(className(\"ringMenuExcluded\"), !showHide);\n        added.classed(className(\"ringMenuExcluded\"), !showHide);\n      }\n    }\n  )   \n\n  const newAddedText = newAddedContainer\n  .append(\"text\")\n    .classed(className(\"annotation-text\"), true)\n    .style('font-size', (d) => (2 * d.height * fontScale) + \"%\")\n    .attr('x', (d) => (getEdgePositionX(d.r, baseAngle(d))) - 7.5*d.height*leafRadius)\n    .attr('y', (d) => (getEdgePositionY(d.r, baseAngle(d))));\n\n  annotations\n  .select(`g.${className(\"added-container\")}`)\n  .select('text')\n  .merge(newAddedText)\n    .text((d) => !isNaN(d.data.CRVIZ[\"_addedCount\"]) ? d.data.CRVIZ[\"_addedCount\"] : \"0\");\n\n  //changed nodes\n  const newChangedContainer = newRingMenu\n    .append('g')\n      .classed(className(\"changed-container\"), true);\n  newChangedContainer\n    .append('g')\n      .classed(className(\"isChanged-fixed\"), true)\n    .append('circle')\n      .attr('r', (d) => 2 * d.height * leafRadius)\n      .attr('cx', (d) => (getEdgePositionX(d.r, baseAngle(d))) - 0 * d.height * leafRadius)\n      .attr('cy', (d) => (getEdgePositionY(d.r, baseAngle(d))) + 10 * d.height * leafRadius);\n\n  annotations\n  .select(`g.${className(\"changed-container\")}`)\n  .merge(newChangedContainer)\n  .on(\"click\", (d, i, nodes) => {\n      const dk = datumKey(d);\n      const glyph = select(nodes[i])\n        .select(`g.${className(\"isChanged-fixed\")}`)\n      const showHide = glyph.classed(className(\"ringMenuExcluded\"));\n\n      const childGlyphs = selectAll(`g.${className(\"isChanged-fixed\")}`)\n        .filter((e) =>{\n          if(e){\n            const ancestors = e.ancestors();\n            return ancestors.findIndex( a => datumKey(a) === dk) !== -1;\n          }\n          else \n            return false;\n        });\n\n      const changed = selectAll(`g.${className(\"isChanged\")}`)\n        .filter((e) =>{\n          if(e){\n            const ancestors = e.ancestors();\n            return ancestors.findIndex( a => datumKey(a) === dk) !== -1;\n          }\n          else \n            return false;\n        });\n\n      if(!changed.empty()){\n        glyph.classed(className(\"ringMenuExcluded\"), !showHide);\n        childGlyphs.classed(className(\"ringMenuExcluded\"), !showHide);\n        changed.classed(className(\"ringMenuExcluded\"), !showHide);\n      }\n    }\n  ) \n\n  const newChangedText = newChangedContainer\n  .append(\"text\")\n    .classed(className(\"annotation-text\"), true)\n    .style('font-size', (d) => (2 * d.height * fontScale) + \"%\")\n    .attr('x', (d) => (getEdgePositionX(d.r, baseAngle(d))) + 7 * d.height * leafRadius)\n    .attr('y', (d) => (getEdgePositionY(d.r, baseAngle(d))) + 10 * d.height * leafRadius);\n\n  annotations\n  .select(`g.${className(\"changed-container\")}`)\n  .select('text')\n  .merge(newChangedText)\n    .text((d) => !isNaN(d.data.CRVIZ[\"_changedCount\"]) ?  + d.data.CRVIZ[\"_changedCount\"] : \"0\");\n\n  //removed nodes\n  const newRemovedContainer = newRingMenu\n    .append('g')\n      .classed(className(\"removed-container\"), true);\n  newRemovedContainer\n    .append('g')\n      .classed(className(\"isRemoved-fixed\"), true)\n    .append('circle')\n      .attr('r', (d) => 2 * d.height * leafRadius)\n      .attr('cx', (d) => (getEdgePositionX(d.r, baseAngle(d))) + 7.5*d.height * leafRadius)\n      .attr('cy', (d) => (getEdgePositionY(d.r, baseAngle(d))));\n\n  annotations\n  .select(`g.${className(\"removed-container\")}`)\n  .merge(newRemovedContainer)\n  .on(\"click\", (d, i, nodes) => {\n      const dk = datumKey(d);\n      const glyph = select(nodes[i])\n        .select(`g.${className(\"isRemoved-fixed\")}`)\n      const showHide = glyph.classed(className(\"ringMenuExcluded\"));\n\n      const childGlyphs = selectAll(`g.${className(\"isRemoved-fixed\")}`)\n        .filter((e) =>{\n          if(e){\n            const ancestors = e.ancestors();\n            return ancestors.findIndex( a => datumKey(a) === dk) !== -1;\n          }\n          else \n            return false;\n        });\n\n      const removed = selectAll(`g.${className(\"isRemoved\")}`)\n        .filter((e) =>{\n          if(e){\n            const ancestors = e.ancestors();\n            return ancestors.findIndex( a => datumKey(a) === dk) !== -1;\n          }\n          else \n            return false;\n        });\n\n      if(!removed.empty()){\n        glyph.classed(className(\"ringMenuExcluded\"), !showHide);\n        childGlyphs.classed(className(\"ringMenuExcluded\"), !showHide);\n        removed.classed(className(\"ringMenuExcluded\"), !showHide);\n      }\n    }\n  )    \n\n  const newRemovedText = newRemovedContainer\n  .append(\"text\")\n    .classed(className(\"annotation-text\"), true)\n    .style('font-size', (d) => (2 * d.height * fontScale) + \"%\")\n    .attr('x', (d) => (getEdgePositionX(d.r, baseAngle(d))) + 14*d.height * leafRadius)\n    .attr('y', (d) => (getEdgePositionY(d.r, baseAngle(d))));\n\n  annotations\n  .select(`g.${className(\"removed-container\")}`)\n  .select('text')\n  .merge(newRemovedText)\n    .text((d) => !isNaN(d.data.CRVIZ[\"_removedCount\"]) ? d.data.CRVIZ[\"_removedCount\"] : \"0\");\n\n  return annotations.merge(annotationsEnter);\n}\n\n//memoize is being used here to cache function returns for a specific set of parameters. \n//i.e. we will evaluate once for a radius of 10 and angle of 60\n//afterwards we will use the cached value for those parameters. \nconst memoizeKey = (r, angle) => [r, angle].join(\" \");\n\nconst baseAngle = (d) => {\n    return Math.PI / 2 - Math.acos((d.r -d.labelSize) / d.r);\n}\n\nconst getEdgePositionX = memoizeWith(memoizeKey, (r, angle) => {\n  return r * Math.cos(angle);\n});\n\nconst getEdgePositionY = memoizeWith(memoizeKey, (r, angle) => {\n  return r * Math.sin(angle);\n});\n\nexport default setupAnnotations;","import { select, event as d3Event } from \"d3-selection\";\nimport { ResizeSensor } from \"css-element-queries\";\nimport debounce from \"lodash.debounce\";\n\nimport {\n  allPass,\n  eqProps,\n  eqBy,\n  find,\n  map,\n  reduce,\n  reduceWhile,\n  reduced,\n  reverse,\n  tail\n} from \"ramda\";\n\nimport packWithLabel from \"./d3-viz/pack-with-label\";\nimport toHierarchy from \"./d3-viz/to-hierarchy\";\nimport appendCircles from \"./d3-viz/append-circles\";\nimport setupZoom from \"./d3-viz/setup-zoom\";\nimport setupTooltip from \"./d3-viz/setup-tooltip\";\nimport setupLegend from \"./d3-viz/setup-legend\";\nimport setupAnnotations from \"./d3-viz/setup-annotations\";\nimport datumKey from \"./d3-viz/datum-key\";\n\nfunction d3Viz(rootNode) {\n  const root = select(rootNode);\n  // const width = rootNode.clientWidth;\n  // const height = rootNode.clientHeight;\n\n  /**\n   * Stationary div that receive mouse events for zooming.\n   */\n  const zoomRoot = root\n    .append(\"div\")\n    .attr(\"data-node\", \"zoomRoot\")\n    .style(\"position\", \"relative\")\n    .style(\"width\", \"100%\")\n    .style(\"height\", \"100%\");\n\n  root.style(\"position\", \"relative\");\n\n  /**\n   * The container that is scaled and transformed.\n   *\n   * Use a div with CSS 3D transform to get hardware acceleration.\n   * SVG transform are not hardware accelerated.\n   */\n  const transformRoot = zoomRoot\n    .append(\"div\")\n    .attr(\"data-node\", \"transformRoot\")\n    .style(\"position\", \"absolute\")\n    .style(\"top\", 0)\n    .style(\"left\", 0)\n    .style(\"width\", \"100%\")\n    .style(\"height\", \"100%\")\n    .style(\"transform-origin\", \"top left\");\n\n  /**\n   * Label are placed in a separate element so that they are not scaled\n   * together with the circles.\n   */\n  const labelRoot = zoomRoot\n    .append(\"svg\")\n    .style(\"position\", \"absolute\")\n    .style(\"pointer-events\", \"none\") // Let the underlying circles get mouse events.\n    .style(\"top\", 0)\n    .style(\"left\", 0)\n    .style(\"width\", \"100%\")\n    .style(\"height\", \"100%\");\n\n  const svg = transformRoot.append(\"svg\")\n                           .style(\"overflow\", \"visible\")\n                           .attr(\"class\", \"nodeRoot\")\n\n  const tooltip = root.append(\"div\").classed(\"viz-tooltip\", true);\n  const legend = root.append(\"div\").classed(\"viz-legend\", true);\n\n  const nodeRoot = svg.append(\"g\");\n\n  const annotationRoot = svg.append(\"g\").attr(\"class\", \"annotation-root\")\n\n\n  // State\n  let props = {\n    hierarchyConfig: null,\n    data: null,\n    fields: null,\n    width: rootNode.clientWidth,\n    height: rootNode.clientHeight,\n    showNodes: true,\n    coloredField: null,\n    queryString: ''\n  };\n\n  const state = {\n    packedData: null,\n    nodes: null,\n    annotations: null,\n    labels: null,\n    countLabels: null,\n    zoom: null,\n    selectedNode: null,\n    legend: null\n  };\n\n  new ResizeSensor(rootNode, debounce(() => update(props), 100));\n\n  function update(nextProps) {\n    nextProps = {\n      ...nextProps,\n      width: rootNode.clientWidth,\n      height: rootNode.clientHeight,\n      hasSearch: nextProps.hasSearch\n    };\n\n    const dataUpdated = !allEqProps(\n      [\"hierarchyConfig\", \"data\", \"fields\", \"queryString\"],\n      props,\n      nextProps\n    );\n\n    const sizeUpdated = !allEqProps([\"width\", \"height\"], props, nextProps);\n\n    const legendUpdated = !allEqProps([\"coloredField\", \"hierarchyConfig\", \"data\"], props, nextProps);\n\n    props = nextProps;\n\n    if (dataUpdated) {\n      repack(props, state);\n      resetAnnotations(props, state);\n    }\n\n    rerender(props, state);\n\n    if (legendUpdated) {\n      resetLegend(props, state);\n    } else {\n      state.legend && state.legend.update({ nodes: state.nodes })\n    }\n\n    if (sizeUpdated || dataUpdated) {\n      resetZoom(props, state);\n    }\n  }\n\n  const repack = (props, state) => {\n    const hierarchy = makeHierarchy(props.data, props.hierarchyConfig);\n\n    const pack = packWithLabel().size([props.width, props.height]);\n\n    // Pack once without padding to calculate the radius of the leaf node\n    // then repack with new padding, similar to how d3-pack\n    // works when the size is not given.\n    //\n    // This way spacing between leaf nodes is consistent between visualizations.\n    //\n    // Doesn't seem to have a noticable performance impact.\n    const packed = pack(hierarchy);\n    const padding = packed.leaves()[0].r;\n    pack.padding((d) => padding * d.height);\n\n    state.packedData = pack(hierarchy);\n  };\n\n  //const hasnonotes = true; //toggle for notes\n  //const hasnonotes = props.hoverStatus;\n\n  const rerender = (props, state) => {\n    const [nodes] = appendCircles({\n      nodeRoot: nodeRoot,\n      labelRoot: labelRoot,\n      packedData: state.packedData,\n      showNodes: props.showNodes,\n      hasSearch: props.queryString !== '',\n      noteIdHovered: props.noteIdHovered,\n      hasNoNotes: props.hoverStatus,\n      resetNodeStyles: props.resetNodeStyles,\n    });\n\n    setupTooltip({\n      tooltip: tooltip,\n      fields: props.fields,\n      nodeRoot: nodeRoot\n    });\n\n    state.nodes = nodes;\n  };\n\n  const resetLegend = (props, state) => {\n    state.legend = setupLegend({\n      legend: legend,\n      hierarchyConfig: props.hierarchyConfig,\n      data: props.data,\n      coloredField: props.coloredField\n    });\n\n    if(state.legend != null){\n      state.legend.update({ nodes: state.nodes, annotations: state.annotations })\n    }\n  };\n\n  const resetZoom = (props, state) => {\n    state.zoom = setupZoom({\n      zoomRoot: zoomRoot,\n      transformRoot: transformRoot,\n      nodes: state.nodes,\n      width: props.width,\n      height: props.height,\n      packedData: state.packedData\n    });\n\n    let animate = true;\n\n    if (state.selectedNode) {\n      const selected = findAncestor(state.selectedNode, state.packedData);\n      state.selectedNode = selected;\n      animate = false; // smarter animation??\n    } else {\n      state.selectedNode = state.packedData;\n    }\n\n    state.zoom.zoomTo(state.selectedNode, animate);\n\n    nodeRoot.on(\"click.select\", () => {\n      const datum = select(d3Event.target).datum();\n      if(datum.data !== undefined) {\n        //Used to send data back to parent component Visualizations.js\n        props.sendData(datum.data);\n      };\n      let zoomToNode = datum;\n      \n      if(datum.height === 0 && datum.parent){\n        zoomToNode = datum.parent;\n      }\n      state.selectedNode = datum;\n      state.zoom.zoomTo(zoomToNode);\n    });\n  };\n\n  const resetAnnotations = (props, state) =>{\n    state.annotations = setupAnnotations({\n      packedData: state.packedData,\n      annotationRoot: annotationRoot,\n    })\n  };\n\n  return {\n    update\n  };\n}\n\nconst allEqProps = (props, o1, o2) => allPass(map(eqProps, props))(o1, o2);\n\nconst makeHierarchy = (data, hierarchyConfig) => {\n  const hierarchy = toHierarchy(data, hierarchyConfig).count();\n\n  const byUnknown = (a, b) => {\n    if (a.data.fieldValue === \"Unknown\") {\n      return b.data.fieldValue === \"Unknown\" ? 0 : 1;\n    } else {\n      return b.data.fieldValue === \"Unknown\" ? -1 : 0;\n    }\n  };\n\n  const bySize = (a, b) => (b.value || 0) - (a.value || 0);\n  const byName = (a, b) =>\n    (a.data.fieldValue || \"\").localeCompare(b.data.fieldValue || \"\");\n\n  return hierarchy.sort(composeComparators([byUnknown, bySize, byName]));\n};\n\n/**\n * Combine a list of comparator function ( (a, b) => Boolean )\n * in order into a single comparator.\n */\nconst composeComparators = (comparators) => (a, b) =>\n  reduceWhile(\n    (result) => result === 0, // keep comparing while a === b\n    (_, comparator) => comparator(a, b),\n    0,\n    comparators\n  );\n\n/**\n * Find the lowest ancestors of a node (or it self) that exists in a tree.\n */\nconst findAncestor = (node, hierarchy) => {\n  const path = reverse(node.ancestors());\n  const findChild = (parent, child) => {\n    return find(eqBy(datumKey, child), parent.children || []);\n  };\n\n  const res = reduce(\n    (last, child) => findChild(last, child) || reduced(last),\n    hierarchy,\n    tail(path)\n  );\n  return res;\n};\n\nexport default d3Viz;\n","import React from \"react\";\nimport ReactDOM from 'react-dom';\n\nimport { select,mouse } from \"d3-selection\";\n\nimport { connect } from \"react-redux\";\n\nimport { selectDatasetIntersection, selectMergedConfiguration } from \"domain/dataset\";\nimport { getQueryString } from \"epics/index-dataset-epic\";\nimport { selectControls, getPosition, setPosition, setSelectedDatum} from \"domain/controls\";\nimport { getNotesIndexedByHash, getNotesHoverStatus, getNoteHoveredId } from 'domain/notes';\n\nimport d3Viz from './d3-viz';\nimport styles from './Visualization.module.css';\n\nvar position = [];\n\nclass Visualization extends React.PureComponent {\n  componentDidMount() {\n    const el = ReactDOM.findDOMNode(this);\n    this.viz = d3Viz(el);\n    this.updateFromProps();\n  }\n\n  onClick = () => {\n    const el = ReactDOM.findDOMNode(this);\n    select(el).on('click', function mouseMoveHandler() {\n      position = mouse(this)\n    })\n    this.props.setPosition(position);\n  }\n\n  getData = (data) => {\n    this.props.setSelectedDatum(data);\n  }\n\n  updateFromProps() {\n    this.viz.update({\n      hierarchyConfig: this.props.controls.hierarchyConfig,\n      fields: this.props.configuration.fields || [],\n      showNodes: this.props.controls.shouldShowNodes,\n      coloredField: this.props.controls.colorBy,\n      data: this.props.dataset || [],\n      queryString: this.props.queryString,\n      position: this.props.position,\n      sendData: this.getData,\n      noteIdHovered:this.props.noteIdHovered,\n      notes:this.props.notes,\n      hoverStatus: this.props.hoverStatus,\n      resetNodeStyles: this.props.resetNodeStyles,\n    });\n  }\n\n  componentDidUpdate() {\n    this.updateFromProps();\n  }\n\n  render() {\n    return <div onClick={this.onClick} className={ styles.viz }></div>;\n  }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  return {\n    dataset: selectDatasetIntersection(state, ownProps.startUid, ownProps.endUid),\n    configuration: selectMergedConfiguration(state),\n    controls: selectControls(state),\n    queryString: getQueryString(state),\n    position: getPosition(state),\n    noteIdHovered: getNoteHoveredId(state),\n    notes: getNotesIndexedByHash(state),\n    hoverStatus: getNotesHoverStatus(state)\n  };\n};\nconst mapDispatchToProps = (dispatch) => ({\n  setPosition: (position) => dispatch(setPosition(position)),\n  setSelectedDatum: (data) => dispatch(setSelectedDatum(data))\n})\n\nexport default connect(mapStateToProps,mapDispatchToProps)(Visualization);\n","import { createAction } from 'redux-actions';\nimport { ofType } from 'redux-observable';\nimport {  timer, of } from 'rxjs';\nimport { mergeMap, takeUntil, debounceTime } from 'rxjs/operators';\n\nimport { setIsFetching } from \"domain/dataset\";\nimport { fetchDataset } from './fetch-dataset-epic';\n\n// ACTIONS\nconst startRefresh = createAction('START_REFRESH_DATASET');\nconst stopRefresh = createAction('STOP_REFRESH_DATASET');\n\n// EPIC\nconst refreshDatasetEpic = (action$, store) => {\n  return action$.pipe(\n    ofType(startRefresh.toString())\n    ,debounceTime(500)\n    ,mergeMap((action) => {\n      const owner = action.payload.owner\n      const url = action.payload.url;\n      const header = action.payload.header;\n      const interval = action.payload.interval * 1000;\n      return timer(0, interval).pipe(\n          mergeMap(() => {\n            return of(\n              setIsFetching({'owner': owner, 'isFetching': true})\n              ,fetchDataset({'owner': owner, 'url': url, 'header':header})\n            )\n          })\n        ,takeUntil(action$.ofType(stopRefresh.toString()))\n        )\n    })  \n  );\n}\n\nexport default refreshDatasetEpic;\nexport { startRefresh, stopRefresh };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { isNil, find, propEq } from \"ramda\";\n\nfunction DatasetSelector({ className, selected, datasets, onChange }) {\n  return (\n    <div className={className}>\n      <label className=\"select\">\n      <select\n        onChange={(evt) => onChange(find(eqUrl(evt.target.value), datasets)) }\n        value={isNil(selected) ? \"\" : selected.url}\n      >\n        <option value=\"\">&mdash;None&mdash;</option>\n        {datasets.map((dataset) => {\n          return (\n            <option key={dataset.url} value={dataset.url}>\n              {dataset.name}\n            </option>\n          );\n        })}\n      </select>\n      </label>\n    </div>\n  );\n}\n\nconst eqUrl = propEq(\"url\");\n\nconst PropTypesDataset = PropTypes.shape({\n  name: PropTypes.string.isRequired,\n  url: PropTypes.string.isRequired\n});\n\nDatasetSelector.propTypes = {\n  className: PropTypes.string,\n  selected: PropTypesDataset,\n  datasets: PropTypes.arrayOf(PropTypesDataset).isRequired,\n  onChange: PropTypes.func.isRequired\n};\n\nexport default DatasetSelector;\n","import React from \"react\";\nimport PropTypes from 'prop-types';\n\nimport { isNil } from \"ramda\";\n\nimport { FontAwesomeIcon }from \"@fortawesome/react-fontawesome\";\nimport { faUpload } from \"@fortawesome/free-solid-svg-icons\";\n\nfunction DatasetUpload({ className, selected, onChange, ownerUuid }) {\n  const inputId = \"file-input-\" + ownerUuid;\n  return (\n    <span className={ className }>\n      <input\n        type=\"file\"\n        id={inputId}\n        value=''\n        style={{'display':'none'}}\n        onChange={(evt) => onChange(evt.target.files[0])}\n      />\n\n    <span>\n      { isNil(selected) ? \"No file selected\" : selected }\n    </span>\n\n      <label htmlFor={inputId} className=\"button circular\" title=\"Upload data from file\">\n        <FontAwesomeIcon icon={faUpload} />\n      </label>\n    </span>\n  );\n}\n\nDatasetUpload.propTypes = {\n  ownerUuid: PropTypes.string.isRequired,\n  className: PropTypes.string,\n  selected: PropTypes.string,\n  onChange: PropTypes.func.isRequired\n};\n\nexport default DatasetUpload;\n","import React from \"react\";\nimport PropTypes from 'prop-types';\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faDownload } from \"@fortawesome/free-solid-svg-icons\";\n\nfunction DatasetDownload({ className, selected, url, disabled }) {\n  return (\n    <span className={ className }>\n      <a className=\"button circular\" href={ url } download={ selected + \".json\" }\n        title=\"Download\" disabled={disabled} >\n        <FontAwesomeIcon icon={faDownload} />\n      </a>\n    </span>\n  );\n}\n\nDatasetDownload.propTypes = {\n  className: PropTypes.string,\n  selected: PropTypes.string,\n  url: PropTypes.string\n};\n\nexport default DatasetDownload;\n","import React from \"react\";\nimport PropTypes from 'prop-types';\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faRedoAlt } from \"@fortawesome/free-solid-svg-icons\";\n\nfunction DatasetRefresh({ className, onClick, disabled }) {\n  return (\n    <span className={ className }>\n      <div className=\"button circular\" disabled={disabled} title=\"Refresh\" onClick={() => onClick()}>\n        <FontAwesomeIcon icon={faRedoAlt} />\n      </div>\n    </span>\n  );\n}\n\nDatasetRefresh.propTypes = {\n  className: PropTypes.string,\n  onClick: PropTypes.func.isRequired\n};\n\nexport default DatasetRefresh;\n","import React from \"react\";\nimport PropTypes from 'prop-types';\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSyncAlt,faStopCircle } from \"@fortawesome/free-solid-svg-icons\";\n\nfunction DatasetTimedRefresh({ className, interval, timerIsRunning, disabled, onIntervalChange, onStartClick, onStopClick }) {\n  return (\n    <span className={ className }>\n      <input type='text' title=\"Refresh interval in seconds\" value={interval} onChange={(evt) => onIntervalChange(evt.target.value)}/>\n      {!timerIsRunning && \n\t      <div className=\"button circular\" disabled={disabled} title=\"Start Refresh Timer\" onClick={() => onStartClick()}>\n\t        <FontAwesomeIcon icon={faSyncAlt} />\n\t      </div>\n  \t  }\n  \t  {timerIsRunning && \n\t      <div className=\"button circular\" disabled={disabled} title=\"Stop Refresh Timer\" onClick={() => onStopClick()}>\n\t        <FontAwesomeIcon icon={faStopCircle} />\n\t      </div>\n  \t  }\n    </span>\n  );\n}\n\nDatasetTimedRefresh.propTypes = {\n  className: PropTypes.string,\n  interval: PropTypes.number,\n  timerIsRunning: PropTypes.bool,\n  onIntervalChange: PropTypes.func.isRequired,\n  onStartClick: PropTypes.func.isRequired,\n  onStopClick: PropTypes.func.isRequired\n};\n\nexport default DatasetTimedRefresh;\n","import clonedeep from \"lodash.clonedeep\";\n\nconst getDataToExport = (datasets, keyFields, ignoredFields, controls, notes) => {\n\tlet exportData = {};\n\n\tif(datasets)\n\t\texportData[\"datasets\"] = sanitizeForExport(datasets);\n\n\tif(keyFields)\n\t\texportData[\"keyFields\"] = keyFields;\n\n\tif(ignoredFields)\n\t\texportData[\"ignoredFields\"] = ignoredFields;\n\n\tif(controls)\n\t\texportData[\"controls\"] = controls;\n\t\n\tif(notes)\n\t\texportData[\"notes\"] = notes;\n\n\treturn exportData;\n}\n\nconst sanitizeForExport = (datasets) =>{\n\tlet result = clonedeep(datasets);\n\tObject.keys(result).forEach((key) => {\n\t\tresult[key].dataset.forEach((item) => {\n\t\t\tdelete item.CRVIZ;\n\t\t});\n\t});\n\treturn result;\n}\n\nexport default getDataToExport;\nexport { getDataToExport };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport { isNil } from \"ramda\";\nimport Modal from 'react-modal';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { \n  faCheck, faTimes, faCog, faMinusCircle \n} from \"@fortawesome/free-solid-svg-icons\";\n\nimport { fetchDataset, buildAuthHeader } from \"epics/fetch-dataset-epic\";\nimport { startRefresh, stopRefresh } from \"epics/refresh-dataset-epic\";\nimport { uploadDataset } from \"epics/upload-dataset-epic\";\nimport { removeSearchIndex } from \"epics/index-dataset-epic\";\nimport {\n  showNodes, setHierarchyConfig, colorBy, selectControls, setStartDataset,\n  setEndDataset, showBusy\n} from \"domain/controls\";\n\nimport { getAllNotes } from 'domain/notes';\n\nimport { setError } from \"domain/error\"\nimport { \n  setDataset, selectDataset, selectDatasets, removeDataset, \n  getIsFetching, setIsFetching, getLastUpdated, getKeyFields,\n  getIgnoredFields\n} from \"domain/dataset\";\n\nimport DatasetSelector from \"./DatasetSelector\";\nimport DatasetUpload from \"./DatasetUpload\";\nimport DatasetDownload from \"./DatasetDownload\";\nimport DatasetRefresh from \"./DatasetRefresh\";\nimport DatasetTimedRefresh from \"./DatasetTimedRefresh\";\nimport { getDataToExport } from \"./export\"\n\nimport style from \"./DatasetControls.module.css\";\n\nconst CUSTOM_DATASET = {\n  name: \"Custom URL\",\n  url: \"custom-url\"\n};\n\nconst UPLOAD_DATASET = {\n  name: \"Upload Dataset\",\n  url: \"upload-dataset\"\n};\n\nconst authTypes = [\n  {'name': '-None-', 'scheme':'None' },\n  {'name': 'Username\\\\Password', 'scheme':'Basic' },\n  {'name': 'Token', 'scheme':'Bearer' },\n];\n\nModal.setAppElement('#root');\n\nclass DatasetControls extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    const initialDS = props.initialDataSource;\n    const idsUrl = !!initialDS ? new URL(initialDS.url) : null;\n    const requiresAuth = !!idsUrl && idsUrl.protocol === \"https:\"\n    const authScheme = requiresAuth ? 'Basic' : '';\n\n    this.state = {\n      dataset: null,\n      selected: initialDS,\n      selectedFile: null,\n      showUrlEntry: requiresAuth,\n      showUpload: false,\n      url: idsUrl ? idsUrl.href : '',\n      authScheme:authScheme,\n      token: '',\n      username: '',\n      password: '',\n      refreshInterval: 0,\n      refreshTimerRunning: false\n    };\n\n    this.datasets = [...this.props.datasets, CUSTOM_DATASET, UPLOAD_DATASET]\n    if(initialDS){\n      this.datasets.push(initialDS)\n    }\n\n    if(initialDS && !requiresAuth){\n      this.fetchAndSetDataset(initialDS.url, initialDS, null, null, null);\n    }\n  }\n\n  resetDataset = () => {\n    this.props.setDataset({ dataset: [], owner: this.props.uuid, source: null, name:\"\", shortName:\"\",  configuration: {} });\n    this.setState({\n      selected: null,\n      selectedFile: null\n    });\n  }\n\n  fetchAndSetDataset = (url, dataset, username, password, token) => {\n    this.props.showBusy(true);\n    this.props.setIsFetching({owner: this.props.uuid, isFetching: true});\n    const authHeader = buildAuthHeader(username, password, token);\n    if (toURL(url)) {\n      this.props.fetchDataset({ \n        'owner': this.props.uuid,\n        'name':this.props.name,\n        'shortName': this.props.shortName,\n        'url': url,\n        'header': authHeader\n      });\n      // this.setState({\n      //   selected: dataset,\n      //   selectedFile: null,\n      // });\n    } else {\n      this.props.setError(new Error(\"Please enter a valid URL.\"));\n    }\n  }\n\n  onSelected = (dataset) => {\n    if (isNil(dataset)) {\n      return this.resetDataset();\n    }\n\n    this.props.removeDataset({owner: this.props.uuid});\n    this.props.removeSearchIndex({owner: this.props.uuid});\n    this.props.stopRefresh();\n\n    const showUrlEntry = dataset === CUSTOM_DATASET;\n    const showUpload = dataset === UPLOAD_DATASET;\n    this.setState({ \n      showUrlEntry: showUrlEntry,\n      showUpload: showUpload,\n      url: '',\n      authScheme:null,\n      token: '',\n      username: '',\n      password: '',\n      selected: dataset,\n      selectedFile: null,\n      refreshInterval: 0,\n      refreshTimerRunning: false,\n     });\n    if(!showUrlEntry && !showUpload)\n    {\n      const url = dataset.url;\n      this.fetchAndSetDataset(url, dataset, null, null, null);\n      this.setStartOrEnd(this.props.uuid);\n    }\n\n  }\n\n  onUpload = (file) => {\n    this.setState({\n      selectedFile: file,\n      refreshInterval: 0,\n      refreshTimerRunning: false,\n    });\n  }\n\n  onUrlChange = (evt) => {\n    this.setState({ url: evt.target.value });\n  }\n\n  onTokenChange = (evt) => {\n    this.setState({ token: evt.target.value });\n  }\n\n  onUsernameChange = (evt) => {\n    this.setState({ username: evt.target.value });\n  }\n\n  onPasswordChange = (evt) => {\n    this.setState({ password: evt.target.value });\n  }\n\n  onUrlOk = () => {\n    this.setState({ showUrlEntry: false });\n    const dataset = this.state.selected;\n    if(!isNil(this.state.url))\n    {\n      const url = this.state.url;\n      dataset.url = url;\n      this.fetchAndSetDataset(url, dataset, this.state.username, this.state.password, this.state.token);\n      this.setStartOrEnd(this.props.uuid);\n    }\n  }\n\n  onUrlCancel = () => {\n    this.setState({ \n      showUrlEntry: false,\n      url: '',\n      authScheme:'',\n      token: '',\n      username: '',\n      password: '',\n    });\n  }\n\n  onUploadOk = () =>{\n    if(this.state.selectedFile){\n      this.props.showBusy(true);\n      this.props.uploadDataset({ \n        'owner': this.props.uuid,\n        'name':this.props.name,\n        'shortName': this.props.shortName,\n        'file': this.state.selectedFile,\n        'includeData': true,\n        'includeControls': false,\n      });\n      this.props.stopRefresh();\n      this.setState({ \n        showUpload: false,\n      });\n\n      this.setStartOrEnd(this.props.uuid);\n    }\n  }\n\n  setStartOrEnd = (uuid) =>{\n    if(!this.props.controls.start){\n        this.props.setStartDataset(uuid);\n      }\n      else if(!this.props.controls.end){\n        this.props.setEndDataset(uuid);\n      }\n  }\n\n  onUploadCancel = () => {\n    this.setState({ \n      selectedFile: null,\n      showUpload: false,\n    });\n  }\n\n  getDownloadUrl = () => {\n    const datasets = this.props.fullDatasets;\n    const controls = this.props.controls;\n    const keyFields = this.props.keyFields;\n    const ignoredFields = this.props.ignoredFields;\n    const notes = this.props.notes;\n    const urlObject = window.URL || window.webkitURL || window;\n    const json = JSON.stringify(getDataToExport(datasets, keyFields, ignoredFields, controls, notes), null, 2);\n    const blob = new Blob([json], {'type': \"application/json\"});\n    const url = urlObject.createObjectURL(blob);;\n    return url;\n  }\n\n  onRefresh = () =>{\n    const url = this.state.selected.url;\n    const dataset = this.state.selected;\n    this.fetchAndSetDataset(url, dataset, this.state.username, this.state.password, this.state.token);\n  }\n\n  onTimedRefreshStart = () =>{\n    this.props.setIsFetching({'owner': this.props.uuid, 'isFetching': true});\n    this.setState({\n      'refreshTimerRunning': true\n    });\n    const authHeader = buildAuthHeader(this.state.username, this.state.password, this.state.token);\n    const url = this.state.selected.url;\n    const interval = this.state.refreshInterval;\n    this.props.startRefresh({'owner': this.props.uuid,'url': url, 'header': authHeader, 'interval': interval});\n  }\n\n  onTimedRefreshStop = () =>{\n    this.setState({\n      'refreshTimerRunning': false\n    });\n    this.props.stopRefresh();\n  }\n\n  removeDatasetEntry = () =>{\n    this.props.removeDatasetEntry(this.props.uuid);\n  }\n\n  onTimedRefreshIntervalChanged = (interval) =>{\n    const numInt = parseInt(interval, 10);\n    if(!isNaN(numInt)){\n      this.setState({\n        refreshInterval: numInt,\n      });\n    }\n    else if(!interval){\n      this.setState({\n        refreshInterval: null,\n      });\n    }\n  }\n\n  render() {\n    const canDownload = this.state.selected && !this.state.selectedFile;\n    const canRefresh = this.state.selected && !isNil(this.state.selected.url) && !this.state.selectedFile;\n    let url = null;\n    try{\n      url = new URL(this.props.source);\n    }\n    catch(err){\n      if(err instanceof TypeError){\n        url = null;\n      }\n      else {\n        throw err;\n      }\n    }\n    return (\n      <div className={style.dataControls}>\n        <div key={ this.props.uuid + \"_label\" } className={style.dataControlHeader}>\n          {this.props.name}\n          {this.props.removable && <FontAwesomeIcon icon={faMinusCircle} \n          onClick={ this.removeDatasetEntry } \n          />}\n        </div>\n        <div className={style.selectorContainer}>\n          <span className={style.label}>Dataset</span>\n          <DatasetSelector\n            className={style.selector}\n            selected={this.state.selected}\n            onChange={this.onSelected}\n            datasets={this.datasets}\n            source={this.props.source}\n          />\n        </div>\n          <div className={style.datasetSourceContainer}>\n            { this.props.source &&\n              <span>\n               Source:&nbsp; \n               { url && \n                <a href={url}>\n                  {this.props.source}\n                </a>\n               }\n               { !url &&\n                this.props.source\n               }\n              </span>\n            }\n          </div>\n          <div className={style.utilityContainer}>\n          { canDownload &&\n            <DatasetDownload\n              className={style.fileDownload}\n              selected={this.state.selected.name}\n              url={this.getDownloadUrl()}\n              disabled={this.props.isFetching}\n            />\n          }\n          { canRefresh &&\n            <div className={style.urlRefreshContainer}>\n              <DatasetRefresh\n                className={style.urlRefresh}\n                onClick={this.onRefresh}\n                disabled={this.props.isFetching}\n              />\n              <DatasetTimedRefresh\n                className={style.urlRefresh}\n                interval={this.state.refreshInterval}\n                timerIsRunning={this.state.refreshTimerRunning}\n                disabled={this.props.isFetching}\n                onIntervalChange={this.onTimedRefreshIntervalChanged}\n                onStartClick={this.onTimedRefreshStart}\n                onStopClick={this.onTimedRefreshStop}\n              />\n            </div>\n          }\n          </div>\n          <div className={style.urlRefreshTime}>\n            { canRefresh && this.props.isFetching &&\n              <span>\n                <FontAwesomeIcon className=\"fa-spin\" icon={faCog} /> Fetching Data...\n              </span>\n            }\n            { canRefresh && !this.props.isFetching &&\n              <span>\n                Last Updated: { this.props.lastUpdated ? (this.props.lastUpdated.toLocaleDateString() || \"\") + \" \" + (this.props.lastUpdated.toLocaleTimeString() || \"\") : \"Never\" }\n              </span>\n            }\n          </div>\n          <Modal isOpen={ this.state.showUrlEntry } onRequestClose={this.onUrlCancel} contentLabel=\"Enter a Url\">\n            <div className={ style.modal }>\n              <div className={ style.modalMain }>\n                <span>\n                  <label> URL </label>\n                  <input type=\"text\" value={this.state.url} onChange={ this.onUrlChange }/>\n                </span>\n                <span>\n                  <label> AuthType </label>\n                  <label className=\"select\">\n                    <select\n                      onChange={(evt) => this.setState({ authScheme: evt.target.value })}\n                      value={isNil(this.state.authScheme) ? '' : this.state.authScheme}\n                    >\n                      {authTypes.map((at) => {\n                        return (\n                          <option key={at.scheme} value={at.scheme}>\n                            {at.name}\n                          </option>\n                        );\n                      })}\n                    </select>\n                  </label>\n                </span>\n                { this.state.authScheme === 'Bearer' &&\n                  <span>\n                    <label> Token </label>\n                    <input type=\"text\" value={this.state.Token} onChange={ this.onTokenChange }/>\n                  </span> \n                }\n                { this.state.authScheme === 'Basic' &&\n                  <div>\n                    <span>\n                      <label> Username </label>\n                      <input type=\"text\" value={this.state.userName} onChange={ this.onUsernameChange }/>\n                    </span>\n                    <span>\n                      <label> Password </label>\n                      <input type=\"password\" value={this.state.password} onChange={ this.onPasswordChange }/>\n                    </span>\n                  </div>\n                }\n                <div>\n                  <span className={ style.centerSpan }>\n                    <div className=\"button circular\" title=\"Ok\" onClick={this.onUrlOk}>\n                        <FontAwesomeIcon icon={faCheck} />\n                    </div>\n                    <div className=\"button circular\" title=\"Cancel\" onClick={this.onUrlCancel}>\n                        <FontAwesomeIcon icon={faTimes} />\n                    </div>\n                  </span>\n                </div>\n              </div>\n            </div>\n          </Modal>\n          <Modal isOpen={ this.state.showUpload } onRequestClose={this.onUploadCancel} contentLabel=\"Upload a File\">\n            <div className={ style.modal }>\n              <div className={ style.modalMain }>\n                  <div className={style.uploadContainer}>\n                    <span className={style.label}>Upload</span>\n                    <DatasetUpload\n                      ownerUuid={this.props.uuid}\n                      className={style.fileUpload}\n                      selected={this.state.selectedFile ? this.state.selectedFile.name : null}\n                      onChange={this.onUpload}\n                    />\n                  </div>\n                  <span className={ style.centerSpan }>\n                    <div className=\"button circular\" title=\"Ok\" onClick={this.onUploadOk}>\n                        <FontAwesomeIcon icon={faCheck} />\n                    </div>\n                    <div className=\"button circular\" title=\"Cancel\" onClick={this.onUploadCancel}>\n                        <FontAwesomeIcon icon={faTimes} />\n                    </div>\n                  </span>\n              </div>\n            </div>\n          </Modal>\n      </div>\n    );\n  }\n}\n\nconst toURL = (url) => {\n  try {\n    return new URL(url)\n  } catch(error) {\n    if (error instanceof TypeError) {\n      return null;\n    } else {\n      throw error;\n    }\n  }\n}\n\nDatasetControls.defaultProps = {\n  uuid: uuidv4(),\n  datasets: [],\n  dataset: null,\n  hierarchyConfig: [],\n  configHasChanged: false,\n  isFetching: false,\n  lastUpdated: new Date(),\n  \n};\n\nDatasetControls.propTypes = {\n  uuid: PropTypes.string,\n  datasets: PropTypes.array,\n  dataset: PropTypes.array,\n  fetchDataset: PropTypes.func.isRequired,\n  uploadDataset: PropTypes.func.isRequired,\n  setDataset: PropTypes.func.isRequired,\n  setStartDataset: PropTypes.func.isRequired,\n  setEndDataset: PropTypes.func.isRequired,\n  removeDataset: PropTypes.func.isRequired,\n  removeSearchIndex: PropTypes.func.isRequired,\n  getIsFetching: PropTypes.func.isRequired,\n  setIsFetching: PropTypes.func.isRequired,\n  showNodes: PropTypes.func.isRequired,\n  setHierarchyConfig: PropTypes.func.isRequired, \n  colorBy: PropTypes.func.isRequired,\n  startRefresh: PropTypes.func.isRequired,\n  stopRefresh: PropTypes.func.isRequired,\n  removeDatasetEntry: PropTypes.func.isRequired,\n  isFetching: PropTypes.bool,\n  lastUpdated: PropTypes.instanceOf(Date),\n  setError: PropTypes.func.isRequired,\n  hierarchyConfig: PropTypes.array,\n  configHasChanged: PropTypes.bool,\n  fullDatasets: PropTypes.object,\n  controls: PropTypes.object,\n  keyFields: PropTypes.array,\n  ignoredFields: PropTypes.array,\n  showBusy: PropTypes.func.isRequired,\n};\n\nconst mapStateToProps = (state, ownProps) => {\n  const owner = ownProps.uuid;\n  const fullDatasets = selectDatasets(state)\n  return {\n    dataset: (owner in fullDatasets) ? fullDatasets[owner].dataset : [],\n    source: (owner in fullDatasets) ? fullDatasets[owner].source : null,\n    isFetching: getIsFetching(state, owner),\n    lastUpdated: getLastUpdated(state, owner),\n    fullDatasets: fullDatasets,\n    controls: selectControls(state),\n    keyFields: getKeyFields(state),\n    ignoredFields: getIgnoredFields(state),\n    notes: getAllNotes(state)\n  };\n}\n\nconst mapDispatchToProps = {\n  fetchDataset,\n  uploadDataset,\n  setDataset,\n  setStartDataset,\n  setEndDataset,\n  selectDataset,\n  removeDataset,\n  removeSearchIndex,\n  getIsFetching,\n  setIsFetching,\n  showNodes,\n  setHierarchyConfig, \n  colorBy,\n  startRefresh,\n  stopRefresh,\n  setError,\n  showBusy\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DatasetControls);\n","// @flow weak\n\nimport React, { Fragment } from \"react\";\nimport PropTypes from \"prop-types\";\n\n// *******************************************************\n// RAIL\n// *******************************************************\nconst railOuterStyle = {\n  position: \"absolute\",\n  width: \"100%\",\n  height: 42,\n  transform: \"translate(0%, -50%)\",\n  borderRadius: 7,\n  cursor: \"pointer\"\n  // border: '1px solid white',\n};\n\nconst railInnerStyle = {\n  position: \"absolute\",\n  width: \"100%\",\n  height: 14,\n  transform: \"translate(0%, -50%)\",\n  borderRadius: 7,\n  pointerEvents: \"none\",\n  backgroundColor: \"rgb(155,155,155)\"\n};\n\nexport function SliderRail({ getRailProps }) {\n  return (\n    <Fragment>\n      <div style={railOuterStyle} {...getRailProps()} />\n      <div style={railInnerStyle} />\n    </Fragment>\n  );\n}\n\nSliderRail.propTypes = {\n  getRailProps: PropTypes.func.isRequired\n};\n\n// *******************************************************\n// HANDLE COMPONENT\n// *******************************************************\nexport function Handle({\n  domain: [min, max],\n  handle: { id, value, percent },\n  disabled,\n  getHandleProps\n}) {\n  return (\n    <Fragment>\n      <div\n        style={{\n          left: `${percent}%`,\n          position: \"absolute\",\n          transform: \"translate(-50%, -50%)\",\n          WebkitTapHighlightColor: \"rgba(0,0,0,0)\",\n          zIndex: 5,\n          width: 28,\n          height: 42,\n          cursor: \"pointer\",\n          // border: '1px solid white',\n          backgroundColor: \"none\"\n        }}\n        {...getHandleProps(id)}\n      />\n      <div\n        role=\"slider\"\n        aria-valuemin={min}\n        aria-valuemax={max}\n        aria-valuenow={value}\n        style={{\n          left: `${percent}%`,\n          position: \"absolute\",\n          transform: \"translate(-50%, -50%)\",\n          zIndex: 2,\n          width: 24,\n          height: 24,\n          borderRadius: \"50%\",\n          boxShadow: \"1px 1px 1px 1px rgba(0, 0, 0, 0.3)\",\n          backgroundColor: disabled ? \"#666\" : \"#0277BD\"\n        }}\n      />\n    </Fragment>\n  );\n}\n\nHandle.propTypes = {\n  domain: PropTypes.array.isRequired,\n  handle: PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    value: PropTypes.number.isRequired,\n    percent: PropTypes.number.isRequired\n  }).isRequired,\n  getHandleProps: PropTypes.func.isRequired,\n  disabled: PropTypes.bool\n};\n\nHandle.defaultProps = {\n  disabled: false\n};\n\n// *******************************************************\n// KEYBOARD HANDLE COMPONENT\n// Uses a button to allow keyboard events\n// *******************************************************\nexport function KeyboardHandle({\n  domain: [min, max],\n  handle: { id, value, percent },\n  disabled,\n  getHandleProps\n}) {\n  return (\n    <button\n      role=\"slider\"\n      aria-valuemin={min}\n      aria-valuemax={max}\n      aria-valuenow={value}\n      style={{\n        left: `${percent}%`,\n        position: \"absolute\",\n        transform: \"translate(-50%, -50%)\",\n        zIndex: 2,\n        width: 24,\n        height: 24,\n        borderRadius: \"50%\",\n        boxShadow: \"1px 1px 1px 1px rgba(0, 0, 0, 0.3)\",\n        backgroundColor: disabled ? \"#666\" : \"#0277BD\"\n      }}\n      {...getHandleProps(id)}\n    />\n  );\n}\n\nKeyboardHandle.propTypes = {\n  domain: PropTypes.array.isRequired,\n  handle: PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    value: PropTypes.number.isRequired,\n    percent: PropTypes.number.isRequired\n  }).isRequired,\n  getHandleProps: PropTypes.func.isRequired,\n  disabled: PropTypes.bool\n};\n\nKeyboardHandle.defaultProps = {\n  disabled: false\n};\n\n// *******************************************************\n// TRACK COMPONENT\n// *******************************************************\nexport function Track({ source, target, getTrackProps, disabled }) {\n  return (\n    <div\n      style={{\n        position: \"absolute\",\n        transform: \"translate(0%, -50%)\",\n        height: 14,\n        zIndex: 1,\n        backgroundColor: disabled ? \"#999\" : \"#014065\",\n        borderRadius: 7,\n        cursor: \"pointer\",\n        left: `${source.percent}%`,\n        width: `${target.percent - source.percent}%`\n      }}\n      {...getTrackProps()}\n    />\n  );\n}\n\nTrack.propTypes = {\n  source: PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    value: PropTypes.number.isRequired,\n    percent: PropTypes.number.isRequired\n  }).isRequired,\n  target: PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    value: PropTypes.number.isRequired,\n    percent: PropTypes.number.isRequired\n  }).isRequired,\n  getTrackProps: PropTypes.func.isRequired,\n  disabled: PropTypes.bool\n};\n\nTrack.defaultProps = {\n  disabled: false\n};\n\n// *******************************************************\n// TICK COMPONENT\n// *******************************************************\nexport function Tick({ tick, count, format }) {\n  return (\n    <div>\n      <div\n        style={{\n          position: \"absolute\",\n          marginTop: 14,\n          width: 1,\n          height: 5,\n          backgroundColor: \"rgb(200,200,200)\",\n          left: `${tick.percent}%`\n        }}\n      />\n      <div\n        style={{\n          position: \"absolute\",\n          marginTop: 22,\n          fontSize: 10,\n          textAlign: \"center\",\n          marginLeft: `${-(100 / count) / 2}%`,\n          width: `${100 / count}%`,\n          left: `${tick.percent}%`\n        }}\n      >\n        {format(tick.value)}\n      </div>\n    </div>\n  );\n}\n\nTick.propTypes = {\n  tick: PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    value: PropTypes.number.isRequired,\n    percent: PropTypes.number.isRequired\n  }).isRequired,\n  count: PropTypes.number.isRequired,\n  format: PropTypes.func.isRequired\n};\n\nTick.defaultProps = {\n  format: d => d\n};\n","import React from 'react';\n//import PropTypes from 'prop-types';\n\nimport { connect } from 'react-redux';\n\nimport { Slider, Rail, Handles, Tracks, Ticks } from \"react-compound-slider\";\n\nimport { SliderRail, Handle, Track, Tick } from \"features/slider-utils/slider-components\"; \n\nclass DatasetSlider extends React.Component {\n    state = {\n      start: null,\n      end: null,\n      labelMode: \"long\",   // mid, long\n    }\n    \n    onDragEnter = (e) => {\n      e.preventDefault();\n    }\n\n    onDragOver = (e) => {\n      e.preventDefault();\n    }\n    \n    onDragStart = (e) => {\n      const slider  = e.target.dataset.slider;\n      e.dataTransfer.setData(\"text/plain\", slider);\n    }\n    \n    onDrop = (e) => {\n      e.preventDefault();\n      const source = e.dataTransfer.getData(\"text/plain\");\n      const slot = Number(e.target.dataset.slot);\n      const points = this.props.points;\n      if(isNaN(slot)) return;\n\n      if (source === \"min\") {\n        this.props.setStartUuid(points[slot]);\n      } else if (source === \"max\") {\n        this.props.setEndUuid(points[slot]);     }\n    }\n\n    onSlotClick = (e) => {\n      const slot = Number(e.target.dataset.slot);\n\n      if (isNaN(slot)) return;\n      \n      const points = this.props.points;\n      if(points.indexOf(this.props.startUuid) === -1){\n        this.props.setStartUuid(points[slot]);\n      }\n      else if (points.indexOf(this.props.endUuid) === -1){\n        this.props.setEndUuid(points[slot]);\n      }\n    }\n\n    onHandleClick = (e) => {\n    }\n\n    onUpdate = (e) =>{\n\n    }\n\n    onChange = (e) =>{\n      const start = e.length > 1 ? this.props.points[e[0]] : null;\n      const end = e.length > 1 ? this.props.points[e[1]] : this.props.points[e[0]];\n      \n      if(start){\n        this.props.setStartUuid(start.owner);\n      }\n      if(end){\n        this.props.setEndUuid(end.owner);\n      }\n    }\n    \n    formatTicks = (t) => {\n      if(this.props.points && this.props.points[t]){\n        return this.props.points[t].shortName;\n      }\n      else {\n        return \"\";\n      }\n    };\n   \n    render() {\n      const points = this.props.points;\n      const startUuid = this.props.startUuid;\n      const endUuid = this.props.endUuid;\n\n      const sliderStyle = {\n        position: \"relative\",\n        width: \"100%\"\n      };\n\n      const domain = [0, Math.max(points.length -1, 0.1) ];\n      \n      const startIdx = points.findIndex( p => p.owner === startUuid);\n      const endIdx = points.findIndex( p => p.owner === endUuid);\n      const defaultValues = [startIdx, endIdx];\n\n      // if(startIdx >= 0){\n      //   defaultValues.push(startIdx);\n      // }\n      // if(endIdx >= 0 && endIdx > startIdx){\n      //   defaultValues.push(endIdx);\n      // }\n     \n      return (\n       <div style={{ margin: \"10%\", height: 60 }}>\n        <Slider\n          mode={1}\n          step={1}\n          domain={domain}\n          rootStyle={sliderStyle}\n          onUpdate={this.onUpdate}\n          onChange={this.onChange}\n          values={defaultValues}\n        >\n          <Rail>\n            {({ getRailProps }) => <SliderRail getRailProps={getRailProps} />}\n          </Rail>\n          <Handles>\n            {({ handles, getHandleProps }) => (\n              <div className=\"slider-handles\">\n                {handles.map(handle => (\n                  <Handle\n                    key={handle.id}\n                    handle={handle}\n                    domain={domain}\n                    getHandleProps={getHandleProps}\n                  />\n                ))}\n              </div>\n            )}\n          </Handles>\n          <Tracks left={false} right={false}>\n            {({ tracks, getTrackProps }) => (\n              <div className=\"slider-tracks\">\n                {tracks.map(({ id, source, target }) => (\n                  <Track\n                    key={id}\n                    source={source}\n                    target={target}\n                    getTrackProps={getTrackProps}\n                  />\n                ))}\n              </div>\n            )}\n          </Tracks>\n          <Ticks count={points.length}>\n            {({ ticks }) => (\n              <div className=\"slider-ticks\">\n                {ticks.map(tick => (\n                  <Tick key={tick.id} tick={tick} count={ticks.length} format={this.formatTicks} />\n                ))}\n              </div>\n            )}\n          </Ticks>\n        </Slider>\n      </div>\n      );\n    }\n}      \n\n\n\n// const mapStateToProps = (state, ownProps) => {\n\n// }\n\n// const mapDispatchToProps = {\n /*<div>\n          <div>\n            <div className={style.sliderContainer}>\n             \n             <div className={style.sliderScale}>\n                 {scale}\n              </div>\n        \n              <div className={style.slider}>\n                  {slider}\n              </div>\n             \n              <div className={style.sliderSelectedScale}>\n                  {currentScale}\n              </div>\n             \n            </div>\n          </div>\n        </div>*/\n// };\n\nexport default connect(null, null)(DatasetSlider);","import React from \"react\";\nimport { path } from \"ramda\";\n\n//Styling\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faTrashAlt, faSave, faAngleDoubleDown, faAngleDoubleUp, faAngleDoubleRight, faAngleDoubleLeft} from '@fortawesome/free-solid-svg-icons';\nimport appStyle from '../../App.module.css';\nimport tooltipStyle from './Tooltip.module.css';\n\n///Redux\nimport { connect } from \"react-redux\";\nimport { selectMergedConfiguration } from \"domain/dataset\";\nimport { getPosition, getSelectedDatum } from 'domain/controls';\nimport { addNote, removeNote, getNotesIndexedByHash } from 'domain/notes';\n\nclass TooltipControls extends React.Component {\n  constructor(props){\n    super(props)\n    this.state = this.initialState;\n    this.state = {\n      ...this,\n      show:true\n    }\n  }\n\n  get initialState(){\n    return {\n      label:\"Labels\",\n      height:\"200px\",\n      width:\"300px\",\n      position: [200,200],\n      currentLabel:\"\",\n      showNote: false,\n      showDetails: true,\n      note: {\n        id:'',\n        note:{\n          title: '',\n          labels: [],\n          content:\"\"\n        }\n      }\n    };\n  }\n\n  handleShowHide = () => {\n    this.setState({\n      show: !this.state.show\n    });\n  }\n\n  resetBuilder() {\n    this.setState(this.initialState);\n  }\n\n  handleChangeTitle = (event) => {\n    var note = {...this.state.note}\n    note.note.title = event.target.value\n    this.setState({note});\n  }\n\n  handleChangeContent = (event) => {\n    var note = {...this.state.note}\n    note.note.content = event.target.value\n    this.setState({note});\n  }\n\n  handleLabels = (event) => {\n    this.setState({currentLabel: event.target.value});\n  }\n\n  toggleShowNote = () =>{\n    this.setState({\n      showNote: !this.state.showNote,\n    });\n  }\n\n  toggleShowDetails = () =>{\n    this.setState({\n      showDetails: !this.state.showDetails,\n    });\n  }\n  \n  saveNote = async () => {\n    try {\n      var note = {...this.state.note}\n      note.id = await this.props.data.CRVIZ._SEARCH_KEY\n      await this.setState({note});\n\n      await this.props.addNote(this.state.note);\n      //this.resetBuilder()\n    } catch(error){\n      alert('No search key')\n    }\n  }\n\n  removeNote = async () => {\n    try {\n      var note = {...this.state.note};\n      note.id = await this.props.data.CRVIZ._SEARCH_KEY;\n      this.props.removeNote(this.state.note);\n      this.resetBuilder();\n    } catch(error){\n      alert('No note on search key')\n    }\n  }\n\n  keyPressed = (event) => {\n    if (event.key === \"Enter\") {\n      var note = {...this.state.note}\n      note.note.labels.push(this.state.currentLabel)\n      this.setState({note})\n      this.setState({currentLabel:\"\"})\n    }\n  }\n\n  componentDidUpdate = (prevProps) => {\n    if (prevProps.data !== this.props.data) {\n      var note = {...this.state.note}\n      note.id = this.props.data.CRVIZ._SEARCH_KEY\n      if (note.id in this.props.notes){          \n        this.setState({\n          note: this.props.notes[note.id]\n        }); \n      }\n      else{\n        this.resetBuilder()\n      }\n    } \n  }\n  \n  render() {\n\n    const showNote = this.state.showNote;\n    const showDetails = this.state.showDetails;\n\n    return (\n      <>\n      {this.props.data &&\n        <div className={ this.state.show ? tooltipStyle.show : tooltipStyle.hide }>\n          <div>\n            {!this.state.show && <p className={tooltipStyle.hidden}><FontAwesomeIcon onClick={this.handleShowHide} icon={faAngleDoubleLeft} /> </p>}{this.state.show && <p className={tooltipStyle.shown}><FontAwesomeIcon onClick={this.handleShowHide} icon={faAngleDoubleRight} /></p>}\n          </div>\n          {!this.props.data.fieldValue  &&\n            <p className={appStyle.accordionHeader} onClick={this.toggleShowDetails}>\n              Details {!showDetails && <FontAwesomeIcon icon={faAngleDoubleDown} />}{showDetails && <FontAwesomeIcon icon={faAngleDoubleUp} />}\n            </p>\n          }\n          {showDetails && this.props.data && !this.props.data.fieldValue  &&\n              <div className={ tooltipStyle.detailPanel }>\n                {this.props.fields.map((field)=>{\n                  return(\n                    <p className={ tooltipStyle.detailText }><b>{field.displayName}: </b>{path(field.path, this.props.data)} </p>\n                    );\n                })}\n              </div>\n          }\n          {this.props.data && this.props.data.fieldValue &&\n            <div className={ tooltipStyle.detailPanel }>\n              <h3>{this.props.data.fieldValue} </h3>\n            </div>\n          }\n          {!this.props.data.fieldValue  &&\n            <p className={appStyle.accordionHeader} onClick={this.toggleShowNote}>\n              Notes {!showNote && <FontAwesomeIcon icon={faAngleDoubleDown} />}{showNote && <FontAwesomeIcon  onClick={this.toggleShowNote} icon={faAngleDoubleUp} />}\n            </p>\n          }\n          \n          {showNote &&\n          <div>\n            <b><h1><input className={tooltipStyle.inputStyle} type=\"text\" value={this.state.note.note.title} onChange={this.handleChangeTitle} placeholder=\"Title\"/></h1></b>\n            <p><textarea className={tooltipStyle.inputStyle} type=\"text\" value={this.state.note.note.content} onChange={this.handleChangeContent} placeholder=\"Take a note...\"/></p>\n            <div style={{textAlign:\"center\"}}>\n              <label className=\"button circular\" onClick={this.saveNote}>\n                <FontAwesomeIcon style={{margin:\"2.5px\"}} icon={faSave} />\n              </label>\n              <label className=\"button circular\" onClick={this.removeNote}>\n                <FontAwesomeIcon style={{margin:\"2.5px\"}} icon={faTrashAlt}  />\n              </label>\n            </div>\n          </div>\n          }\n        </div>\n        }\n      </>\n    );\n  }\n}\nconst mapStateToProps = (state) => {\n  return {\n    position: getPosition(state),\n    data: getSelectedDatum(state),\n    notes: getNotesIndexedByHash(state),\n    fields: selectMergedConfiguration(state).fields,\n  };\n};\n\nconst mapDispatchToProps = {\n  addNote,\n  removeNote,\n};\n\nexport default connect(mapStateToProps,mapDispatchToProps)(TooltipControls);\n\n","import React, { Component } from \"react\";\nimport { connect } from 'react-redux';\nimport classNames from 'classnames';\nimport Modal from 'react-modal';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { RingLoader } from 'react-spinners';\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { \n  faCheck, faDizzy, faPlus, faHome, faAngleDoubleDown, faAngleDoubleUp,\n  faFileExport, faFileImport, faTimes\n} from \"@fortawesome/free-solid-svg-icons\";\n\nimport { \n  selectDatasets, getLastUpdated, removeDataset,getKeyFields, getIgnoredFields\n} from 'domain/dataset';\nimport { \n  setHierarchyConfig, showNodes, colorBy, selectControls, setStartDataset, setEndDataset,\n  showBusy\n} from 'domain/controls';\nimport { getAllNotes } from \"./domain/notes\";\nimport { getError, clearError } from \"domain/error\";\nimport { removeSearchIndex } from \"epics/index-dataset-epic\";\nimport { uploadDataset } from \"epics/upload-dataset-epic\";\n\nimport Header from 'features/header/Header';\nimport HierarchySelector from 'features/hierarchy-selector/HierarchySelector';\nimport ComparisonSelector from 'features/comparison-selector/ComparisonSelector';\nimport NoteSelectorList from 'features/note-selector/NoteSelector';\nimport MiscControls from 'features/misc-controls/MiscControls';\nimport SearchControls from 'features/search/SearchControls';\nimport Visualization from 'features/visualization/Visualization';\nimport DatasetControls from 'features/dataset-controls/DatasetControls';\nimport DatasetSlider from 'features/dataset-controls/DatasetSlider';\nimport DatasetUpload from 'features/dataset-controls/DatasetUpload';\nimport { getDataToExport } from \"features/dataset-controls/export\";\nimport TooltipControls from \"features/tooltip/Tooltip\";\n\nimport style from './App.module.css';\n\nimport datasets from './datasets';\n\nModal.setAppElement('#root');\nconst IMPORT = \"import\";\nconst EXPORT = \"export\";\nconst DATA = \"data\";\nconst CONTROLS = \"controls\";\nconst NOTES = \"notes\";\nconst defaultOptions = {\n      action: \"\",\n      data: true,\n      controls: true,\n      notes: true\n    }\n\nconst getUniqueDatasetList = (datasetAdded, uuidsFromState, uuidsFromProps) => {\n  let result = [];\n\n  if(datasetAdded || uuidsFromProps.length === 0){\n    const uniqueOwners = new Set();\n    uuidsFromProps.concat(uuidsFromState).forEach((u) => {\n      if(!uniqueOwners.has(u.owner)){\n        uniqueOwners.add(u.owner);\n        result.push(u);\n      }\n    });\n  }\n  else {\n    result = uuidsFromProps;\n  }\n\n  return result;\n}\n\nclass App extends Component {\n\n  constructor(props) {\n    super(props);\n\n    const url = new URL(window.location);\n    const params = new URLSearchParams(url.search);\n    const ds_uri = params.get(\"dataSourceUrl\");\n    const ds_name = params.get(\"dataSourceName\") || ds_uri || \"\"; \n     \n    const initial_data_source = {'name': ds_name, 'url': ds_uri };\n\n    this.state = {\n      showData: true,\n      showGrouping: false,\n      showFiltering: false,\n      uuids: [{'owner': uuidv4(), 'name': 'Series 0', 'shortName': 's0'}],\n      datasetAdded: false,\n      startUuid: null,\n      endUuid: null,\n      showOptions: false,\n      options: {\n        action: \"\",\n        data: true,\n        controls: true,\n        notes: true,\n      },\n      selectedFile: null,\n      exportName: \"dataset.json\",\n      initialDataSource: ds_uri ? initial_data_source : null,\n      resetNodeStyles: false,\n    };\n  }\n\n  static getDerivedStateFromProps = (nextProps, prevState) =>{\n    const datasetAdded = prevState.datasetAdded && (nextProps.uuids.length !== prevState.uuids.length)\n    const uniqueUuids = getUniqueDatasetList(datasetAdded, prevState.uuids, nextProps.uuids);\n    const startUuid = nextProps.startUuid && uniqueUuids.findIndex(u => u.owner === nextProps.startUuid) !== -1 ? nextProps.startUuid : prevState.startUuid;\n    const endUuid = nextProps.endUuid && uniqueUuids.findIndex(u => u.owner === nextProps.endUuid) !== -1 ? nextProps.endUuid : prevState.endUuid;\n    return {\n      uuids: uniqueUuids,\n      startUuid: startUuid,\n      endUuid: endUuid,\n      datasetAdded: datasetAdded,\n    };\n  }\n\n  componentDidUpdate = (prevProps) => {\n    if(this.state.resetNodeStyles){\n      this.setState({\n        resetNodeStyles: false,\n      });\n    }\n  }\n\n  toggleShowData = () =>{\n    this.setState({\n      showData: !this.state.showData,\n      showComparison: false,\n      showNotes:false,\n      showGrouping: false,\n      showFiltering: false,\n    });\n  }\n\n  toggleShowComparison = () =>{\n    this.setState({\n      showData: false,\n      showComparison: !this.state.showComparison,\n      showGrouping: false,\n      showFiltering: false\n    });\n  }\n\n  toggleShowNotes = () =>{\n    this.setState({\n      showData: false,\n      showComparison: false,\n      showNotes: !this.state.showNotes,\n      showGrouping: false,\n      showFiltering: false\n    });\n  }\n\n  toggleShowGrouping = () =>{\n    this.setState({\n      showData: false,\n      showComparison: false,\n      showGrouping: !this.state.showGrouping,\n      showFiltering: false\n    });\n  }\n\n  toggleShowFiltering = () =>{\n    this.setState({\n      showData: false,\n      showComparison: false,\n      showGrouping: false,\n      showFiltering: !this.state.showFiltering\n    });\n  }\n\n  onErrorClose = () => {\n    this.props.clearError();\n  }\n\n  resetControls = () => {\n    this.props.colorBy(null);\n    this.props.setHierarchyConfig([]);\n    this.props.showNodes(true);\n    this.setState({\n      resetNodeStyles: true,\n    });\n  }\n\n  showImportOptions = () => {\n    this.showOptions(IMPORT);\n  }\n\n  showExportOptions = () => {\n    this.showOptions(EXPORT);\n  }\n\n  showOptions = (action) => {\n    this.setOptions(\"action\", action);\n    this.setState({showOptions: true})\n  }\n\n  processOptions = () => {\n    if(this.state.options.action === IMPORT)\n    {\n      this.props.showBusy(true);\n      if(this.state.selectedFile){\n        this.props.uploadDataset({\n          'owner': uuidv4(),\n          'file': this.state.selectedFile,\n          'includeData': this.state.options.data,\n          'includeControls': this.state.options.controls,\n          'includeNotes': this.state.options.notes,\n        })\n      }\n      this.setState({showOptions: false })\n    }\n  }\n\n  onUpload = (file) => {\n    this.setState({\n      selectedFile: file,\n    });\n  }\n\n  getDownloadUrl = () => {\n    const datasets = this.state.options.data && this.props.fullDatasets;\n    const controls = this.state.options.controls && this.props.controls;\n    const notes = this.state.options.notes && this.props.notes;\n    const keyFields = this.state.options.data && this.props.keyFields;\n    const ignoredFields = this.state.options.data && this.props.ignoredFields;\n    const exportData = getDataToExport(datasets, keyFields, ignoredFields, controls,notes)\n    const urlObject = window.URL || window.webkitURL || window;\n    const json = JSON.stringify(exportData, null, 2);\n    const blob = new Blob([json], {'type': \"application/json\"});\n    const url = urlObject.createObjectURL(blob);;\n    return url;\n  }\n\n  exportNameChange = (name) => {\n    this.setState({\n      exportName: name,\n    });\n  }\n\n  cancelOptions = () => {\n    this.setState({\n      showOptions: false,\n      options: defaultOptions\n    })\n  }\n\n  setOptions = (key, value) => {\n    const options = this.state.options;\n    options[key] = value;\n    this.setState({options: options});\n  }\n\n  addDatasetEntry = () => {\n    const uuids = this.state.uuids;\n    const newItem = { 'owner': uuidv4(), 'name': 'Series ' + uuids.length, 'shortName': 's' + uuids.length };\n    uuids.push(newItem);\n    this.setState({\n      uuids: uuids,\n      datasetAdded: true\n    });\n  }\n\n  removeDatasetEntry = (uuid) =>{\n    const uuids = this.state.uuids;\n    if(uuids.includes(uuid)){\n      const newUuids = uuids.splice(uuids.indexOf(uuid), 1);\n      this.setState({uuids: newUuids})\n    }\n    this.props.removeSearchIndex({'owner': uuid});\n    this.props.removeDataset({'owner': uuid});\n  }\n\n  setStartUuid = (uuid) =>{\n    this.setState({startUuid: uuid});\n    this.props.setStartDataset(uuid);\n  }\n\n  setEndUuid = (uuid) =>{\n    this.setState({endUuid: uuid});\n    this.props.setEndDataset(uuid);\n  }\n\n  render() {\n    const { datasetCount, darkTheme, error, lastUpdated} = this.props;\n    const hasDataset = datasetCount > 0;\n\n    const uuids = this.state.uuids;\n    const startUuid = this.state.startUuid;\n    const endUuid = this.state.endUuid;\n    const showData = this.state.showData;\n    const showComparison = this.state.showComparison;\n    const showNotes = this.state.showNotes;\n    const showGrouping = this.state.showGrouping;\n    const showOptions = this.state.showOptions;\n    const options = this.state.options;\n    const initialDataSource = this.state.initialDataSource;\n\n    return (\n      <div className={\n          classNames({\n            [style.appContainer]: true,\n            'darkTheme': darkTheme\n          })\n      }>\n        <input name=\"hideControls\" id=\"hideControls\" type=\"checkbox\" />\n        <label htmlFor=\"hideControls\" className={ style.hideControls }>\n          { /* <FontAwesomeIcon icon={faChevron} /> */ }\n          <span>&lt;&lt;</span>\n        </label>\n        <div className={ style.controls }>\n          <Header />\n          <div className={ classNames({ [style.centerSpan]: true }) }>\n            <div className=\"button circular\" title=\"Reset Controls\" size=\"3x\" onClick={this.resetControls}>\n              <FontAwesomeIcon icon={faHome} />\n            </div>\n          </div>\n          <div className={style.accordionHeader} onClick={this.toggleShowData}>\n            Data  {!showData && <FontAwesomeIcon icon={faAngleDoubleDown} />}{showData && <FontAwesomeIcon onClick={this.toggleShowData} icon={faAngleDoubleUp} />}\n          </div>\n          <div className={ classNames({ [style.section]: true, [style.hidden]: !showData })}>\n            {uuids.map((uuid) => {\n              return(\n                <div  key={ uuid.owner + \"_container\" } >\n                  <DatasetControls \n                    uuid={ uuid.owner }\n                    name={ uuid.name }\n                    shortName={ uuid.shortName }\n                    removeDatasetEntry={ this.removeDatasetEntry }\n                    removable={uuids.length > 1}\n                    datasets={ datasets }\n                    initialDataSource={initialDataSource}/>\n                </div>\n              )\n            })}\n            <span className={ style.centerSpan }>\n              <div className=\"button circular\" title=\"Add Dataset\" onClick={this.addDatasetEntry}>\n                <FontAwesomeIcon icon={faPlus} />\n              </div>\n            </span>\n          </div>\n\n          { hasDataset &&\n            <div className={ classNames({ [style.section]: true, [style.hidden]: !showData }) }>\n              <SearchControls />\n            </div>\n          }\n\n          <div className={style.accordionHeader} onClick={this.toggleShowGrouping}>\n            Grouping  {!showGrouping && <FontAwesomeIcon icon={faAngleDoubleDown} />}{showGrouping && <FontAwesomeIcon  onClick={this.toggleShowGrouping} icon={faAngleDoubleUp} />}\n          </div>\n          { hasDataset &&\n            <div className={ classNames({ [style.section]: true, [style.hierarchySection]: true, [style.hidden]: !showGrouping }) }>\n              <HierarchySelector />\n            </div>\n          }\n\n          { hasDataset &&\n            <div className={ classNames({ [style.section]: true, [style.hidden]: !showGrouping }) }>\n              <MiscControls />\n            </div>\n          }\n          { !hasDataset && \n            <div className={ classNames({ [style.section]: true, [style.dimSection]:true, [style.hierarchySection]: true, [style.hidden]: !showGrouping }) }>\n              Please select a dataset to continue\n            </div>\n          }\n\n          <div className={style.accordionHeader} onClick={this.toggleShowComparison}>\n            Comparison  {!showComparison && <FontAwesomeIcon icon={faAngleDoubleDown} />}{showComparison && <FontAwesomeIcon  onClick={this.toggleShowComparison} icon={faAngleDoubleUp} />}\n          </div>\n          { datasetCount >= 2 &&\n            <div className={ classNames({ [style.section]: true, [style.hierarchySection]: true, [style.hidden]: !showComparison }) }>\n              <ComparisonSelector startUid={startUuid} endUid={endUuid} />\n            </div>\n          }\n          { datasetCount < 2 && \n            <div className={ classNames({ [style.section]: true, [style.dimSection]:true, [style.hierarchySection]: true, [style.hidden]: !showComparison }) }>\n              Please select at least 2 datasets to continue\n            </div>\n          }\n          <div className={style.accordionHeader} onClick={this.toggleShowNotes}>\n            Notes  {!showNotes && <FontAwesomeIcon icon={faAngleDoubleDown} />}{showNotes && <FontAwesomeIcon  onClick={this.toggleShowNotes} icon={faAngleDoubleUp} />}\n          </div>\n          { showNotes &&\n            <div> \n              <NoteSelectorList />\n            </div>\n          }\n\n          \n          <div className={style.footerContainer}>\n            <span className={ style.centerSpan }>\n                <div className=\"button circular\" title=\"Import Dataset\" onClick={this.showImportOptions}>\n                  <FontAwesomeIcon icon={faFileImport} />\n                </div>\n                <div className=\"button circular\" disabled={!hasDataset} title=\"Export Dataset\" onClick={this.showExportOptions}>\n                  <FontAwesomeIcon icon={faFileExport} />\n                </div>\n            </span>\n          </div>\n\n          \n        </div>\n        { datasetCount === 0 && lastUpdated !== null &&\n          <div  className={ style.emptyDataset }>\n            <span>\n              Current dataset is empty\n            </span>\n          </div>\n        }\n\n        \n\n        <div className={ style.canvas }>\n          <Visualization startUid={startUuid} endUid={endUuid} resetNodeStyles={this.state.resetNodeStyles}/>\n        </div>\n        <div className={classNames({ [style.key]: true, [style.hidden]: datasetCount < 2 }) }>\n          <svg width=\"100%\" height=\"60\">\n            <g>\n              <g className=\"viz-isAdded-fixed\">\n                <circle cx=\"15\" cy=\"15\" r=\"10\"/>\n              </g>\n              <text x=\"30\" y=\"15\">Added</text>\n            </g>\n            <g>\n              <g className=\"viz-isChanged-fixed\">\n                <circle cx=\"100\" cy=\"15\" r=\"10\"/>\n              </g>\n              <text x=\"115\" y=\"15\">Changed</text>\n            </g>\n            <g>\n              <g className=\"viz-isRemoved-fixed\">\n                <circle cx=\"200\" cy=\"15\" r=\"10\"/>\n              </g>\n              <text x=\"215\" y=\"15\">Removed</text>\n            </g>\n          </svg>\n        </div>\n        <div className={ classNames({ [style.sliderContainer]: true, [style.hidden]: datasetCount < 2 }) } >\n          <DatasetSlider points={uuids} startUuid={startUuid} endUuid={endUuid} \n            setStartUuid={this.setStartUuid} setEndUuid={this.setEndUuid} />\n        </div>\n        <Modal isOpen={ error !== null } onRequestClose={this.onErrorClose} contentLabel=\"An Error has occurred\">\n            <div className={ style.modal }>\n              <div className={ style.modalMain }>\n                <span className={ style.justifySpan }>\n                   <div className={ style.icon } title=\"Error\">\n                        <FontAwesomeIcon icon={faDizzy} size=\"7x\" color=\"#cc0000\"/>\n                    </div>\n                    <div>\n                      { error ? error.message : \"\"}\n                    </div>\n                </span>\n                <div>\n                  <span className={ style.centerSpan }>\n                    <div className=\"button circular\" title=\"Ok\" onClick={this.onErrorClose}>\n                        <FontAwesomeIcon icon={faCheck} />\n                    </div>\n                  </span>\n                </div>\n              </div>\n            </div>\n        </Modal>\n        <Modal isOpen={ showOptions } onRequestClose={this.cancelOptions} contentLabel=\"An Error has occurred\">\n          <div className={ style.modal }>\n            <div className={ style.modalMain }>\n              {options.action === IMPORT &&\n                <div className={style.uploadContainer}>\n                  <span className={style.label}>Upload</span>\n                  <DatasetUpload\n                    ownerUuid={uuidv4()}\n                    className={style.fileUpload}\n                    selected={this.state.selectedFile ? this.state.selectedFile.name : null}\n                    onChange={this.onUpload}\n                  />\n                </div>\n                }\n                {options.action === EXPORT &&\n                <div className={style.uploadContainer}>\n                  <span className={style.label}>Export As</span>\n                  <input\n                    type=\"text\"\n                    id=\"export-as\"\n                    value={this.state.exportName}\n                    onChange={(evt) => this.exportNameChange(evt.target.value)}\n                  />\n                </div>\n                }\n              <div className={style.container}>\n                <div className={`${style.checkboxContainer} input-group`}>\n                  <div className={ style.switch }>\n                    <input\n                      type=\"checkbox\"\n                      id=\"data-check\"\n                      checked={options.data}\n                      onChange={(evt) => this.setOptions(DATA, evt.target.checked)}\n                    />\n                    <label htmlFor=\"data-check\" className={ style.switchLabel }>\n                    </label>\n                  </div>\n                  <label >Data</label>\n                </div>\n                <div className={`${style.checkboxContainer} input-group`}>\n                  <div className={ style.switch }>\n                    <input\n                      type=\"checkbox\"\n                      id=\"controls-check\"\n                      checked={options.controls}\n                      onChange={(evt) => this.setOptions(CONTROLS, evt.target.checked)}\n                    />\n                    <label htmlFor=\"controls-check\" className={ style.switchLabel }>\n                    </label>\n                  </div>\n                  <label >Controls</label>\n                </div>\n                <div className={`${style.checkboxContainer} input-group`}>\n                  <div className={ style.switch }>\n                    <input\n                      type=\"checkbox\"\n                      id=\"notes-check\"\n                      checked={options.notes}\n                      onChange={(evt) => this.setOptions(NOTES, evt.target.checked)}\n                    />\n                    <label htmlFor=\"notes-check\" className={ style.switchLabel }>\n                    </label>\n                  </div>\n                  <label>Notes</label>\n                </div>\n              </div>\n              <div>\n                <span className={ style.centerSpan }>\n                  {options.action === IMPORT &&\n                    <div className=\"button circular\" title=\"Ok\" \n                         disabled={options.action === IMPORT && !this.state.selectedFile} \n                         onClick={this.processOptions}>\n                        <FontAwesomeIcon icon={faCheck} />\n                    </div>\n                  }\n                  {options.action === EXPORT &&\n                    <a className=\"button circular\" href={ this.getDownloadUrl() } download={ this.state.exportName }\n                      title=\"Download\" disabled={!hasDataset} onClick={this.cancelOptions} >\n                      <FontAwesomeIcon icon={faCheck} />\n                    </a>\n                  }\n                  <div className=\"button circular\" title=\"Cancel\" onClick={this.cancelOptions}>\n                      <FontAwesomeIcon icon={faTimes} />\n                  </div>\n                </span>\n              </div>\n            </div>\n          </div>\n        </Modal>\n        <div className={style.activityIndicatorContainer}>\n          <RingLoader\n            sizeUnit={\"px\"}\n            size={150}\n            color={'#0277BD'}\n            loading={this.props.shouldShowBusy}\n          />\n        </div>\n  \n          <div >\n            <TooltipControls />\n          </div>\n  \n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  const datasets = selectDatasets(state);\n  const uuids = Object.keys(datasets).map(key => ({ 'owner': key, 'name': datasets[key].name, 'shortName': datasets[key].shortName })) \n                || [{ 'owner': uuidv4(), 'name': \"Series 0\", 'shortName': \"s0\" }];\n  const datasetCount = uuids.length;\n  const controls = selectControls(state);\n\n  return {\n    datasetCount: datasetCount,\n    darkTheme: controls.darkTheme,\n    error: getError(state),\n    lastUpdated: getLastUpdated(state, uuids[0]),\n    uuids: uuids,\n    startUuid: controls.start,\n    endUuid: controls.end,\n    fullDatasets: datasets,\n    controls: controls,\n    notes: getAllNotes(state),\n    keyFields: getKeyFields(state),\n    ignoredFields: getIgnoredFields(state),\n    shouldShowBusy: controls.showBusy,\n  }\n}\n\nconst mapDispatchToProps = {\n  clearError,\n  setHierarchyConfig, \n  showNodes, \n  colorBy, \n  removeDataset,\n  removeSearchIndex,\n  setStartDataset,\n  setEndDataset,\n  uploadDataset,\n  showBusy,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import { createAction, handleActions } from \"redux-actions\";\nimport compileExpression from \"filtrex\";\n\nconst defaultState = {\n  filterString: \"\",\n  filter: null,\n  isValid: false\n};\n\n// ACTIONS\nconst setFilter = createAction(\"SET_FILTER\");\nconst clearFilter = createAction(\"CLEAR_FILTER\");\n\n// REDUCERS\nconst reducer = handleActions(\n  {\n    [setFilter]: (state, { payload }) => {\n\n\t  \tconst filterString = payload;\n\t  \tlet filter = null;\n\t  \tlet isValid = false;\n\t  \ttry\n\t  \t{\n\t  \t\tfilter = compileExpression(filterString);\n\t  \t\tisValid = true;\n\n\t  \t}\n\t  \tcatch(error)\n\t  \t{\n\t  \t\tfilter = null;\n\t  \t\tisValid = false;\n\n\t  \t}\n\t  \treturn { ...state, filterString, filter, isValid };\n\n    },\n    [clearFilter]: (state) => {\n     \tconst filterString = \"\";\n\t  \tlet filter = null;\n\t  \tlet isValid = false;\n      return { ...state, filterString, filter, isValid };\n    }\n  },\n  defaultState\n);\n\n// SELECTORS\nconst getFilter = (state) => state.filter.filter;\nconst filterIsValid = (state) => state.filter.isValid;\n\nexport default reducer;\n\nexport { setFilter, getFilter, clearFilter, filterIsValid};","import { combineReducers } from \"redux\";\nimport { searchReducer as search } from 'epics/index-dataset-epic'\nimport dataset from \"./dataset\";\nimport controls from \"./controls\";\nimport error from \"./error\";\nimport filter from \"./filter\";\nimport notes from \"./notes\";\n\nexport default combineReducers({\n  dataset,\n  search,\n  controls,\n  error,\n  filter,\n  notes\n});\n","import { createAction } from \"redux-actions\";\nimport { of, empty } from \"rxjs\";\nimport { mergeMap, map, tap, catchError } from 'rxjs/operators';\n\nimport { setError } from \"domain/error\"\nimport { getFilter } from \"domain/filter\"\nimport { setFilteredDataset } from \"domain/dataset\"\n\nconst filterDataset = createAction(\"FILTER_DATASET\");\n\nconst filterDatasetEpic = (action$, store) => {\n  return action$\n    .ofType(filterDataset.toString()).pipe(\n      mergeMap(({ payload}) => {\n        const filter = getFilter(store.value);\n\n        if(filter === null)\n          return empty();\n\n        return of(payload).pipe(\n            tap(applyFilter(payload, filter))\n            ,map((payload) =>\n              setFilteredDataset({\n                owner: payload.owner,\n                filtered: payload.filtered\n              })\n            )\n            ,catchError((error) => {\n               const newErr = new Error(\"Error filtering dataset: \" + error.message);\n               return of(setError(newErr));\n            })\n          );\n      })\n    );\n};\n\nconst applyFilter = (data, filter) => {\n  data.filtered = null;\n  const dataset = data.dataset;\n\n  if(filter !== null){\n    data.filtered = dataset.filter((item) => filter(item));\n  }\n\n  return data;\n};\n\nexport default filterDatasetEpic;\n\nexport { filterDataset };","import { combineEpics } from 'redux-observable';\nimport fetchDatasetEpic from './fetch-dataset-epic';\nimport uploadDatasetEpic from './upload-dataset-epic';\nimport loadDatasetEpic from './load-dataset-epic';\nimport searchDatasetEpic from './search-dataset-epic';\nimport indexDatasetEpic from './index-dataset-epic';\nimport refreshDatasetEpic from './refresh-dataset-epic';\nimport filterDatasetEpic from './filter-dataset-epic';\nimport diffDatasetEpic from './diff-dataset-epic';\n\nconst rootEpic = combineEpics(\n  loadDatasetEpic,\n  fetchDatasetEpic,\n  uploadDatasetEpic,\n  searchDatasetEpic,\n  indexDatasetEpic,\n  refreshDatasetEpic,\n  filterDatasetEpic,\n  diffDatasetEpic\n);\n\nexport default rootEpic;\n","import { createStore, applyMiddleware, compose } from \"redux\";\n\nimport { createEpicMiddleware } from 'redux-observable';\nimport rootReducer from './domain/root-reducer';\nimport rootEpic from './epics/root-epic';\n\n// Replace redux compose with redux-devtools compose if it exists\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nconst configureStore = (initialState = {}) => {\n  const middleware = createEpicMiddleware()\n\n  const store = createStore(rootReducer,\n    initialState,\n    composeEnhancers(\n      applyMiddleware(middleware)\n    )\n  );\n\n  middleware.run(rootEpic);\n\n  return store;\n};\n\nexport default configureStore;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { Provider } from \"react-redux\";\n\nimport \"index.css\";\nimport App from \"./App\";\nimport registerServiceWorker from \"./registerServiceWorker\";\n\nimport configureStore from \"./configure-store\";\n\nconst store = configureStore();\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById(\"root\")\n);\n\nregisterServiceWorker();\n\nif (module.hot) {\n  module.hot.accept(\"./App\", () => {\n    ReactDOM.render(\n      <Provider store={store}>\n        <App />\n      </Provider>,\n      document.getElementById(\"root\")\n    );\n  });\n}\n","import { createAction, handleActions } from \"redux-actions\";\nimport {\n  chain,\n  concat,\n  find,\n  fromPairs,\n  identity,\n  is,\n  map,\n  merge,\n  path,\n  pipe,\n  propEq,\n  sortBy,\n  toPairs,\n  uniq,\n  //memoizeWith,\n} from \"ramda\";\n\nconst defaultState = {\n  datasets: {},\n  diffs:[],\n  keyFields: [],\n  ignoredFields: []\n};\nconst defaultItemState = {\n  owner: \"\",\n  source: null,\n  name: \"\",\n  shortName: \"\",\n  dataset: [],\n  keyCount: 0,\n  uniqueKeyCount: 0,\n  filtered: null,\n  values: {},\n  configuration: {\n    fields: [],\n    keyFields: [],\n    hashFields: []\n  },\n  isFetching: false,\n  lastUpdated: null,\n};\n\nconst getHashFields = (allFields, ignoredFields) => {\n  if(!ignoredFields || ignoredFields.length === 0){\n    return allFields;\n  }\n\n  return allFields.filter(f => !ignoredFields.includes(f));\n}\n\nconst addHashKey = (keys, obj) => {\n  const hashKey = keys.reduce( (h, k) => h + path(k.path, obj) + \":\", \"\");\n  obj.CRVIZ[\"_HASH_KEY\"] = hashKey;\n}\n\nconst addHashWithoutIgnored = (fields, obj) => {\n  const hash = fields.reduce( (h, f) => h + path(f.path, obj) + \"|\", \"\");\n  obj.CRVIZ[\"_HASH_WITHOUT_IGNORED\"] = hash;\n}\n\nconst addSearchKey = (keys, obj) => {\n  const searchKey = keys.reduce( (h, k) => h + path(k.path, obj) + \":\", \"\");\n  obj.CRVIZ[\"_SEARCH_KEY\"] = searchKey;\n}\n\nconst applyHashes = (dataset, configuration) => {\n  const keys = [];\n  dataset.forEach((i) => {\n    if(!('CRVIZ' in i)){\n      i['CRVIZ'] = {};\n    }\n    if(!configuration.hashFields){\n      configuration.hashFields = getHashFields(configuration.fields, configuration.ignoredFields || []);\n    }\n\n    addHashKey(Array.isArray(configuration.keyFields) && configuration.keyFields.length > 0 ? configuration.keyFields : configuration.hashFields, i);\n    addHashWithoutIgnored(configuration.hashFields, i);\n    addSearchKey(configuration.fields, i);\n    keys.push(i.CRVIZ._HASH_KEY);\n  });\n  const uniqueKeys = Array.from(new Set(keys));\n  return {keyCount: keys.length, uniqueKeyCount:uniqueKeys.length}\n};\n\n/**\n * Return a string that uniquely identify the field\n */\nconst getFieldId = (field) => {\n  if(field.path.length >= 1 && field.path[0])\n    return field.path.join(\".\")\n  else\n    return \" \";\n}\n\n/**\n * Returns an array of paths to literal values and arrays in a POJO.\n *\n * Example:\n * pathsIn({ a: 'A', b: { c: 'C', d: [1, 2] } }) //=> [['a'], ['b', 'c'], ['b', 'd']]\n */\nconst pathsIn = (obj) =>\n  chain(\n    ([key, value]) =>\n      is(Object, value) ? map(concat([key]), pathsIn(value)) : [[key]],\n    toPairs(obj)\n  );\n\n/**\n * Return all fields for an object\n */\nconst fieldsFor = (obj, overrides = []) => {\n  const paths = pathsIn(obj).filter(p => p[0] !== 'CRVIZ');\n  return map((path) => {\n    const override = find(propEq('path', path), overrides) || {};\n    return merge(\n      {\n        path: path,\n        displayName: path.join('.'),\n        groupable: true\n      },\n      override\n    )\n  }, paths);\n\n  // var fields = difference(pathsIn(obj), map(prop('path'), overrides));\n  // return [\n  //   ...overrid,\n  //   ...map(\n  //     (path) => ({\n  //       path: path,\n  //       displayName: path.join(\".\"),\n  //       groupable: true\n  //     }),\n  //     unspecified\n  //   )\n  // ];\n};\n\n/**\n * Returns a configuration with any missing items populated\n */\nconst configurationFor = (dataset, keyFields, ignoredFields, configuration = {}) => {\n  const fields = fieldsFor(dataset[0] || {}, configuration.fields);\n  const hashFields = getHashFields(fields, ignoredFields);\n  return {\n    ...configuration,\n    fields: fieldsFor(dataset[0] || {}, configuration.fields),\n    keyFields: keyFields,\n    hashFields: hashFields\n  };\n};\n\n\nconst valuesFor = (dataset, configuration) => {\n  return fromPairs(map((field) => {\n    const values = pipe(\n      map(path(field.path)),\n      uniq,\n      sortBy(identity)\n    )(dataset);\n\n    return [getFieldId(field), values];\n  }, configuration.fields));\n};\n\nconst configureDataset = (dataset, source, name, shortName, initialConfig, keyFields, ignoredFields) => {\n  const configuration = configurationFor(\n    dataset || [],\n    keyFields,\n    ignoredFields,\n    initialConfig || {}\n  );\n  const { keyCount, uniqueKeyCount } = applyHashes(dataset, configuration);\n\n  const values = valuesFor(dataset, configuration);\n  const isFetching = false;\n  const lastUpdated = new Date();\n  return {\n    dataset: dataset,\n    source: source,\n    name: name,\n    shortName: shortName,\n    keyCount: keyCount,\n    uniqueKeyCount: uniqueKeyCount,\n    filtered: null,\n    values: values,\n    configuration: configuration,\n    isFetching: isFetching,\n    lastUpdated: lastUpdated\n  }\n}\n\n// ACTIONS\n\n/**\n * Payload: {\n *   dataset: [], // Array of devices\n *   configuration: {} // Configuration\n * }\n*/\nconst setDatasets = createAction(\"SET_DATASETS\");\nconst setDataset = createAction(\"SET_DATASET\");\nconst setFilteredDataset = createAction(\"SET_FILTERED_DATASET\");\nconst setDatasetDiff = createAction(\"SET_DATASET_DIFF\");\nconst removeDataset = createAction(\"REMOVE_DATASET\");\nconst removeFilteredDataset = createAction(\"REMOVE_FILTERED_DATASET\");\nconst removeDatasetDiff = createAction(\"REMOVE_DATASET_DIFF\");\nconst setIsFetching = createAction(\"SET_IS_FETCHING\");\nconst setKeyFields = createAction(\"SET_KEY_FIELDS\");\nconst setIgnoredFields = createAction(\"SET_IGNORED_FIELDS\");\n\n// REDUCERS\nconst reducer = handleActions(\n  {\n    [setDatasets]: (state, { payload }) => {\n      const datasets = payload.datasets;\n      Object.keys(datasets).forEach((key) => {\n        state.datasets[key] = datasets[key];\n      })\n      \n      return { ...state};\n    },\n    [setDataset]: (state, { payload }) => {\n      const dataset = payload.dataset;\n      const owner = payload.owner;\n      const source = payload.source;\n      const name = payload.name;\n      const shortName = payload.shortName;\n      const initialConfig = payload.configuration;\n      const keyFields = getKeyFields(state);\n      const ignoredFields = getIgnoredFields(state);\n      state.datasets[owner] = configureDataset(dataset, source, name, shortName, initialConfig, keyFields, ignoredFields);\n      return { ...state};\n    },\n    [setFilteredDataset]: (state, { payload }) => {\n      const filtered = payload.filtered;\n      const owner = payload.owner;\n\n      state.datasets[owner].filtered = filtered;\n      return { ...state};\n    },\n    [setDatasetDiff]: (state, { payload }) => {\n      const start = payload.start;\n      const end = payload.end;\n      const differences = payload.differences\n      const newDiff = {\n        'start': start,\n        'end': end,\n        'differences': differences\n      }\n\n      const idx = state.diffs.findIndex(d => d.start === start && d.end === end);\n\n      if(idx === -1){\n        state.diffs.push(newDiff);\n      } else {\n        state.diffs[idx] = newDiff;\n      }\n      return { ...state};\n    },\n    [removeDataset]: (state, { payload }) => {\n      const owner = payload.owner;\n      if(state.datasets.hasOwnProperty(owner))\n        delete state.datasets[owner];\n\n      return { ...state }\n    },\n    [removeFilteredDataset]: (state, { payload }) => {\n      const owner = payload.owner;\n      if(state.datasets.hasOwnProperty(owner))\n        state.datasets[owner].filtered = null;\n\n      return { ...state }\n    },\n    [removeDatasetDiff]: (state, { payload }) => {\n      const start = payload.start;\n      const end = payload.end;\n      const idx = state.diffs.findIndex(d => d.start === start && d.end === end);\n\n      if(idx !== -1){\n        state.diffs.splice(idx, 1);\n      }\n\n      return { ...state }\n    },\n    [setIsFetching]: (state, { payload }) => {\n      const owner = payload.owner;\n      const isFetching = !!payload.isFetching;\n      if(state.datasets.hasOwnProperty(owner))\n        state.datasets[owner].isFetching = isFetching;\n      return { ...state, isFetching};\n    },\n    [setKeyFields]: (state, { payload }) => { \n      const keyFields = payload ? payload : state.keyFields;\n      const datasets = _selectDatasets(state);\n      if(datasets){\n        Object.keys(datasets).forEach((key) => {\n          const ds = datasets[key];\n          ds.configuration.keyFields = keyFields;\n          const { keyCount, uniqueKeyCount } = applyHashes(ds.dataset, ds.configuration);\n          ds.keyCount = keyCount;\n          ds.uniqueKeyCount = uniqueKeyCount;\n        });\n      }\n\n      return {...state, keyFields: keyFields };\n    },\n    [setIgnoredFields]: (state, { payload }) => {\n      const ignoredFields = payload ? payload : state.ignoredFields;\n      const datasets = _selectDatasets(state);\n\n      if(datasets && ignoredFields){\n        const allFields = _selectMergedConfiguration(state).fields;\n        const hashFields = getHashFields(allFields, ignoredFields);\n\n        Object.keys(datasets).forEach((key) => {\n          const ds = datasets[key];    \n          ds.configuration.hashFields = hashFields\n          const { keyCount, uniqueKeyCount } = applyHashes(ds.dataset, ds.configuration);\n          ds.keyCount = keyCount;\n          ds.uniqueKeyCount = uniqueKeyCount;\n        });\n      }\n\n      return { ...state, ignoredFields: ignoredFields };\n    }\n  },\n  defaultState\n);\n\n//methods where we need to deal with state both inside and outside of the reducer\n//outside of the reducer state represents the entire state tree, but inside of the\n//reducer the provided state is only the state for the reducer's subset of the \n//state tree.  to avoid duplication of code these methods will be called be used\n//internally from the reducer.  and methods that recieve the full state tree will \n//pare the tree down to just the relevant attributes. in these cases the\n//variable \"dataset\" will represent the segment of the state tree owned by the datset reducer.\nconst _selectDatasets = (dataset) => {\n  return dataset.datasets || {};\n}\nconst _selectMergedConfiguration = (dataset) => {\n  let fields = [];\n  const ds = dataset.datasets;\n  for (var key in ds){\n    for (var f of ds[key].configuration.fields){ \n      // eslint-disable-next-line no-loop-func\n      if(!fields.some(field => field.displayName === f.displayName)){\n        fields.push(f);\n      }\n    }\n  }\n\n  return { fields: fields };\n}\n\n// SELECTORS\nconst selectDatasets = (state) => {\n  return _selectDatasets(state.dataset);\n}\nconst selectDataset = (state, owner) => state.dataset && state.dataset.datasets[owner] && state.dataset.datasets[owner].dataset ? state.dataset.datasets[owner].dataset : defaultItemState.dataset;\nconst selectFilteredDataset = (state, owner) => state.dataset && state.dataset.datasets[owner] && state.dataset.datasets[owner].filtered ? state.dataset.datasets[owner].filtered : defaultItemState.filtered;\nconst selectDatasetDiff = (state, start, end) => {\n  let diff = null;\n  const idx = state.dataset.diffs.findIndex(d => d.start === start && d.end === end);\n  if(idx !== -1){\n    diff = state.dataset.diffs[idx].differences;;\n  }\n  return diff;\n}\nconst selectConfiguration = (state, owner) => state.dataset && state.dataset.datasets[owner] && state.dataset.datasets[owner].configuration ? state.dataset.datasets[owner].configuration : defaultItemState.configuration;\nconst selectMergedConfiguration = (state) => {\n  return _selectMergedConfiguration(state.dataset)\n}\nconst selectValues = (state, owner) => state.dataset && state.dataset.datasets[owner] && state.dataset.datasets[owner].values ? state.dataset.datasets[owner].values : defaultItemState.values;\nconst selectMergedValues = (state) => {\n  let vals = {};\n  const ds = state.dataset.datasets;\n  for (var key in ds){\n    for (var v in ds[key].values){\n      if(vals.hasOwnProperty(v)){\n        const valSet = new Set([...vals[v], ...ds[key].values[v]]);\n        vals[v] = [...valSet];\n      }\n      else {\n        vals[v] = ds[key].values[v];\n      }\n    }\n  }\n\n  return vals;\n}\nconst getIsFetching = (state, owner) => state.dataset.datasets[owner] && state.dataset.datasets[owner].isFetching ? state.dataset.datasets[owner].isFetching : defaultItemState.isFetching;\nconst getLastUpdated = (state, owner) => state.dataset.datasets[owner] && state.dataset.datasets[owner].lastUpdated ? state.dataset.datasets[owner].lastUpdated : defaultItemState.lastUpdated;\nconst getKeyFields = (state) => state.dataset && state.dataset.keyFields ? state.dataset.keyFields : [];\nconst getIgnoredFields = (state) => state.dataset && state.dataset.ignoredFields ? state.dataset.ignoredFields : [];\n\n// const memoizeKey = (state, startOwner, endOwner) => {\n//   const startUpdated = state.dataset && state.dataset.datasets[startOwner] ? state.dataset.datasets[startOwner].lastUpdated : \"NotUpdated\";\n//   const endUpdated = state.dataset && state.dataset.datasets[endOwner] ? state.dataset.datasets[endOwner].lastUpdated : \"NotUpdated\";\n//   return startOwner+\":\"+startUpdated+\"-\"+endOwner+\":\"+endUpdated\n// };\n\nconst selectDatasetIntersection = (state, startOwner, endOwner) => {\n  let ds = [];\n  const start = selectDataset(state, startOwner);\n  const end = selectDataset(state, endOwner);\n  \n  if(start.length > 0 && end.length === 0){\n    start.forEach((s) => {\n      s.CRVIZ._isRemoved = false;\n      s.CRVIZ._isChanged = false;\n      s.CRVIZ._isAdded = false;\n    });\n    ds = start;\n  } else if(start.length === 0 && end.length > 0){\n    end.forEach((e) => {\n      e.CRVIZ._isRemoved = false;\n      e.CRVIZ._isChanged = false;\n      e.CRVIZ._isAdded = false;\n    });\n    ds = end;\n  } else if(start.length > 0 && end.length > 0) {\n    start.forEach((s) => {\n      s.CRVIZ._isRemoved = false;\n      s.CRVIZ._isChanged = false;\n      s.CRVIZ._isAdded = false;\n\n      const idx = end.findIndex(e => e.CRVIZ._HASH_KEY === s.CRVIZ._HASH_KEY);\n      if(idx === -1){\n        s.CRVIZ._isRemoved = true;\n      } else {\n        s.CRVIZ._isRemoved = false;\n      }\n      s.CRVIZ._isChanged = false;\n      s.CRVIZ._isAdded = false;\n      ds.push(s);\n    });\n    end.forEach((e) => {\n      e.CRVIZ._isRemoved = false;\n      e.CRVIZ._isChanged = false;\n      e.CRVIZ._isAdded = false;\n      const idx = ds.findIndex(i => i.CRVIZ._HASH_KEY === e.CRVIZ._HASH_KEY);\n      if(idx === -1){\n        e.CRVIZ._isAdded = true;\n        ds.push(e);\n      } else if(ds[idx].CRVIZ._HASH_WITHOUT_IGNORED !== e.CRVIZ._HASH_WITHOUT_IGNORED){\n        ds[idx].CRVIZ._isChanged = true;\n      }\n    })\n  }\n  return ds;\n};\n\n\nexport default reducer;\n\nexport { setDatasets, setDataset, selectDataset, selectDatasets, removeDataset, setFilteredDataset, selectFilteredDataset, removeFilteredDataset, selectConfiguration, selectMergedConfiguration,\n  selectValues, selectMergedValues, getFieldId, configurationFor, setIsFetching, getIsFetching, setKeyFields, getKeyFields, setIgnoredFields, getIgnoredFields, getHashFields, getLastUpdated, \n  valuesFor, setDatasetDiff, removeDatasetDiff, selectDatasetDiff, selectDatasetIntersection, applyHashes, configureDataset };\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"checkboxContainer\":\"MiscControls_checkboxContainer__3kBR3\",\"colorBy\":\"MiscControls_colorBy__2SU5V\",\"fieldSelect\":\"MiscControls_fieldSelect__38svo\",\"switch\":\"MiscControls_switch__3UP8J\",\"switchLabel\":\"MiscControls_switchLabel__3eKc8\",\"switch-inner\":\"MiscControls_switch-inner__3WhMh\",\"selectorContainer\":\"MiscControls_selectorContainer__3qDfQ\",\"selector\":\"MiscControls_selector__1nfTG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"appContainer\":\"App_appContainer__3jRx1\",\"controls\":\"App_controls__14oJX\",\"section\":\"App_section__1OL6S\",\"footerContainer\":\"App_footerContainer__3ckfD\",\"dimSection\":\"App_dimSection__2KXnV\",\"hierarchySection\":\"App_hierarchySection__20JSE\",\"canvas\":\"App_canvas__1KgDx\",\"sliderContainer\":\"App_sliderContainer__14eTy\",\"hideControls\":\"App_hideControls__3-JKB\",\"modal\":\"App_modal__Ayqb5\",\"modalMain\":\"App_modalMain__2seCW\",\"justifySpan\":\"App_justifySpan__39F6d\",\"icon\":\"App_icon__NYH35\",\"centerSpan\":\"App_centerSpan__-rZ5_\",\"accordionHeader\":\"App_accordionHeader__3Xi4Q\",\"hidden\":\"App_hidden__3ofBD\",\"emptyDataset\":\"App_emptyDataset__29FeM\",\"label\":\"App_label__v_mMj\",\"selectorContainer\":\"App_selectorContainer__39_GX\",\"selector\":\"App_selector__2sCEs\",\"checkboxContainer\":\"App_checkboxContainer__1fO1K\",\"switch\":\"App_switch__2FvpM\",\"switchLabel\":\"App_switchLabel__2JZ5u\",\"switch-inner\":\"App_switch-inner__ANiwX\",\"uploadContainer\":\"App_uploadContainer__342xp\",\"fileUpload\":\"App_fileUpload__3f4jm\",\"activityIndicatorContainer\":\"App_activityIndicatorContainer__NjOjQ\",\"key\":\"App_key__3Uk0T\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"shown\":\"Tooltip_shown__1x1hM\",\"hidden\":\"Tooltip_hidden__2CFes\",\"show\":\"Tooltip_show__18BfZ\",\"hide\":\"Tooltip_hide__70RqF\",\"detailPanel\":\"Tooltip_detailPanel__2HY6a\",\"detailText\":\"Tooltip_detailText__3Ofmt\",\"inputStyle\":\"Tooltip_inputStyle__2DRWA\",\"section\":\"Tooltip_section__3q14b\"};","import { createAction } from 'redux-actions';\nimport { ofType } from 'redux-observable';\nimport { of } from 'rxjs';\nimport { ajax  as rxAjax } from 'rxjs/ajax';\nimport { catchError, debounceTime, mergeMap, map } from 'rxjs/operators';\n\nimport { setError } from \"domain/error\";\nimport { loadDataset } from './load-dataset-epic';\n\n// ACTIONS\nconst fetchDataset = createAction('FETCH_DATASET');\n\n// EPIC\nconst fetchDatasetEpic = (action$, store, ajax = rxAjax) => {\n  return action$.pipe(\n    ofType(fetchDataset.toString())\n    ,debounceTime(500)\n    ,mergeMap((action) => {\n      const owner = action.payload.owner;\n      const name = action.payload.name;\n      const shortName = action.payload.shortName;\n      const url = action.payload.url;\n      const header = action.payload.header;\n      return ajax({ 'url': url, 'headers':header, 'crossDomain': true, 'responseType': 'json' }).pipe(\n        map((result) => { \n          return { 'owner': owner, 'name': name, 'shortName': shortName, 'source': url, 'content': result.response };\n        })\n        ,map(loadDataset)\n        // I believe this was done oddly and debounce should have been used\n        // to ensure that file input was only processed once, instead of using take until\n        // which seems to be stopping the epic the second time the action passes through the stream\n        // it seems like this change doesn't change functionality and makes unit testing easier\n        // I intend to do more thorough user testing later\n        //.takeUntil(action$.ofType(fetchDataset.toString()))\n        \n      );\n    })\n    ,catchError((error) => {\n      //console.log(\"error xhr: %o\", error)\n      const newErr = new Error(\"Error fetching dataset: \" + error.message);\n      return of(setError(newErr));\n    })\n  );\n}\n\nconst getScheme = (username, password, token) =>{\n   let scheme = 'None';\n    if(token) {\n      scheme = 'Bearer'\n    } else if (username && password) {\n      scheme = 'Basic'\n    }\n    return scheme;\n}\n\nconst buildAuthHeader = (username, password, token) => {\n  let header = null;\n  var scheme = getScheme(username, password, token);\n\n  switch (scheme){\n    case 'Basic':\n       var basic = \"Basic \" + new Buffer(`${username}:${password}`).toString(\"base64\");\n       header = {'Authorization' : basic};\n      break;\n    case 'Bearer':\n      var bearer = `Bearer ${token}`;\n      header = {'Authorization' : bearer};\n      break;\n    default:\n      header = null;\n      break;\n  }\n  \n  return header;\n}\n\nexport default fetchDatasetEpic;\nexport { fetchDataset, buildAuthHeader };\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"listContainer\":\"SelectedFieldList_listContainer__1A-lJ\",\"isDropDisabled\":\"SelectedFieldList_isDropDisabled__2vQFW\",\"droppable\":\"SelectedFieldList_droppable__2zu_b\",\"draggable\":\"SelectedFieldList_draggable__2Cp8c\",\"field\":\"SelectedFieldList_field__ZLF6f\",\"groupBy\":\"SelectedFieldList_groupBy__2sKtj\",\"animated\":\"SelectedFieldList_animated__39CvG\",\"groupByEnter\":\"SelectedFieldList_groupByEnter__1cLtw\",\"fieldName\":\"SelectedFieldList_fieldName__2G9oT\",\"dropTarget\":\"SelectedFieldList_dropTarget__1J9ME\",\"isDraggingOver\":\"SelectedFieldList_isDraggingOver__1k_Dr\",\"dragHandle\":\"SelectedFieldList_dragHandle__2NjEJ\"};","import { createAction } from \"redux-actions\";\nimport { ofType } from 'redux-observable';\nimport { of } from \"rxjs\";\nimport { mergeMap, concatMap, catchError } from 'rxjs/operators';\nimport { isNil, is } from \"ramda\";\nimport { resolveRefs } from 'json-refs';\n\nimport { buildIndices } from './index-dataset-epic';\n\nimport { setError } from \"domain/error\"\nimport { setDatasets, setKeyFields, setIgnoredFields, configureDataset } from \"domain/dataset\";\nimport { setControls, showBusy } from \"domain/controls\";\nimport { setNotes } from \"domain/notes\";\n\nconst loadDataset = createAction(\"LOAD_DATASET\");\n\nconst loadDatasetEpic = (action$, store) => {\n  return action$.pipe(\n    ofType(loadDataset.toString())\n    ,mergeMap(({ payload }) => {\n      return of(payload).pipe(\n        concatMap(formatPayload)\n        ,mergeMap((payload) => {\n          return of(\n            setDatasets(payload)\n            ,setKeyFields(payload.keyFields)\n            ,setIgnoredFields(payload.ignoredFields)\n            ,setControls(payload.controls)\n            ,setNotes(payload.notes)\n            ,buildIndices(payload)\n            ,showBusy(false)\n          )\n        })\n        ,catchError((error) => {\n          if (is(ValidationError, error)) {\n            return of(setError(error));\n          } else {\n            /* istanbul ignore next */\n            throw error;\n          }\n        })\n      );\n    })\n  );\n}; \n\n// doesn't really care if it's not CSV; if it *is* CSV, convert to JSON.\n// Otherwise, just pass it along.\nconst CSVconvert = (data) => {\n  const owner = data.owner;\n  const source = data.source;\n\n  var lines = data.file.trim().split(/[\\r\\n]+/g);\n  if (lines.length < 2) { // bail if there's not even linebreaks\n    return data;\n  }\n\n  function finddelim(hdr) {\n    var delims = [',','|','\\t',';']\n    var delim = 0\n    var max = -1\n    for (var i=0; i < hdr.length; i++) {\n      if (max < hdr.split(delims[i]).length-1) {\n        max = hdr.split(delims[i]).length-1\n        delim = i\n      }\n    }\n    return delims[delim];\n  }\n\n  var delimiter = finddelim(lines[0])\n  var jsonstring = '['\n  var colnames = lines[0].split(delimiter)\n  for (var i=1; i < lines.length; i++) {\n    var entry = lines[i].split(delimiter)\n    if (entry.length !== colnames.length) { // malformed CSV, or not even CSV.\n      return data;\n    }\n    jsonstring += \"{ \"\n    for (var j=0; j < colnames.length; j++) {\n      jsonstring += '\"'+colnames[j]+'\": \"'+entry[j]+'\"';\n      if (j < colnames.length-1 ) {\n        jsonstring += \", \"\n      } else {\n        jsonstring += \" }\"\n        if (i < lines.length-1) {\n          jsonstring += \",\\n\"\n        }\n      }\n    }\n  }\n  jsonstring += ']'\n  return { 'owner': owner, 'source': source, 'file': jsonstring };\n}\n\n//if we have a naked array or an object not containing a dataset instead of an object containing a dataset\n//transfer the array into an object's dataset to maintain a consistent\n//schema with what is used elsewhere see https://github.com/IQTLabs/CRviz/issues/33\nconst formatPayload = async (data) => {\n  const owner = data.owner;\n  const initialName = data.name;\n  const initialShortName = data.shortName;\n  const source = data.source;\n  const result = await resolveRefs(data.content);\n  const content = result.resolved;\n  const datasets = content.datasets;\n  const keyFields = content.keyFields || null;\n  const ignoredFields = content.ignoredFields || null;\n  const controls = content.controls || {};\n  const notes = content.notes || {};\n  const includeData = ('includeData' in data) ? data.includeData : true;\n  const includeControls = ('includeControls' in data) ? data.includeControls : false;\n  const includeNotes = ('includeNotes' in data) ? data.includeNotes : false;\n\n  var final = {};\n\n  if(datasets){\n    final =  datasets;\n  } else if(!isNil(content.dataset) && is(Array, content.dataset)){\n    final[owner] = { 'dataset': content.dataset };\n    if(content.configuration){\n      final[owner].configuration = content.configuration;\n    }\n  } else if(isNil(content.dataset) && is(Array, content)) {\n    final[owner] = { 'dataset': content };\n  } else if(isNil(content.dataset)) {\n    let obj = {};\n    Object.entries(content).forEach( (entry) =>{\n      let key = entry[0];\n      let value = entry[1]\n      obj[key] = value;\n      })\n    final[owner] = { 'dataset': [obj] };\n  } else {\n    throw ValidationError('Data in invalid format');\n  }\n  const keys = Object.keys(final);\n  keys.forEach((owner, idx) =>{\n    const dataset = final[owner].dataset;\n    const name = dataset.name || initialName || \"Series \" + idx;\n    const shortName = dataset.shortName || initialShortName || name.substr(0, 1) + idx;\n    const initialConfig = final[owner].configuration;\n    final[owner] =  configureDataset(dataset, source, name, shortName, initialConfig, keyFields, ignoredFields);\n  })\n\n  data = { \n          'datasets': includeData ? final : {},\n          'keyFields': includeData ? keyFields : [],\n          'ignoredFields': includeData ? ignoredFields : [],\n          'controls': includeControls ? controls : {},\n          'notes': includeNotes ? notes : {}\n        };\n  return data;\n};\n\nfunction ValidationError(message) {\n  this.name = 'ValidationError';\n  this.message = message;\n}\n\nValidationError.prototype = Object.create(Error.prototype);\n\nexport default loadDatasetEpic;\n\nexport { loadDataset, CSVconvert };\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"Header_header__15j4c\",\"logo\":\"Header_logo__1XArl\",\"appName\":\"Header_appName__2Yv_S\",\"infoIcon\":\"Header_infoIcon__39h1E\",\"infoPopup\":\"Header_infoPopup__1SjWm\",\"tagline\":\"Header_tagline__3GO5z\",\"socialContainer\":\"Header_socialContainer__2-vMl\"};"],"sourceRoot":""}